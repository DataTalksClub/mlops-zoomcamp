{"version":3,"file":"static/js/156.61e30459.chunk.js","mappings":"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","sources":["common/static/chart-bar.svg","common/static/chart-contour.svg","common/static/chart-difference.svg","common/static/chart-image.svg","common/static/chart-line.svg","common/static/chart-parallel.svg","common/static/chart-scatter.svg","common/static/registered-model-grey-ok.svg","common/components/JsonFormatting.tsx","common/components/KeyValueTagFullViewModal.tsx","common/components/KeyValueTag.tsx","common/components/ToggleIconButton.tsx","common/hooks/useDragAndDropElement.tsx","common/components/TagSelectDropdown.tsx","common/hooks/useEditKeyValueTagsModal.tsx","common/hooks/useIsTabActive.tsx","common/utils/CssGrid.utils.ts","common/utils/LocalStorageUtils.ts","experiment-tracking/components/ExperimentSourceTypeIcon.tsx","experiment-tracking/components/RunStatusIcon.tsx","experiment-tracking/components/experiment-page/components/RunColorPill.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewDatasetSchemaTable.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewDatasetSchema.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewDatasetLink.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewDatasetSourceType.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewDatasetSourceURL.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewDatasetDigest.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewDatasetDrawer.tsx","experiment-tracking/components/experiment-page/components/runs/ExperimentViewDatasetWithContext.tsx","experiment-tracking/components/experiment-page/contexts/ExperimentPageUIStateContext.tsx","experiment-tracking/components/experiment-page/hooks/useExperimentIds.ts","experiment-tracking/components/experiment-page/hooks/usePopulateImagesByRunUuid.tsx","experiment-tracking/components/modals/ConfirmModal.tsx","experiment-tracking/components/modals/DeleteRunModal.tsx","experiment-tracking/components/modals/GenericInputModal.tsx","experiment-tracking/components/modals/RenameForm.tsx","experiment-tracking/components/modals/RenameRunModal.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigure.common.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureBarChart.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureParallelChart.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureLineChart.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureLineChart.preview.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureParallelChart.preview.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureContourChart.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureScatterChart.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureDifferenceChart.preview.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureDifferenceChart.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureImageChart.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureImageChart.preview.tsx","experiment-tracking/components/runs-charts/components/RunsChartsConfigureModal.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureBarChart.preview.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureContourChart.preview.tsx","experiment-tracking/components/runs-charts/components/config/RunsChartsConfigureScatterChart.preview.tsx","experiment-tracking/components/runs-charts/components/RunsChartsFullScreenModal.tsx","experiment-tracking/components/runs-charts/components/RunsChartsTooltipBody.tsx","experiment-tracking/components/runs-charts/components/RunsContourPlot.tsx","experiment-tracking/components/runs-charts/components/RunsMetricsBarPlot.tsx","experiment-tracking/components/runs-charts/components/RunsMetricsLegend.tsx","experiment-tracking/components/runs-charts/components/RunsMetricsLegendWrapper.tsx","experiment-tracking/components/runs-charts/hooks/useRunsChartsMultipleTracesTooltip.tsx","experiment-tracking/components/runs-charts/components/RunsMetricsLinePlot.tsx","experiment-tracking/components/runs-charts/components/RunsMultipleTracesTooltipBody.tsx","experiment-tracking/components/runs-charts/components/RunsScatterPlot.tsx","experiment-tracking/components/runs-charts/components/cards/ChartCard.common.tsx","experiment-tracking/components/runs-charts/components/cards/RunsChartsBarChartCard.tsx","experiment-tracking/components/runs-charts/components/cards/RunsChartsLineChartCard.tsx","experiment-tracking/components/runs-charts/hooks/useCompareRunChartSelectedRange.tsx","experiment-tracking/components/runs-charts/components/cards/RunsChartsScatterChartCard.tsx","experiment-tracking/components/runs-charts/components/cards/RunsChartsContourChartCard.tsx","common/static/parallel-chart-placeholder.svg","experiment-tracking/components/runs-charts/components/cards/RunsChartsParallelChartCard.tsx","experiment-tracking/components/runs-charts/components/cards/RunsChartsDifferenceChartCard.tsx","experiment-tracking/components/runs-charts/components/cards/RunsChartsImageChartCard.tsx","experiment-tracking/components/runs-charts/components/cards/RunsChartsCard.tsx","experiment-tracking/components/runs-charts/utils/differenceView.ts","experiment-tracking/components/runs-charts/components/charts/DifferenceViewPlot.tsx","experiment-tracking/components/runs-charts/components/charts/ImageGridPlot.common.tsx","experiment-tracking/components/runs-charts/components/charts/ImageGridSingleKeyPlot.tsx","experiment-tracking/components/runs-charts/components/charts/ImageGridMultipleKeyPlot.tsx","experiment-tracking/components/runs-charts/components/charts/ImageGridPlot.tsx","experiment-tracking/components/runs-charts/components/charts/LazyParallelCoordinatesPlot.tsx","experiment-tracking/components/MetricChartsAccordion.tsx","experiment-tracking/components/runs-charts/components/RunsChartsAddChartMenu.tsx","experiment-tracking/components/runs-charts/components/sections/RunsChartsSectionHeader.tsx","experiment-tracking/components/runs-charts/components/RunsCharts.tsx","experiment-tracking/components/runs-charts/components/sections/RunsChartsSection.tsx","experiment-tracking/components/runs-charts/components/sections/RunsChartsSectionAccordion.tsx","experiment-tracking/components/runs-charts/hooks/useChartImageDownloadHandler.tsx","experiment-tracking/components/runs-charts/hooks/useImageSliderStepMarks.tsx","experiment-tracking/components/runs-charts/hooks/useIsInViewport.tsx","experiment-tracking/components/runs-charts/hooks/useMutableHoverCallback.tsx","experiment-tracking/components/runs-charts/hooks/useRunsChartTraceHighlight.ts","experiment-tracking/components/runs-charts/hooks/useRunsChartsTooltip.tsx","experiment-tracking/components/runs-charts/hooks/useRunsChartsUIConfiguration.tsx","experiment-tracking/components/runs-charts/hooks/useSampledMetricHistory.tsx","experiment-tracking/components/runs-charts/runs-charts.types.ts","experiment-tracking/components/runs-charts/utils/findChartStepsByTimestamp.ts","experiment-tracking/components/runs-compare/hooks/useGroupedChartRunData.tsx","experiment-tracking/utils/DatasetUtils.ts","shared/building_blocks/CopyButton.tsx","shared/building_blocks/Image.tsx","shared/web-shared/hooks/useMediaQuery.ts","shared/web-shared/snippet/theme/databricks-duotone-dark.ts","shared/web-shared/snippet/theme/databricks-light.ts","shared/web-shared/snippet/index.tsx"],"sourcesContent":["var _path, _rect, _rect2, _rect3, _rect4;\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nimport * as React from \"react\";\nfunction SvgChartBar(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 18,\n    height: 16,\n    viewBox: \"0 0 18 16\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1 0.813599V15.1865H17\",\n    stroke: \"#A3AEB8\",\n    strokeLinecap: \"round\"\n  })), _rect || (_rect = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 3.16943,\n    y: 10.5763,\n    width: 2.16949,\n    height: 3.25424,\n    fill: \"#338ECC\"\n  })), _rect2 || (_rect2 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 6.42371,\n    y: 5.15259,\n    width: 2.16949,\n    height: 8.67797,\n    fill: \"#338ECC\"\n  })), _rect3 || (_rect3 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 9.67798,\n    y: 8.40686,\n    width: 2.16949,\n    height: 5.42373,\n    fill: \"#338ECC\"\n  })), _rect4 || (_rect4 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 12.9323,\n    y: 1.89832,\n    width: 2.16949,\n    height: 11.9322,\n    fill: \"#338ECC\"\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgChartBar);\nexport default __webpack_public_path__ + \"static/media/chart-bar.0fd4a63680fba840a7b69fbf07969f79.svg\";\nexport { ForwardRef as ReactComponent };","var _path, _path2, _path3;\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nimport * as React from \"react\";\nfunction SvgChartContour(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 18,\n    height: 18,\n    viewBox: \"0 0 18 18\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1 1V17H17\",\n    stroke: \"#A3AEB8\",\n    strokeLinecap: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M12.9749 4.94148C12.9188 4.71702 12.221 4.73284 12.0618 4.71515C11.1779 4.61693 10.2817 4.66052 9.39271 4.66052C8.11919 4.66052 7.15648 4.97961 6.24753 5.90922C5.86197 6.30355 5.5235 6.77684 5.23295 7.24378C4.99434 7.62726 4.65544 7.93479 4.40569 8.31299C3.93777 9.02154 3.56281 9.80723 3.56281 10.6699C3.56281 11.1806 3.37479 11.598 3.76962 12.0669C4.19449 12.5714 4.6863 12.9507 5.27978 13.2649C5.88594 13.5858 6.42202 13.8619 7.13723 13.8619C7.74338 13.8619 8.34952 13.8619 8.95567 13.8619C9.45735 13.8619 9.96042 13.8731 10.4619 13.8619C11.1412 13.8468 11.9484 13.1895 12.413 12.7381C13.581 11.6035 14.2393 9.88016 14.2393 8.24665C14.2393 7.69923 14.3797 7.17063 14.3797 6.62723C14.3797 6.40084 14.4779 5.87696 14.2744 5.71411C13.9268 5.43606 13.5785 5.13789 13.1857 4.94148\",\n    stroke: \"#338ECC\",\n    strokeLinecap: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M11.9213 6.83789C11.2761 6.83789 10.6309 6.83789 9.98577 6.83789C9.19776 6.83789 8.80182 7.44144 8.2844 7.97734C7.58163 8.70521 7.28544 9.67306 7.28544 10.666C7.28544 10.9641 7.22004 11.177 7.46104 11.3645C7.6831 11.5372 8.10719 11.6142 8.37806 11.6142C9.07316 11.6142 9.91042 11.5583 10.4462 11.0523C10.9277 10.5975 11.473 10.3701 11.8159 9.75284C12.045 9.34042 12.2022 8.86324 12.2022 8.38317C12.2022 8.14903 12.2022 7.9149 12.2022 7.68077C12.2022 7.4241 12.0208 7.38817 11.9213 7.18909\",\n    stroke: \"#338ECC\",\n    strokeLinecap: \"round\"\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgChartContour);\nexport default __webpack_public_path__ + \"static/media/chart-contour.0d4b306f2669f3ad25375568935e3ce3.svg\";\nexport { ForwardRef as ReactComponent };","var _rect, _rect2, _rect3, _rect4, _rect5, _rect6, _rect7, _rect8, _rect9, _rect10, _rect11, _rect12, _rect13, _rect14, _rect15, _rect16, _rect17, _rect18;\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nimport * as React from \"react\";\nfunction SvgChartDifference(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 16,\n    height: 16,\n    viewBox: \"0 0 16 16\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _rect || (_rect = /*#__PURE__*/React.createElement(\"rect\", {\n    y: 2,\n    width: 4,\n    height: 1,\n    fill: \"#338ECC\"\n  })), _rect2 || (_rect2 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 5,\n    y: 2,\n    width: 4,\n    height: 1,\n    fill: \"#338ECC\"\n  })), _rect3 || (_rect3 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 10,\n    y: 2,\n    width: 4,\n    height: 1,\n    fill: \"#338ECC\"\n  })), _rect4 || (_rect4 = /*#__PURE__*/React.createElement(\"rect\", {\n    y: 4,\n    width: 4,\n    height: 1,\n    fill: \"#338ECC\"\n  })), _rect5 || (_rect5 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 5,\n    y: 4,\n    width: 4,\n    height: 1,\n    fill: \"#338ECC\"\n  })), _rect6 || (_rect6 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 10,\n    y: 4,\n    width: 4,\n    height: 1,\n    fill: \"#338ECC\"\n  })), _rect7 || (_rect7 = /*#__PURE__*/React.createElement(\"rect\", {\n    y: 6,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect8 || (_rect8 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 5,\n    y: 6,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect9 || (_rect9 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 10,\n    y: 6,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect10 || (_rect10 = /*#__PURE__*/React.createElement(\"rect\", {\n    y: 8,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect11 || (_rect11 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 5,\n    y: 8,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect12 || (_rect12 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 10,\n    y: 8,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect13 || (_rect13 = /*#__PURE__*/React.createElement(\"rect\", {\n    y: 10,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect14 || (_rect14 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 5,\n    y: 10,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect15 || (_rect15 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 10,\n    y: 10,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect16 || (_rect16 = /*#__PURE__*/React.createElement(\"rect\", {\n    y: 12,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect17 || (_rect17 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 5,\n    y: 12,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })), _rect18 || (_rect18 = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 10,\n    y: 12,\n    width: 4,\n    height: 1,\n    fill: \"#D9D9D9\"\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgChartDifference);\nexport default __webpack_public_path__ + \"static/media/chart-difference.16174216d6f3b7c24f40e3541fe0ca2c.svg\";\nexport { ForwardRef as ReactComponent };","var _rect, _line, _line2, _line3;\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nimport * as React from \"react\";\nfunction SvgChartImage(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 16,\n    height: 16,\n    viewBox: \"0 0 16 16\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _rect || (_rect = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 0.5,\n    y: 0.5,\n    width: 15,\n    height: 15,\n    stroke: \"#C4C4C4\"\n  })), _line || (_line = /*#__PURE__*/React.createElement(\"line\", {\n    x1: 8.5,\n    y1: 0.800049,\n    x2: 8.5,\n    y2: 16,\n    stroke: \"#C4C4C4\"\n  })), _line2 || (_line2 = /*#__PURE__*/React.createElement(\"line\", {\n    x1: 16,\n    y1: 5.69995,\n    x2: -2.63656e-8,\n    y2: 5.69995,\n    stroke: \"#C4C4C4\"\n  })), _line3 || (_line3 = /*#__PURE__*/React.createElement(\"line\", {\n    x1: 16,\n    y1: 10.9,\n    x2: -2.63656e-8,\n    y2: 10.9,\n    stroke: \"#C4C4C4\"\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgChartImage);\nexport default __webpack_public_path__ + \"static/media/chart-image.cc434c4dc50780966344e2385a15f8fe.svg\";\nexport { ForwardRef as ReactComponent };","var _path, _path2;\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nimport * as React from \"react\";\nfunction SvgChartLine(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 22,\n    height: 22,\n    viewBox: \"0 0 22 22\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.38977 15.717L8.79655 10.8113L12.5254 14.9622L19.644 7.03772\",\n    stroke: \"#338ECC\",\n    strokeWidth: 2,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1 1V21H21\",\n    stroke: \"#A3AEB8\",\n    strokeLinecap: \"round\"\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgChartLine);\nexport default __webpack_public_path__ + \"static/media/chart-line.0adaa2036bb4eb5956db6d0c7e925a3d.svg\";\nexport { ForwardRef as ReactComponent };","var _path, _path2, _path3, _path4, _path5;\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nimport * as React from \"react\";\nfunction SvgChartParallel(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 18,\n    height: 18,\n    viewBox: \"0 0 18 18\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1 1V17H17\",\n    stroke: \"#A3AEB8\",\n    strokeLinecap: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.21875 3.58289C4.55663 3.58289 4.88067 3.68935 5.21469 3.73008C5.6474 3.78285 6.02137 3.96513 6.37191 4.21552C6.76902 4.49917 7.0271 4.74589 7.24101 5.18954C7.44337 5.60925 7.59378 6.06989 7.72958 6.51432C7.86002 6.94121 8.09708 7.33726 8.19153 7.77803C8.25347 8.0671 8.34514 8.32427 8.44678 8.60015C8.58028 8.96252 8.80086 9.27915 8.96667 9.62583C9.15145 10.0122 9.216 10.4461 9.34876 10.8551C9.57831 11.5623 9.91132 12.4763 10.7205 12.6731C11.4284 12.8453 12.1459 12.8845 12.8705 12.8845C13.0981 12.8845 13.3979 12.898 13.5831 12.7499C13.6402 12.7042 13.7451 12.6907 13.8164 12.6591C13.8752 12.6329 14.0919 12.5871 14.1123 12.5463\",\n    stroke: \"#CCE3F2\",\n    strokeLinecap: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.16162 12.9805C4.32512 12.9805 4.4895 12.9859 4.65284 12.9805C4.84076 12.9742 5.0468 12.7952 5.2099 12.707C5.62236 12.4841 5.99426 12.0648 6.24299 11.6739C6.49491 11.2781 6.8776 10.9871 7.0887 10.5649C7.27767 10.187 7.50992 9.80749 7.73691 9.45078C7.93911 9.13304 8.10211 8.77722 8.28637 8.44554C8.43088 8.18544 8.45 7.88672 8.60542 7.62768C8.94898 7.05509 9.16215 6.418 9.45873 5.82484C9.72614 5.29001 9.96898 4.82426 10.4159 4.42207C10.5753 4.27853 10.8984 4.21824 11.0995 4.14861C11.3303 4.06873 11.579 4.02714 11.8136 3.93592C12.0394 3.84807 12.2521 3.84383 12.4795 3.77386C12.6993 3.70623 12.9319 3.63713 13.1632 3.63713C13.5192 3.63713 13.9089 3.59155 14.2798 3.59155\",\n    stroke: \"#CCE3F2\",\n    strokeLinecap: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M3.79248 2.74207V13.8225\",\n    stroke: \"#338ECC\",\n    strokeLinecap: \"round\"\n  })), _path5 || (_path5 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M14.873 3.04419V13.7217\",\n    stroke: \"#338ECC\",\n    strokeLinecap: \"round\"\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgChartParallel);\nexport default __webpack_public_path__ + \"static/media/chart-parallel.da7dedf539b2af4b654d377c679173e4.svg\";\nexport { ForwardRef as ReactComponent };","var _path, _circle, _ellipse, _circle2, _circle3, _ellipse2, _ellipse3;\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nimport * as React from \"react\";\nfunction SvgChartScatter(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 18,\n    height: 16,\n    viewBox: \"0 0 18 16\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1 0.813599V15.1865H17\",\n    stroke: \"#A3AEB8\",\n    strokeLinecap: \"round\"\n  })), _circle || (_circle = /*#__PURE__*/React.createElement(\"circle\", {\n    cx: 3.98301,\n    cy: 12.4746,\n    r: 1.35593,\n    fill: \"#338ECC\"\n  })), _ellipse || (_ellipse = /*#__PURE__*/React.createElement(\"ellipse\", {\n    cx: 9.40684,\n    cy: 10.8475,\n    rx: 1.35593,\n    ry: 1.35593,\n    fill: \"#338ECC\"\n  })), _circle2 || (_circle2 = /*#__PURE__*/React.createElement(\"circle\", {\n    cx: 5.6102,\n    cy: 8.1356,\n    r: 1.35593,\n    fill: \"#338ECC\",\n    fillOpacity: 0.25\n  })), _circle3 || (_circle3 = /*#__PURE__*/React.createElement(\"circle\", {\n    cx: 9.40684,\n    cy: 6.50852,\n    r: 1.35593,\n    fill: \"#338ECC\"\n  })), _ellipse2 || (_ellipse2 = /*#__PURE__*/React.createElement(\"ellipse\", {\n    cx: 13.7457,\n    cy: 5.96616,\n    rx: 1.35593,\n    ry: 1.35593,\n    fill: \"#338ECC\",\n    fillOpacity: 0.25\n  })), _ellipse3 || (_ellipse3 = /*#__PURE__*/React.createElement(\"ellipse\", {\n    cx: 16.4576,\n    cy: 2.46128,\n    rx: 1.35593,\n    ry: 1.35593,\n    fill: \"#338ECC\"\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgChartScatter);\nexport default __webpack_public_path__ + \"static/media/chart-scatter.69118d0023a6ff3973f7fa913834ac47.svg\";\nexport { ForwardRef as ReactComponent };","var _path, _g, _path2, _path3, _defs;\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nimport * as React from \"react\";\nfunction SvgRegisteredModelGreyOk(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 19,\n    height: 16,\n    viewBox: \"0 0 19 16\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"g\", {\n    clipPath: \"url(#clip0_0_3)\"\n  }, /*#__PURE__*/React.createElement(\"mask\", {\n    id: \"mask0_0_3\",\n    style: {\n      maskType: \"luminance\"\n    },\n    maskUnits: \"userSpaceOnUse\",\n    x: 0,\n    y: 0,\n    width: 16,\n    height: 16\n  }, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16 0H0V16H16V0Z\",\n    fill: \"white\"\n  }))), _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    mask: \"url(#mask0_0_3)\"\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    clipRule: \"evenodd\",\n    d: \"M2.75 3.49999C2.05964 3.49999 1.5 4.05963 1.5 4.74999C1.5 5.44034 2.05964 5.99999 2.75 5.99999C3.44036 5.99999 4 5.44034 4 4.74999C4 4.05963 3.44036 3.49999 2.75 3.49999ZM0 4.74999C0 3.2312 1.23122 1.99999 2.75 1.99999C3.77682 1.99999 4.6722 2.56276 5.14452 3.39669L9.51655 2.44626C9.66772 1.0704 10.8338 0 12.25 0C13.7688 0 15 1.23122 15 2.75C15 3.87686 14.3222 4.84541 13.3521 5.27025L13.6341 7.52661C14.9711 7.71349 16 8.86158 16 10.25C16 11.7688 14.7687 13 13.25 13C12.3895 13 11.6214 12.6048 11.1172 11.9861L8.49749 13.1322C8.49913 13.1713 8.49997 13.2105 8.49997 13.25C8.49996 14.7688 7.26875 16 5.74997 16C4.23118 16 2.99997 14.7688 2.99996 13.25C2.99997 12.3569 3.42568 11.5633 4.08524 11.0609L3.01322 7.48755C2.92659 7.49578 2.83878 7.49999 2.75 7.49999C1.23122 7.49999 0 6.26877 0 4.74999ZM5.46534 5.18782C5.48277 5.07884 5.4938 4.96773 5.49804 4.85488L9.76409 3.92748C10.1528 4.74671 10.9346 5.34321 11.8658 5.47338L12.1478 7.72974C11.7709 7.89483 11.438 8.14204 11.1719 8.44873L5.46534 5.18782ZM4.82802 6.55126C4.70399 6.69422 4.56546 6.82424 4.41471 6.93906L5.48674 10.5124C5.57337 10.5042 5.66118 10.5 5.74997 10.5C6.69483 10.5 7.52839 10.9765 8.02345 11.7023L10.5231 10.6087C10.5079 10.4913 10.5 10.3716 10.5 10.25C10.5 10.101 10.5118 9.95475 10.5346 9.81218L4.82802 6.55126ZM12 10.25C12 9.55963 12.5596 8.99999 13.25 8.99999C13.9403 8.99999 14.5 9.55963 14.5 10.25C14.5 10.9403 13.9403 11.5 13.25 11.5C12.5596 11.5 12 10.9403 12 10.25ZM5.74997 12C5.05961 12 4.49997 12.5596 4.49997 13.25C4.49997 13.9403 5.05961 14.5 5.74997 14.5C6.44032 14.5 6.99997 13.9403 6.99997 13.25C6.99997 12.5596 6.44032 12 5.74997 12ZM11 2.75C11 2.05964 11.5596 1.5 12.25 1.5C12.9403 1.5 13.5 2.05964 13.5 2.75C13.5 3.44036 12.9403 4 12.25 4C11.5596 4 11 3.44036 11 2.75Z\",\n    fill: \"currentColor\"\n  }))), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M13.5 14C15.433 14 17 12.433 17 10.5C17 8.567 15.433 7 13.5 7C11.567 7 10 8.567 10 10.5C10 12.433 11.567 14 13.5 14Z\",\n    fill: \"white\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    clipRule: \"evenodd\",\n    d: \"M11.125 11C11.125 9.41218 12.4122 8.125 14 8.125C15.5878 8.125 16.875 9.41218 16.875 11C16.875 12.5878 15.5878 13.875 14 13.875C12.4122 13.875 11.125 12.5878 11.125 11ZM14 6.625C11.5838 6.625 9.625 8.58375 9.625 11C9.625 13.4162 11.5838 15.375 14 15.375C16.4162 15.375 18.375 13.4162 18.375 11C18.375 8.58375 16.4162 6.625 14 6.625ZM14.0303 12.5303L16.0303 10.5303L14.9697 9.46967L13.5 10.9393L13.0303 10.4697L11.9697 11.5303L12.9697 12.5303L13.5 13.0607L14.0303 12.5303Z\",\n    fill: \"#3CAA60\"\n  }))), _defs || (_defs = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"clipPath\", {\n    id: \"clip0_0_3\"\n  }, /*#__PURE__*/React.createElement(\"rect\", {\n    width: 19,\n    height: 16,\n    fill: \"white\"\n  })))));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgRegisteredModelGreyOk);\nexport default __webpack_public_path__ + \"static/media/registered-model-grey-ok.8274b58d39504c8d1b8c358aa1c9aa35.svg\";\nexport { ForwardRef as ReactComponent };","import React from 'react';\nimport { CodeSnippet } from '@databricks/web-shared/snippet';\nimport { isObject } from 'lodash';\n\ninterface JsonPreviewProps {\n  json: string;\n  wrapperStyle?: React.CSSProperties;\n  overlayStyle?: React.CSSProperties;\n  codeSnippetStyle?: React.CSSProperties;\n}\n\nexport const JsonPreview: React.FC<JsonPreviewProps> = ({ json, wrapperStyle, overlayStyle, codeSnippetStyle }) => {\n  const { formattedJson, isJsonContent } = useFormattedJson(json);\n\n  const defaultWrapperStyle: React.CSSProperties = {\n    position: 'relative',\n    maxHeight: 'calc(1.5em * 9)',\n    overflow: 'hidden',\n  };\n\n  const defaultOverlayStyle: React.CSSProperties = {\n    position: 'absolute',\n    bottom: 0,\n    right: 0,\n    left: 6,\n    height: '2em',\n    background: 'linear-gradient(transparent, white)',\n  };\n\n  const defaultCodeSnippetStyle: React.CSSProperties = {\n    padding: '5px',\n    overflowX: 'hidden',\n  };\n\n  return (\n    <div style={{ ...defaultWrapperStyle, ...wrapperStyle }}>\n      {isJsonContent ? (\n        <>\n          <CodeSnippet language=\"json\" style={{ ...defaultCodeSnippetStyle, ...codeSnippetStyle }}>\n            {formattedJson}\n          </CodeSnippet>\n          <div css={{ ...defaultOverlayStyle, ...overlayStyle }}></div>\n        </>\n      ) : (\n        <>{json}</>\n      )}\n    </div>\n  );\n};\n\nexport function useFormattedJson(json: string) {\n  return React.useMemo(() => {\n    try {\n      const parsed = JSON.parse(json);\n      const isJson = isObject(parsed) && typeof parsed !== 'function' && !(parsed instanceof Date);\n      return {\n        formattedJson: isJson ? JSON.stringify(parsed, null, 2) : json,\n        isJsonContent: isJson,\n      };\n    } catch (e) {\n      return {\n        formattedJson: json,\n        isJsonContent: false,\n      };\n    }\n  }, [json]);\n}\n\nexport const FormattedJsonDisplay: React.FC<{ json: string }> = ({ json }) => {\n  const { formattedJson, isJsonContent } = useFormattedJson(json);\n\n  return (\n    <div css={{ whiteSpace: 'pre-wrap' }}>\n      {isJsonContent ? (\n        <CodeSnippet language=\"json\" wrapLongLines>\n          {formattedJson}\n        </CodeSnippet>\n      ) : (\n        <span>{json}</span>\n      )}\n    </div>\n  );\n};\n","import React from 'react';\nimport { Modal, Typography, CopyIcon, useDesignSystemTheme } from '@databricks/design-system';\nconst { Paragraph } = Typography;\nimport { CopyButton } from 'shared/building_blocks/CopyButton';\n\nexport interface KeyValueTagFullViewModalProps {\n  tagKey: string;\n  tagValue: string;\n  setIsKeyValueTagFullViewModalVisible: React.Dispatch<React.SetStateAction<boolean>>;\n  isKeyValueTagFullViewModalVisible: boolean;\n}\n\nexport const KeyValueTagFullViewModal = React.memo((props: KeyValueTagFullViewModalProps) => {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <Modal\n      title={'Tag: ' + props.tagKey}\n      visible={props.isKeyValueTagFullViewModalVisible}\n      onCancel={() => props.setIsKeyValueTagFullViewModalVisible(false)}\n    >\n      <div css={{ display: 'flex' }}>\n        <Paragraph css={{ flexGrow: 1 }}>\n          <pre\n            css={{\n              backgroundColor: theme.colors.backgroundPrimary,\n              marginTop: theme.spacing.sm,\n              whiteSpace: 'pre-wrap',\n              wordBreak: 'break-all',\n            }}\n          >\n            {props.tagValue}\n          </pre>\n        </Paragraph>\n        <div\n          css={{\n            marginTop: theme.spacing.sm,\n          }}\n        >\n          <CopyButton copyText={props.tagValue} showLabel={false} icon={<CopyIcon />} aria-label=\"Copy\" />\n        </div>\n      </div>\n    </Modal>\n  );\n});\n","import { Tag, Tooltip, Typography } from '@databricks/design-system';\nimport { KeyValueEntity } from '../../experiment-tracking/types';\nimport React, { useState } from 'react';\nimport { useIntl } from 'react-intl';\nimport { KeyValueTagFullViewModal } from './KeyValueTagFullViewModal';\n\n/**\n * An arbitrary number that is used to determine if a tag is too\n * long and should be truncated. We want to avoid short keys or values\n * in a long tag to be truncated\n * */\nexport const TRUNCATE_ON_CHARS_LENGTH = 30;\n\nfunction getTruncatedStyles(shouldTruncate = true) {\n  return shouldTruncate\n    ? {\n        overflow: 'hidden',\n        textOverflow: 'ellipsis',\n        textWrap: 'nowrap',\n        whiteSpace: 'nowrap' as const,\n      }\n    : { whiteSpace: 'nowrap' as const };\n}\n\n/**\n * A <Tag /> wrapper used for displaying key-value entity\n */\nexport const KeyValueTag = ({\n  isClosable = false,\n  onClose,\n  tag,\n  enableFullViewModal = false,\n  charLimit = TRUNCATE_ON_CHARS_LENGTH,\n  maxWidth = 300,\n  className,\n}: {\n  isClosable?: boolean;\n  onClose?: () => void;\n  tag: KeyValueEntity;\n  enableFullViewModal?: boolean;\n  charLimit?: number;\n  maxWidth?: number;\n  className?: string;\n}) => {\n  const intl = useIntl();\n\n  const [isKeyValueTagFullViewModalVisible, setIsKeyValueTagFullViewModalVisible] = useState(false);\n\n  const { shouldTruncateKey, shouldTruncateValue } = getKeyAndValueComplexTruncation(tag, charLimit);\n  const allowFullViewModal = enableFullViewModal && (shouldTruncateKey || shouldTruncateValue);\n\n  const fullViewModalLabel = intl.formatMessage({\n    defaultMessage: 'Click to see more',\n    description: 'Run page > Overview > Tags cell > Tag',\n  });\n\n  return (\n    <div>\n      <Tag closable={isClosable} onClose={onClose} title={tag.key} className={className}>\n        <Tooltip title={allowFullViewModal ? fullViewModalLabel : ''}>\n          <span\n            css={{ maxWidth, display: 'inline-flex' }}\n            onClick={() => (allowFullViewModal ? setIsKeyValueTagFullViewModalVisible(true) : undefined)}\n          >\n            <Typography.Text bold title={tag.key} css={getTruncatedStyles(shouldTruncateKey)}>\n              {tag.key}\n            </Typography.Text>\n            {tag.value && (\n              <Typography.Text title={tag.value} css={getTruncatedStyles(shouldTruncateValue)}>\n                : {tag.value}\n              </Typography.Text>\n            )}\n          </span>\n        </Tooltip>\n      </Tag>\n      <div>\n        {isKeyValueTagFullViewModalVisible && (\n          <KeyValueTagFullViewModal\n            tagKey={tag.key}\n            tagValue={tag.value}\n            isKeyValueTagFullViewModalVisible={isKeyValueTagFullViewModalVisible}\n            setIsKeyValueTagFullViewModalVisible={setIsKeyValueTagFullViewModalVisible}\n          />\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport function getKeyAndValueComplexTruncation(\n  tag: KeyValueEntity,\n  charLimit = TRUNCATE_ON_CHARS_LENGTH,\n): { shouldTruncateKey: boolean; shouldTruncateValue: boolean } {\n  const { key, value } = tag;\n  const fullLength = key.length + value.length;\n  const isKeyLonger = key.length > value.length;\n  const shorterLength = isKeyLonger ? value.length : key.length;\n\n  // No need to truncate if tag is short enough\n  if (fullLength <= charLimit) return { shouldTruncateKey: false, shouldTruncateValue: false };\n  // If the shorter string is too long, truncate both key and value.\n  if (shorterLength > charLimit / 2) return { shouldTruncateKey: true, shouldTruncateValue: true };\n\n  // Otherwise truncate the longer string\n  return {\n    shouldTruncateKey: isKeyLonger,\n    shouldTruncateValue: !isKeyLonger,\n  };\n}\n","import React from 'react';\n\nimport type { ButtonProps } from '@databricks/design-system';\nimport {\n  DesignSystemEventProviderAnalyticsEventTypes,\n  DesignSystemEventProviderComponentTypes,\n  useDesignSystemEventComponentCallbacks,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\n\nexport interface ToggleIconButtonProps extends ButtonProps {\n  pressed?: boolean;\n}\n\n/**\n * WARNING: Temporary component!\n *\n * This component recreates \"Toggle button with icon\" pattern which is not\n * available in the design system yet.\n *\n * TODO: replace this component with the one from DuBois design system when available.\n */\nconst ToggleIconButton = React.forwardRef<HTMLButtonElement, ToggleIconButtonProps>(\n  (props: ToggleIconButtonProps, ref) => {\n    const {\n      pressed,\n      onClick,\n      icon,\n      onBlur,\n      onFocus,\n      onMouseEnter,\n      onMouseLeave,\n      componentId,\n      analyticsEvents,\n      type,\n      ...remainingProps\n    } = props;\n    const { theme } = useDesignSystemTheme();\n\n    const eventContext = useDesignSystemEventComponentCallbacks({\n      componentType: DesignSystemEventProviderComponentTypes.Button,\n      componentId,\n      analyticsEvents: analyticsEvents ?? [DesignSystemEventProviderAnalyticsEventTypes.OnClick],\n    });\n\n    return (\n      <button\n        onClick={(event) => {\n          eventContext.onClick();\n          onClick?.(event);\n        }}\n        css={{\n          cursor: 'pointer',\n          width: theme.general.heightSm,\n          height: theme.general.heightSm,\n          borderRadius: theme.borders.borderRadiusMd,\n          lineHeight: theme.typography.lineHeightBase,\n          padding: 0,\n          border: 0,\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          background: pressed ? theme.colors.actionDefaultBackgroundPress : 'transparent',\n          color: pressed ? theme.colors.actionDefaultTextPress : theme.colors.textSecondary,\n          '&:hover': {\n            background: theme.colors.actionDefaultBackgroundHover,\n            color: theme.colors.actionDefaultTextHover,\n          },\n        }}\n        ref={ref}\n        onBlur={onBlur}\n        onFocus={onFocus}\n        onMouseEnter={onMouseEnter}\n        onMouseLeave={onMouseLeave}\n        {...remainingProps}\n      >\n        {icon}\n      </button>\n    );\n  },\n);\n\nexport { ToggleIconButton };\n","// eslint-disable-next-line import/no-extraneous-dependencies\nimport { type DragDropManager, createDragDropManager } from 'dnd-core';\nimport { useEffect, useLayoutEffect, useRef, useState } from 'react';\nimport { useDrag, useDrop, DndProvider } from 'react-dnd';\nimport { HTML5Backend } from 'react-dnd-html5-backend';\n\nexport interface useDragAndDropElementProps {\n  /**\n   * Unique drag element identifier, used in drop events\n   */\n  dragKey: string;\n  /**\n   * Group key - items are droppable only within a single group\n   */\n  dragGroupKey: string;\n  /**\n   * Callback function, conveys both dragged and target element key\n   */\n  onDrop: (draggedKey: string, targetDropKey: string) => void;\n\n  /**\n   * If true, drag and drop will be disabled\n   */\n  disabled?: boolean;\n}\n\ninterface DraggedItem {\n  key: string;\n  groupKey: string;\n}\n\n/**\n * A hook enabling drag-and-drop capabilities for any component.\n * Used component will serve as both DnD source and target.\n */\nexport const useDragAndDropElement = ({\n  dragGroupKey,\n  dragKey,\n  onDrop,\n  disabled = false,\n}: useDragAndDropElementProps) => {\n  const dropListener = useRef(onDrop);\n  useEffect(() => {\n    dropListener.current = onDrop;\n  }, [onDrop]);\n  const [{ isOver, draggedItem }, dropTargetRef] = useDrop<\n    DraggedItem,\n    never,\n    { isOver: boolean; draggedItem: DraggedItem }\n  >(\n    () => ({\n      canDrop: () => !disabled,\n      accept: `dnd-${dragGroupKey}`,\n      drop: ({ key: sourceKey }: { key: string }, monitor) => {\n        if (sourceKey === dragKey || monitor.didDrop()) {\n          return;\n        }\n        dropListener.current(sourceKey, dragKey);\n      },\n      collect: (monitor) => ({ isOver: monitor.isOver({ shallow: true }), draggedItem: monitor.getItem() }),\n    }),\n    [],\n  );\n\n  const [{ isDragging }, dragHandleRef, dragPreviewRef] = useDrag(\n    () => ({\n      canDrag: () => !disabled,\n      type: `dnd-${dragGroupKey}`,\n      item: { key: dragKey, groupKey: dragGroupKey },\n      collect: (monitor) => ({\n        isDragging: monitor.isDragging(),\n      }),\n    }),\n    [],\n  );\n\n  const isDraggingOtherGroup = Boolean(draggedItem && draggedItem.groupKey !== dragGroupKey);\n\n  return { dropTargetRef, dragHandleRef, dragPreviewRef, isDragging, isOver, isDraggingOtherGroup };\n};\n\n/**\n * Create a scoped DndProvider that will limit its functionality to a single root element.\n * It should prevent HTML5Backend collisions, see:\n * https://github.com/react-dnd/react-dnd/blob/7c88c37489a53b5ac98699c46a506a8e085f1c03/packages/backend-html5/src/HTML5BackendImpl.ts#L107-L109\n */\nexport const DragAndDropProvider: React.FC = ({ children }) => {\n  const rootElementRef = useRef<HTMLDivElement>(null);\n  const [manager, setManager] = useState<DragDropManager | null>(null);\n\n  useLayoutEffect(() => {\n    const rootElement = rootElementRef.current;\n    const dragDropManager = createDragDropManager(HTML5Backend, undefined, { rootElement });\n    setManager(dragDropManager);\n    return () => {\n      dragDropManager.getBackend().teardown();\n    };\n  }, []);\n\n  return (\n    <div css={{ display: 'contents' }} ref={rootElementRef}>\n      {manager && <DndProvider manager={manager}>{children}</DndProvider>}\n    </div>\n  );\n};\n","import { sortedIndexOf } from 'lodash';\nimport React, { useMemo, useRef, useState } from 'react';\nimport { Control, useController } from 'react-hook-form';\nimport { useIntl } from 'react-intl';\n\nimport { PlusIcon, LegacySelect, Tooltip, useDesignSystemTheme } from '@databricks/design-system';\nimport { KeyValueEntity } from '../../experiment-tracking/types';\n\n/**\n * Will show an extra row at the bottom of the dropdown menu to create a new tag when\n * The user has typed something in the search input\n * and either\n * 1. The search input is not an exact match for an existing tag name\n * 2. There are no tags available based on search input\n */\n\nfunction DropdownMenu(menu: React.ReactElement, allAvailableTags: string[]) {\n  const intl = useIntl();\n  const { theme } = useDesignSystemTheme();\n  const searchValue = menu.props.searchValue.toLowerCase();\n\n  const resolvedMenu = useMemo(() => {\n    if (!searchValue) return menu;\n\n    const doesTagExists = sortedIndexOf(allAvailableTags, searchValue) >= 0;\n    if (doesTagExists) return menu;\n\n    const isValidTagKey = /^[^,.:/=\\-\\s]+$/.test(searchValue);\n\n    // Overriding the menu to add a new option at the top\n    return React.cloneElement(menu, {\n      flattenOptions: [\n        {\n          data: {\n            value: searchValue,\n            disabled: !isValidTagKey,\n            style: {\n              color: isValidTagKey ? theme.colors.actionTertiaryTextDefault : theme.colors.actionDisabledText,\n            },\n            children: (\n              <Tooltip\n                title={\n                  isValidTagKey\n                    ? undefined\n                    : intl.formatMessage({\n                        defaultMessage: ', . : / - = and blank spaces are not allowed',\n                        description:\n                          'Key-value tag editor modal > Tag dropdown Manage Modal > Invalid characters error',\n                      })\n                }\n                placement=\"right\"\n              >\n                <span css={{ display: 'block' }}>\n                  <PlusIcon css={{ marginRight: theme.spacing.sm }} />\n                  {intl.formatMessage(\n                    {\n                      defaultMessage: 'Add tag \"{tagKey}\"',\n                      description: 'Key-value tag editor modal > Tag dropdown Manage Modal > Add new tag button',\n                    },\n                    {\n                      tagKey: searchValue,\n                    },\n                  )}\n                </span>\n              </Tooltip>\n            ),\n          },\n          key: searchValue,\n          groupOption: false,\n        },\n        ...menu.props.flattenOptions,\n      ],\n    });\n  }, [allAvailableTags, menu, searchValue, intl, theme]);\n\n  return resolvedMenu;\n}\n\nfunction getDropdownMenu(allAvailableTags: string[]) {\n  return (menu: React.ReactElement) => DropdownMenu(menu, allAvailableTags);\n}\n\n/**\n * Used in tag edit feature, allows selecting existing / adding new tag value\n */\nexport function TagKeySelectDropdown({\n  allAvailableTags,\n  control,\n  onKeyChangeCallback,\n}: {\n  allAvailableTags: string[];\n  control: Control<KeyValueEntity>;\n  onKeyChangeCallback?: (key?: string) => void;\n}) {\n  const intl = useIntl();\n  const [isOpen, setIsOpen] = useState(false);\n  const selectRef = useRef<{ blur: () => void; focus: () => void }>(null);\n\n  const { field, fieldState } = useController({\n    control: control,\n    name: 'key',\n    rules: {\n      required: {\n        message: intl.formatMessage({\n          defaultMessage: 'A tag key is required',\n          description: 'Key-value tag editor modal > Tag dropdown > Tag key required error message',\n        }),\n        value: true,\n      },\n    },\n  });\n\n  const handleDropdownVisibleChange = (visible: boolean) => {\n    setIsOpen(visible);\n  };\n\n  const handleClear = () => {\n    field.onChange(undefined);\n    onKeyChangeCallback?.(undefined);\n  };\n\n  const handleSelect = (key: string) => {\n    field.onChange(key);\n    onKeyChangeCallback?.(key);\n  };\n\n  return (\n    <LegacySelect\n      allowClear\n      ref={selectRef}\n      dangerouslySetAntdProps={{\n        showSearch: true,\n        dropdownRender: getDropdownMenu(allAvailableTags),\n      }}\n      css={{ width: '100%' }}\n      placeholder={intl.formatMessage({\n        defaultMessage: 'Type a key',\n        description: 'Key-value tag editor modal > Tag dropdown > Tag input placeholder',\n      })}\n      value={field.value}\n      defaultValue={field.value}\n      open={isOpen}\n      onDropdownVisibleChange={handleDropdownVisibleChange}\n      filterOption={(input, option) => option?.value.toLowerCase().includes(input.toLowerCase())}\n      onSelect={handleSelect}\n      onClear={handleClear}\n      validationState={fieldState.error ? 'error' : undefined}\n    >\n      {allAvailableTags.map((tag) => (\n        <LegacySelect.Option value={tag} key={tag}>\n          {tag}\n        </LegacySelect.Option>\n      ))}\n    </LegacySelect>\n  );\n}\n","import { isEqual, sortBy } from 'lodash';\nimport { useCallback, useMemo, useRef, useState } from 'react';\nimport { truncate } from 'lodash';\n\nimport {\n  Button,\n  FormUI,\n  Modal,\n  PlusIcon,\n  Popover,\n  RHFControlledComponents,\n  RestoreAntDDefaultClsPrefix,\n  Tooltip,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport { Typography } from '@databricks/design-system';\nimport { KeyValueEntity } from '../../experiment-tracking/types';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { useForm } from 'react-hook-form';\nimport { TagKeySelectDropdown } from '../components/TagSelectDropdown';\nimport { KeyValueTag } from '../components/KeyValueTag';\nimport { ErrorWrapper } from '../utils/ErrorWrapper';\n\nfunction getTagsMap(tags: KeyValueEntity[]) {\n  return new Map(tags.map((tag) => [tag.key, tag]));\n}\n\n/**\n * Provides methods to initialize and display modal used to add and remove tags from any compatible entity\n */\nexport const useEditKeyValueTagsModal = <T extends { tags?: KeyValueEntity[] }>({\n  onSuccess,\n  saveTagsHandler,\n  allAvailableTags,\n  valueRequired = false,\n}: {\n  onSuccess?: () => void;\n  saveTagsHandler: (editedEntity: T, existingTags: KeyValueEntity[], newTags: KeyValueEntity[]) => Promise<any>;\n  allAvailableTags?: string[];\n  valueRequired?: boolean;\n}) => {\n  const editedEntityRef = useRef<T>();\n  const [errorMessage, setErrorMessage] = useState<string>('');\n  const { theme } = useDesignSystemTheme();\n\n  const [initialTags, setInitialTags] = useState<Map<string, KeyValueEntity>>(new Map());\n  const [finalTags, setFinalTags] = useState<Map<string, KeyValueEntity>>(new Map());\n\n  const [showModal, setShowModal] = useState(false);\n\n  const form = useForm<KeyValueEntity>({\n    defaultValues: {\n      key: undefined,\n      value: '',\n    },\n  });\n\n  const hideModal = () => setShowModal(false);\n\n  /**\n   * Function used to invoke the modal and start editing tags of the particular model version\n   */\n  const showEditTagsModal = useCallback(\n    (editedEntity: T) => {\n      editedEntityRef.current = editedEntity;\n      setInitialTags(getTagsMap(editedEntity.tags || []));\n      setFinalTags(getTagsMap(editedEntity.tags || []));\n      form.reset();\n\n      setShowModal(true);\n    },\n    [form],\n  );\n\n  const saveTags = async () => {\n    if (!editedEntityRef.current) {\n      return;\n    }\n    setErrorMessage('');\n    setIsLoading(true);\n    saveTagsHandler(editedEntityRef.current, Array.from(initialTags.values()), Array.from(finalTags.values()))\n      .then(() => {\n        hideModal();\n        onSuccess?.();\n        setIsLoading(false);\n      })\n      .catch((e: ErrorWrapper | Error) => {\n        setIsLoading(false);\n        setErrorMessage(e instanceof ErrorWrapper ? e.getUserVisibleError()?.message : e.message);\n      });\n  };\n\n  const intl = useIntl();\n  const formValues = form.watch();\n\n  const [isLoading, setIsLoading] = useState(false);\n\n  const hasNewValues = useMemo(\n    () => !isEqual(sortBy(Array.from(initialTags.values()), 'key'), sortBy(Array.from(finalTags.values()), 'key')),\n    [initialTags, finalTags],\n  );\n  const isDirty = formValues.key || formValues.value;\n  const showPopoverMessage = hasNewValues && isDirty;\n\n  const onKeyChangeCallback = (key: string | undefined) => {\n    const tag = key ? finalTags.get(key) : undefined;\n    /**\n     * If a tag value exists for provided key, set the value to the existing tag value\n     */\n    form.setValue('value', tag?.value ?? '');\n  };\n\n  const handleTagDelete = ({ key }: KeyValueEntity) => {\n    setFinalTags((currentFinalTags) => {\n      currentFinalTags.delete(key);\n      return new Map(currentFinalTags);\n    });\n  };\n\n  const onSubmit = () => {\n    // Do not accept form if no value provided while it's required\n    if (valueRequired && !formValues.value.trim()) {\n      return;\n    }\n\n    // Add new tag to existing tags leaving only one tag per key value\n    const newEntries = new Map(finalTags);\n    newEntries.set(formValues.key, formValues);\n\n    setFinalTags(newEntries);\n    form.reset();\n  };\n\n  const EditTagsModal = (\n    <Modal\n      destroyOnClose\n      visible={showModal}\n      title={\n        <FormattedMessage\n          defaultMessage=\"Add/Edit tags\"\n          description=\"Key-value tag editor modal > Title of the update tags modal\"\n        />\n      }\n      onCancel={hideModal}\n      footer={\n        <RestoreAntDDefaultClsPrefix>\n          <Button\n            componentId=\"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_147\"\n            dangerouslyUseFocusPseudoClass\n            onClick={hideModal}\n            /**\n             * Hack: The footer will remove the margin to the save tags button\n             * if the button if wrapped on another component.\n             */\n            css={{ marginRight: !hasNewValues ? theme.spacing.sm : 0 }}\n          >\n            {intl.formatMessage({\n              defaultMessage: 'Cancel',\n              description: 'Key-value tag editor modal > Manage Tag cancel button',\n            })}\n          </Button>\n          {showPopoverMessage ? (\n            <UnsavedTagPopoverTrigger formValues={formValues} isLoading={isLoading} onSaveTask={saveTags} />\n          ) : (\n            <Tooltip\n              title={\n                !hasNewValues\n                  ? intl.formatMessage({\n                      defaultMessage: 'Please add or remove one or more tags before saving',\n                      description: 'Key-value tag editor modal > Tag disabled message',\n                    })\n                  : undefined\n              }\n            >\n              <Button\n                componentId=\"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_174\"\n                dangerouslyUseFocusPseudoClass\n                disabled={!hasNewValues}\n                loading={isLoading}\n                type=\"primary\"\n                onClick={saveTags}\n              >\n                {intl.formatMessage({\n                  defaultMessage: 'Save tags',\n                  description: 'Key-value tag editor modal > Manage Tag save button',\n                })}\n              </Button>\n            </Tooltip>\n          )}\n        </RestoreAntDDefaultClsPrefix>\n      }\n    >\n      <form\n        onSubmit={form.handleSubmit(onSubmit)}\n        css={{ display: 'flex', alignItems: 'flex-end', gap: theme.spacing.md }}\n      >\n        <div css={{ minWidth: 0, display: 'flex', gap: theme.spacing.md, flex: 1 }}>\n          <div css={{ flex: 1 }}>\n            <FormUI.Label htmlFor=\"key\">\n              {intl.formatMessage({\n                defaultMessage: 'Key',\n                description: 'Key-value tag editor modal > Key input label',\n              })}\n            </FormUI.Label>\n            <TagKeySelectDropdown\n              allAvailableTags={allAvailableTags || []}\n              control={form.control}\n              onKeyChangeCallback={onKeyChangeCallback}\n            />\n          </div>\n          <div css={{ flex: 1 }}>\n            <FormUI.Label htmlFor=\"value\">\n              {valueRequired\n                ? intl.formatMessage({\n                    defaultMessage: 'Value',\n                    description: 'Key-value tag editor modal > Value input label (required)',\n                  })\n                : intl.formatMessage({\n                    defaultMessage: 'Value (optional)',\n                    description: 'Key-value tag editor modal > Value input label',\n                  })}\n            </FormUI.Label>\n            <RHFControlledComponents.Input\n              name=\"value\"\n              control={form.control}\n              aria-label={\n                valueRequired\n                  ? intl.formatMessage({\n                      defaultMessage: 'Value',\n                      description: 'Key-value tag editor modal > Value input label (required)',\n                    })\n                  : intl.formatMessage({\n                      defaultMessage: 'Value (optional)',\n                      description: 'Key-value tag editor modal > Value input label',\n                    })\n              }\n              placeholder={intl.formatMessage({\n                defaultMessage: 'Type a value',\n                description: 'Key-value tag editor modal > Value input placeholder',\n              })}\n            />\n          </div>\n        </div>\n        <Tooltip\n          title={intl.formatMessage({\n            defaultMessage: 'Add tag',\n            description: 'Key-value tag editor modal > Add tag button',\n          })}\n        >\n          <Button\n            componentId=\"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_248\"\n            htmlType=\"submit\"\n            aria-label={intl.formatMessage({\n              defaultMessage: 'Add tag',\n              description: 'Key-value tag editor modal > Add tag button',\n            })}\n          >\n            <PlusIcon />\n          </Button>\n        </Tooltip>\n      </form>\n      {errorMessage && <FormUI.Message type=\"error\" message={errorMessage} />}\n      <div\n        css={{\n          display: 'flex',\n          rowGap: theme.spacing.xs,\n          flexWrap: 'wrap',\n          marginTop: theme.spacing.sm,\n        }}\n      >\n        {Array.from(finalTags.values()).map((tag) => (\n          <KeyValueTag isClosable tag={tag} onClose={() => handleTagDelete(tag)} key={tag.key} />\n        ))}\n      </div>\n    </Modal>\n  );\n\n  return { EditTagsModal, showEditTagsModal, isLoading };\n};\n\nfunction UnsavedTagPopoverTrigger({\n  isLoading,\n  formValues,\n  onSaveTask,\n}: {\n  isLoading: boolean;\n  formValues: any;\n  onSaveTask: () => void;\n}) {\n  const intl = useIntl();\n  const { theme } = useDesignSystemTheme();\n\n  const tagKeyDisplay = `${truncate(formValues.key, { length: 20 }) || '_'}`;\n  const tagValueDisplay = formValues.value ? `:${truncate(formValues.value, { length: 20 })}` : '';\n  const fullTagDisplay = `${tagKeyDisplay}${tagValueDisplay}`;\n\n  const shownText = intl.formatMessage(\n    {\n      defaultMessage: 'Are you sure you want to save and close without adding \"{tag}\"',\n      description: 'Key-value tag editor modal > Unsaved tag message',\n    },\n    {\n      tag: fullTagDisplay,\n    },\n  );\n  return (\n    <Popover.Root>\n      <Popover.Trigger asChild>\n        <Button\n          componentId=\"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_306\"\n          dangerouslyUseFocusPseudoClass\n          loading={isLoading}\n          type=\"primary\"\n        >\n          {intl.formatMessage({\n            defaultMessage: 'Save tags',\n            description: 'Key-value tag editor modal > Manage Tag save button',\n          })}\n        </Button>\n      </Popover.Trigger>\n      <Popover.Content align=\"end\" aria-label={shownText}>\n        <Typography.Paragraph css={{ maxWidth: 400 }}>{shownText}</Typography.Paragraph>\n        <Popover.Close asChild>\n          <Button\n            componentId=\"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_316\"\n            onClick={onSaveTask}\n          >\n            {intl.formatMessage({\n              defaultMessage: 'Yes, save and close',\n              description: 'Key-value tag editor modal > Unsaved tag message > Yes, save and close button',\n            })}\n          </Button>\n        </Popover.Close>\n        <Popover.Close asChild>\n          <Button\n            componentId=\"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_324\"\n            type=\"primary\"\n            css={{ marginLeft: theme.spacing.sm }}\n          >\n            {intl.formatMessage({\n              defaultMessage: 'Cancel',\n              description: 'Key-value tag editor modal > Unsaved tag message > cancel button',\n            })}\n          </Button>\n        </Popover.Close>\n        <Popover.Arrow />\n      </Popover.Content>\n    </Popover.Root>\n  );\n}\n","import { useEffect, useState } from 'react';\n\n/**\n * Hook that returns whether the browser tab is active or not.\n * @returns true if the tab is active, false otherwise\n */\nexport const useIsTabActive = () => {\n  const [isTabActive, setIsTabActive] = useState(document.visibilityState === 'visible');\n  useEffect(() => {\n    document.addEventListener('visibilitychange', (x) => {\n      setIsTabActive(document.visibilityState === 'visible');\n    });\n  }, []);\n  return isTabActive;\n};\n","const DEFAULT_MIN_COLUMNS = 1;\nconst DEFAULT_MAX_COLUMNS = 3;\nconst DEFAULT_MIN_COLUMN_WIDTH = 330;\nconst DEFAULT_GAP = 16;\n\n/**\n * Creates a CSS grid column setup with min/max number of columns.\n * See: https://stackoverflow.com/a/69154193\n */\nexport const getGridColumnSetup = ({\n  minColumns = DEFAULT_MIN_COLUMNS,\n  maxColumns = DEFAULT_MAX_COLUMNS,\n  minColumnWidth = DEFAULT_MIN_COLUMN_WIDTH,\n  gap = DEFAULT_GAP,\n  additionalBreakpoints = [],\n}: {\n  /**\n   * Minimum number of columns to display\n   */\n  minColumns?: number;\n  /**\n   * Maximum number of columns to display\n   */\n  maxColumns?: number;\n  /**\n   * Minimum column width\n   */\n  minColumnWidth?: number;\n  /**\n   * Gap between columns, in pixels\n   */\n  gap?: number;\n  /**\n   * Additional breakpoints to add to the grid. Defines the min breakpoint width and the minimum column width for that breakpoint.\n   * Does not use minimum and maximum use of columns.\n   */\n  additionalBreakpoints?: { breakpointWidth: number; minColumnWidthForBreakpoint?: number }[];\n}) => ({\n  display: 'grid',\n  gridTemplateColumns: `repeat(\n      auto-fit,\n      minmax(\n        min(\n          calc(\n            100%/${minColumns} - ${gap}px\n          ),\n          max(\n            ${minColumnWidth}px,\n            calc(100%/${maxColumns} - ${gap}px)\n          )\n        ),\n        1fr\n      )\n    )`,\n  gap,\n  ...additionalBreakpoints.reduce(\n    (acc, { breakpointWidth, minColumnWidthForBreakpoint }) => ({\n      ...acc,\n      [`@media (min-width: ${breakpointWidth}px)`]: {\n        gridTemplateColumns: `repeat(\n        auto-fit,\n        minmax(\n          ${minColumnWidthForBreakpoint}px,\n          1fr\n        )\n      )`,\n      },\n    }),\n    {},\n  ),\n});\n","/**\n * NOTE: this code file was automatically migrated to TypeScript using ts-migrate and\n * may contain multiple `any` type annotations and `@ts-expect-error` directives.\n * If possible, please improve types while making changes to this file. If the type\n * annotations are already looking good, please remove this comment.\n */\n\n/**\n * Utils for working with local storage.\n */\nexport default class LocalStorageUtils {\n  /**\n   * Protocol version of MLflow's local storage. Should be incremented on any breaking change in how\n   * data persisted in local storage is used, to prevent old (invalid) cached data from being loaded\n   * and breaking the application.\n   */\n  static version = '1.1';\n\n  /**\n   * Return a LocalStorageStore corresponding to the specified component and ID, where the ID\n   * can be used to disambiguate between multiple instances of cached data for the same component\n   * (e.g. cached data for multiple experiments).\n   */\n  static getStoreForComponent(componentName: any, id: any) {\n    return new LocalStorageStore([componentName, id].join('-'), 'localStorage');\n  }\n\n  static getSessionScopedStoreForComponent(componentName: any, id: any) {\n    return new LocalStorageStore([componentName, id].join('-'), 'sessionStorage');\n  }\n}\n\n/**\n * Interface to browser local storage that allows for setting key-value pairs under the specified\n * \"scope\".\n */\nclass LocalStorageStore {\n  constructor(scope: any, type: any) {\n    this.scope = scope;\n    if (type === 'localStorage') {\n      this.storageObj = window.localStorage;\n    } else {\n      this.storageObj = window.sessionStorage;\n    }\n  }\n  static reactComponentStateKey = 'ReactComponentState';\n\n  scope: any;\n  storageObj: any;\n\n  /**\n   * Loads React component state cached in local storage into a vanilla JS object.\n   */\n  loadComponentState() {\n    const storedVal = this.getItem(LocalStorageStore.reactComponentStateKey);\n    if (storedVal) {\n      return JSON.parse(storedVal);\n    }\n    return {};\n  }\n\n  /**\n   * Save React component state in local storage.\n   * @param stateRecord: Immutable.Record instance or plain object containing component state.\n   */\n  saveComponentState(stateRecord: any) {\n    const targetValue = typeof stateRecord.toJSON === 'function' ? stateRecord.toJSON() : stateRecord;\n    this.setItem(LocalStorageStore.reactComponentStateKey, JSON.stringify(targetValue));\n  }\n\n  /**\n   * Helper method for constructing a scoped key to use for setting/getting values in\n   * local storage.\n   */\n  withScopePrefix(key: any) {\n    return ['MLflowLocalStorage', LocalStorageUtils.version, this.scope, key].join('-');\n  }\n\n  /** Save the specified key-value pair in local storage. */\n  setItem(key: any, value: any) {\n    this.storageObj.setItem(this.withScopePrefix(key), value);\n  }\n\n  /** Fetch the value corresponding to the passed-in key from local storage. */\n  getItem(key: any) {\n    return this.storageObj.getItem(this.withScopePrefix(key));\n  }\n}\n","import { FolderBranchIcon, HomeIcon, NotebookIcon, WorkflowsIcon } from '@databricks/design-system';\nimport { SourceType } from '../sdk/MlflowEnums';\n\n/**\n * Displays an icon corresponding to the source type of an experiment run.\n */\nexport const ExperimentSourceTypeIcon = ({\n  sourceType,\n  className,\n}: {\n  sourceType: SourceType | string;\n  className?: string;\n}) => {\n  if (sourceType === SourceType.NOTEBOOK) {\n    return <NotebookIcon className={className} />;\n  } else if (sourceType === SourceType.LOCAL) {\n    return <HomeIcon className={className} />;\n  } else if (sourceType === SourceType.PROJECT) {\n    return <FolderBranchIcon className={className} />;\n  } else if (sourceType === SourceType.JOB) {\n    return <WorkflowsIcon className={className} />;\n  }\n  return null;\n};\n","import { CheckCircleIcon, ClockIcon, XCircleIcon, useDesignSystemTheme } from '@databricks/design-system';\n\nconst ErrorIcon = () => {\n  const { theme } = useDesignSystemTheme();\n  return <XCircleIcon css={{ color: theme.colors.textValidationDanger }} />;\n};\n\nconst FinishedIcon = () => {\n  const { theme } = useDesignSystemTheme();\n  return <CheckCircleIcon css={{ color: theme.colors.textValidationSuccess }} />;\n};\n\nexport const RunStatusIcon = ({ status }: { status: string }) => {\n  switch (status) {\n    case 'FAILED':\n    case 'KILLED':\n      return <ErrorIcon />;\n    case 'FINISHED':\n      return <FinishedIcon />;\n    case 'SCHEDULED':\n    case 'RUNNING':\n      return <ClockIcon />; // This one is the same color as the link\n    default:\n      return null;\n  }\n};\n","// This media query applies to screens with a pixel density of 2 or higher\n\nimport { debounce } from 'lodash';\nimport { useMemo, useState } from 'react';\nimport { COLORS_PALETTE_DATALIST_ID } from '../../../../common/components/ColorsPaletteDatalist';\nimport { visuallyHidden } from '@databricks/design-system';\n\n// and higher resolution values (e.g. Retina displays). 192 dpi is double the \"default\" historical 96 dpi.\nconst HIGH_RESOLUTION_MEDIA_QUERY = '@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi)';\n\nconst stripedHiddenBackgroundStyle = `repeating-linear-gradient(\n  135deg,\n  #959595 0,\n  #e7e7e7 1px,\n  #e7e7e7 2px,\n  #959595 3px,\n  #e7e7e7 4px,\n  #e7e7e7 5px,\n  #959595 6px,\n  #e7e7e7 7px,\n  #e7e7e7 8px,\n  #959595 9px,\n  #e7e7e7 10px,\n  #e7e7e7 11px,\n  #959595 12px,\n  #e7e7e7 13px,\n  #e7e7e7 14px\n)`;\n\n/**\n * Renders a colored rounded pill for a run.\n */\nexport const RunColorPill = ({\n  color,\n  hidden,\n  onChangeColor,\n  ...props\n}: {\n  color?: string;\n  hidden?: boolean;\n  onChangeColor?: (colorValue: string) => void;\n}) => {\n  const [colorValue, setColorValue] = useState<string | undefined>(undefined);\n\n  const onChangeColorDebounced = useMemo(() => {\n    // Implementations of <input type=\"color\"> vary from browser to browser, some browser\n    // fire an event on every color change so we debounce the event to avoid multiple\n    // calls to the onChangeColor handler.\n    if (onChangeColor) {\n      return debounce(onChangeColor, 300);\n    }\n    return () => {};\n  }, [onChangeColor]);\n\n  return (\n    <label\n      css={{\n        width: 12,\n        height: 12,\n        borderRadius: 6,\n        flexShrink: 0,\n        // Add a border to make the pill visible when using very light color\n        border: `1px solid ${hidden ? 'transparent' : 'rgba(0,0,0,0.1)'}`,\n        // Straighten it up on high-res screens\n        [HIGH_RESOLUTION_MEDIA_QUERY]: {\n          marginBottom: 1,\n        },\n        background: hidden ? stripedHiddenBackgroundStyle : undefined,\n        cursor: onChangeColor ? 'pointer' : 'default',\n        position: 'relative',\n        '&:hover': {\n          opacity: onChangeColor ? 0.8 : 1,\n        },\n      }}\n      style={{ backgroundColor: colorValue ?? color ?? 'transparent' }}\n      {...props}\n    >\n      <span\n        css={[\n          visuallyHidden,\n          {\n            userSelect: 'none',\n          },\n        ]}\n      >\n        {color}\n      </span>\n      {onChangeColor && (\n        <input\n          disabled={hidden}\n          type=\"color\"\n          value={colorValue ?? color}\n          onChange={({ target }) => {\n            setColorValue(target.value);\n            onChangeColorDebounced(target.value);\n          }}\n          list={COLORS_PALETTE_DATALIST_ID}\n          css={{\n            appearance: 'none',\n            width: 0,\n            height: 0,\n            border: 0,\n            padding: 0,\n            position: 'absolute',\n            bottom: 0,\n            visibility: 'hidden',\n          }}\n        />\n      )}\n    </label>\n  );\n};\n","import { Table, TableCell, TableHeader, TableRow } from '@databricks/design-system';\nimport { FormattedMessage } from 'react-intl';\n\nexport interface ExperimentViewDatasetSchemaTableProps {\n  schema: any[];\n  filter: string;\n}\n\nexport const ExperimentViewDatasetSchemaTable = ({\n  schema,\n  filter,\n}: ExperimentViewDatasetSchemaTableProps): JSX.Element => {\n  const hasFilter = (name?: string, type?: string) => {\n    return (\n      filter === '' ||\n      name?.toLowerCase().includes(filter.toLowerCase()) ||\n      type?.toLowerCase().includes(filter.toLowerCase())\n    );\n  };\n\n  const filteredSchema = schema.filter((row: { name: string; type: string }, _: number) =>\n    hasFilter(row.name, row.type),\n  );\n\n  const getNameHeader = () => {\n    return (\n      <FormattedMessage\n        defaultMessage=\"Name\"\n        description={'Header for \"name\" column in the experiment run dataset schema'}\n      />\n    );\n  };\n\n  const getTypeHeader = () => {\n    return <FormattedMessage defaultMessage=\"Type\" description={'Header for \"type\" column in the UC table schema'} />;\n  };\n\n  return (\n    <Table scrollable css={{ width: '100%' }}>\n      <TableRow isHeader>\n        <TableHeader>{getNameHeader()}</TableHeader>\n        <TableHeader>{getTypeHeader()}</TableHeader>\n      </TableRow>\n      <div onWheel={(e) => e.stopPropagation()}>\n        {filteredSchema.length === 0 ? (\n          <TableRow>\n            <TableCell>\n              <FormattedMessage\n                defaultMessage=\"No results match this search.\"\n                description=\"No results message in datasets drawer table\"\n              />\n            </TableCell>\n          </TableRow>\n        ) : (\n          filteredSchema.map((row: { name: string; type: string }, idx: number) => (\n            <TableRow key={`table-body-row-${idx}`}>\n              <TableCell>{row.name}</TableCell>\n              <TableCell>{row.type}</TableCell>\n            </TableRow>\n          ))\n        )}\n      </div>\n    </Table>\n  );\n};\n","import {\n  Header,\n  TableIcon,\n  useDesignSystemTheme,\n  Table,\n  TableCell,\n  TableHeader,\n  TableRow,\n  TableFilterInput,\n  Spacer,\n  Typography,\n} from '@databricks/design-system';\nimport { ExperimentViewDatasetSchemaTable } from './ExperimentViewDatasetSchemaTable';\nimport { DatasetSourceTypes, RunDatasetWithTags } from '../../../../types';\nimport { useEffect, useMemo, useState } from 'react';\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nexport interface DatasetsCellRendererProps {\n  datasetWithTags: RunDatasetWithTags;\n}\n\nexport const ExperimentViewDatasetSchema = ({ datasetWithTags }: DatasetsCellRendererProps): JSX.Element => {\n  const { theme } = useDesignSystemTheme();\n  const { dataset } = datasetWithTags;\n  const [filter, setFilter] = useState('');\n\n  if (dataset.schema === null || dataset.schema === '') {\n    return (\n      <div\n        css={{\n          display: 'flex',\n          flexDirection: 'column',\n          height: '100vh',\n        }}\n      >\n        <div\n          css={{\n            height: '100%',\n            display: 'flex',\n            flexDirection: 'column',\n            justifyContent: 'flex-start',\n            alignContent: 'center',\n          }}\n        >\n          <Header title={<div css={{ color: theme.colors.grey600 }}>No schema available</div>} />\n        </div>\n      </div>\n    );\n  }\n  try {\n    const schema = JSON.parse(dataset.schema);\n    if ('mlflow_colspec' in schema) {\n      // if the dataset schema is colspec\n      return (\n        <div\n          css={{\n            display: 'flex',\n            flexDirection: 'column',\n            overflow: 'hidden',\n            height: '100vh',\n          }}\n        >\n          <div\n            css={{\n              marginTop: theme.spacing.sm,\n              form: { width: '100%' },\n            }}\n          >\n            <TableFilterInput\n              value={filter}\n              placeholder=\"Search fields\"\n              onChange={(e) => setFilter(e.target.value)}\n              onClear={() => {\n                setFilter('');\n              }}\n              css={{ width: '100%' }}\n              containerProps={{ style: { width: 'auto' } }}\n            />\n          </div>\n          <div\n            css={{\n              marginTop: theme.spacing.sm,\n              overflow: 'hidden',\n            }}\n          >\n            <ExperimentViewDatasetSchemaTable schema={schema.mlflow_colspec} filter={filter} />\n          </div>\n        </div>\n      );\n    } else if ('mlflow_tensorspec' in schema) {\n      // if the dataset schema is tensorspec\n      return (\n        <div css={{ height: '100vh' }}>\n          <div\n            css={{\n              display: 'flex',\n              flexDirection: 'column',\n              alignItems: 'center',\n              justifyContent: 'center',\n              height: '100%',\n            }}\n          >\n            <TableIcon css={{ fontSize: '56px', color: theme.colors.grey600 }} />\n            <Header title={<div css={{ color: theme.colors.grey600 }}>Array Datasource</div>} />\n            <Typography.Text color={theme.colors.grey600} css={{ textAlign: 'center' }}>\n              <FormattedMessage\n                defaultMessage=\"The dataset is an array. To see a preview of the dataset, view the dataset in the training notebook.\"\n                description=\"Notification when the dataset is an array data source in the experiment run dataset schema\"\n              />\n            </Typography.Text>\n          </div>\n        </div>\n      );\n    } else {\n      // if the dataset schema is not colspec or tensorspec\n      return (\n        <div css={{ marginLeft: theme.spacing.lg, marginTop: theme.spacing.md, width: '100%' }}>\n          <div css={{ display: 'flex', flexDirection: 'column', justifyContent: 'flex-start' }}>\n            <Header title={<div css={{ color: theme.colors.grey600 }}>Unrecognized Schema Format</div>} />\n            <Typography.Text color={theme.colors.grey600}>\n              <FormattedMessage\n                defaultMessage=\"Raw Schema JSON: \"\n                description=\"Label for the raw schema JSON in the experiment run dataset schema\"\n              />\n              {JSON.stringify(schema)}\n            </Typography.Text>\n          </div>\n        </div>\n      );\n    }\n  } catch {\n    return (\n      <div css={{ marginLeft: theme.spacing.lg, marginTop: theme.spacing.md, width: '100%' }}>\n        <div css={{ display: 'flex', flexDirection: 'column', justifyContent: 'flex-start' }}>\n          <Header title={<div css={{ color: theme.colors.grey600 }}>No schema available</div>} />\n        </div>\n      </div>\n    );\n  }\n};\n","import { Button, CopyIcon, NewWindowIcon, Typography } from '@databricks/design-system';\nimport { DatasetSourceTypes, RunDatasetWithTags } from '../../../../types';\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { getDatasetSourceUrl } from '../../../../utils/DatasetUtils';\nimport { CopyButton } from '../../../../../shared/building_blocks/CopyButton';\n\nexport interface DatasetLinkProps {\n  datasetWithTags: RunDatasetWithTags;\n  runTags: Record<string, { key: string; value: string }>;\n}\n\nexport const ExperimentViewDatasetLink = ({ datasetWithTags, runTags }: DatasetLinkProps) => {\n  const { dataset } = datasetWithTags;\n  if (dataset.sourceType === DatasetSourceTypes.HTTP || dataset.sourceType === DatasetSourceTypes.HUGGING_FACE) {\n    const url = getDatasetSourceUrl(datasetWithTags);\n    if (url) {\n      return (\n        <Button\n          type=\"primary\"\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewdatasetlink.tsx_19_1\"\n          icon={<NewWindowIcon />}\n          href={url}\n          target=\"_blank\"\n        >\n          <FormattedMessage\n            defaultMessage=\"Open dataset\"\n            description=\"Text for the HTTP/HF location link in the experiment run dataset drawer\"\n          />\n        </Button>\n      );\n    }\n  }\n  if (dataset.sourceType === DatasetSourceTypes.S3) {\n    const url = getDatasetSourceUrl(datasetWithTags);\n    if (url) {\n      return (\n        <CopyButton\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewdatasetlink.tsx_19_2\"\n          icon={<CopyIcon />}\n          copyText={url}\n        >\n          <FormattedMessage\n            defaultMessage=\"Copy S3 URI to clipboard\"\n            description=\"Text for the HTTP/HF location link in the experiment run dataset drawer\"\n          />\n        </CopyButton>\n      );\n    }\n  }\n  if (dataset.sourceType === DatasetSourceTypes.EXTERNAL) {\n    return (\n      <Button\n        componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewdatasetlink.tsx_19_3\"\n        icon={<NewWindowIcon />}\n      >\n        <FormattedMessage\n          defaultMessage=\"Go to external location\"\n          description=\"Text for the external location link in the experiment run dataset drawer\"\n        />\n      </Button>\n    );\n  }\n  return null;\n};\n","import { Typography } from '@databricks/design-system';\nimport { DatasetSourceTypes, RunDatasetWithTags } from '../../../../types';\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nexport interface ExperimentViewDatasetSourceTypeProps {\n  datasetWithTags: RunDatasetWithTags;\n}\n\nexport const ExperimentViewDatasetSourceType = ({ datasetWithTags }: ExperimentViewDatasetSourceTypeProps) => {\n  const { dataset } = datasetWithTags;\n\n  const sourceType = dataset.sourceType;\n\n  const getSourceTypeLabel = () => {\n    if (sourceType === DatasetSourceTypes.HTTP || sourceType === DatasetSourceTypes.EXTERNAL) {\n      return (\n        <FormattedMessage\n          defaultMessage=\"HTTP\"\n          description=\"Experiment dataset drawer > source type > HTTP source type label\"\n        />\n      );\n    }\n    if (sourceType === DatasetSourceTypes.S3) {\n      return (\n        <FormattedMessage\n          defaultMessage=\"S3\"\n          description=\"Experiment dataset drawer > source type > S3 source type label\"\n        />\n      );\n    }\n    if (sourceType === DatasetSourceTypes.HUGGING_FACE) {\n      return (\n        <FormattedMessage\n          defaultMessage=\"Hugging Face\"\n          description=\"Experiment dataset drawer > source type > Hugging Face source type label\"\n        />\n      );\n    }\n    return null;\n  };\n\n  const typeLabel = getSourceTypeLabel();\n\n  if (typeLabel) {\n    return (\n      <Typography.Hint>\n        <FormattedMessage\n          defaultMessage=\"Source type: {typeLabel}\"\n          description=\"Experiment dataset drawer > source type > label\"\n          values={{ typeLabel }}\n        />\n      </Typography.Hint>\n    );\n  }\n\n  return null;\n};\n","import { Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport { DatasetSourceTypes, RunDatasetWithTags } from '../../../../types';\nimport { getDatasetSourceUrl } from '../../../../utils/DatasetUtils';\n\nexport interface ExperimentViewDatasetSourceProps {\n  datasetWithTags: RunDatasetWithTags;\n}\n\nexport const ExperimentViewDatasetSourceURL = ({ datasetWithTags }: ExperimentViewDatasetSourceProps) => {\n  const { dataset } = datasetWithTags;\n  const { theme } = useDesignSystemTheme();\n\n  const sourceType = dataset.sourceType;\n\n  if (\n    sourceType === DatasetSourceTypes.HTTP ||\n    sourceType === DatasetSourceTypes.EXTERNAL ||\n    sourceType === DatasetSourceTypes.HUGGING_FACE\n  ) {\n    const url = getDatasetSourceUrl(datasetWithTags);\n    if (url) {\n      return (\n        <div\n          css={{\n            whiteSpace: 'nowrap',\n            display: 'flex',\n            fontSize: theme.typography.fontSizeSm,\n            color: theme.colors.textSecondary,\n            columnGap: theme.spacing.xs,\n          }}\n          title={url}\n        >\n          URL:{' '}\n          <Typography.Link openInNewTab href={url} css={{ display: 'flex', overflow: 'hidden' }}>\n            <span css={{ overflow: 'hidden', textOverflow: 'ellipsis' }}>{url}</span>\n          </Typography.Link>\n        </div>\n      );\n    }\n  }\n  if (sourceType === DatasetSourceTypes.S3) {\n    try {\n      const { uri } = JSON.parse(dataset.source);\n      if (uri) {\n        return (\n          <Typography.Hint\n            title={uri}\n            css={{\n              whiteSpace: 'nowrap',\n              overflow: 'hidden',\n              textOverflow: 'ellipsis',\n            }}\n          >\n            S3 URI: {uri}\n          </Typography.Hint>\n        );\n      }\n    } catch {\n      return null;\n    }\n  }\n  return null;\n};\n","import { Typography } from '@databricks/design-system';\nimport { RunDatasetWithTags } from '../../../../types';\nimport { FormattedMessage } from 'react-intl';\n\nexport const ExperimentViewDatasetDigest = ({ datasetWithTags }: { datasetWithTags: RunDatasetWithTags }) => {\n  const { dataset } = datasetWithTags;\n  return (\n    <Typography.Hint>\n      <FormattedMessage\n        defaultMessage=\"Digest: {digest}\"\n        description=\"Experiment dataset drawer > digest > label and value\"\n        values={{ digest: <code>{dataset.digest}</code> }}\n      />\n    </Typography.Hint>\n  );\n};\n","import React from 'react';\nimport { useState } from 'react';\nimport {\n  Button,\n  Drawer,\n  Header,\n  Spacer,\n  TableIcon,\n  Tag,\n  Tooltip,\n  Typography,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport type { RunDatasetWithTags } from '../../../../types';\nimport { MLFLOW_RUN_DATASET_CONTEXT_TAG } from '../../../../constants';\nimport { Divider } from 'antd';\nimport { ExperimentViewDatasetSchema } from './ExperimentViewDatasetSchema';\nimport { ExperimentViewDatasetLink } from './ExperimentViewDatasetLink';\nimport { Link } from '../../../../../common/utils/RoutingUtils';\nimport Routes from '../../../../routes';\nimport { FormattedMessage } from 'react-intl';\nimport { ExperimentViewDatasetWithContext } from './ExperimentViewDatasetWithContext';\nimport { RunColorPill } from '../RunColorPill';\nimport { ExperimentViewDatasetSourceType } from './ExperimentViewDatasetSourceType';\nimport { ExperimentViewDatasetSourceURL } from './ExperimentViewDatasetSourceURL';\nimport { ExperimentViewDatasetDigest } from './ExperimentViewDatasetDigest';\nimport { useSelector } from 'react-redux';\nimport { ReduxState } from '../../../../../redux-types';\nimport { useGetExperimentRunColor } from '../../hooks/useExperimentRunColor';\n\nexport type DatasetWithRunType = {\n  datasetWithTags: RunDatasetWithTags;\n  runData: {\n    experimentId?: string;\n    tags?: Record<string, { key: string; value: string }>;\n    runUuid: string;\n    runName?: string;\n    datasets: RunDatasetWithTags[];\n  };\n};\n\nexport interface DatasetsCellRendererProps {\n  isOpen: boolean;\n  setIsOpen: (open: boolean) => void;\n  selectedDatasetWithRun: DatasetWithRunType;\n  setSelectedDatasetWithRun: (datasetWithRun: DatasetWithRunType) => void;\n}\n\nconst DRAWER_WITDH = '800px';\nconst MAX_PROFILE_LENGTH = 80;\n\nexport const ExperimentViewDatasetDrawerImpl = ({\n  isOpen,\n  setIsOpen,\n  selectedDatasetWithRun,\n  setSelectedDatasetWithRun,\n}: DatasetsCellRendererProps): JSX.Element => {\n  const { theme } = useDesignSystemTheme();\n  const { datasetWithTags, runData } = selectedDatasetWithRun;\n  const contextTag = selectedDatasetWithRun\n    ? datasetWithTags?.tags?.find((tag) => tag.key === MLFLOW_RUN_DATASET_CONTEXT_TAG)\n    : undefined;\n  const fullProfile =\n    datasetWithTags.dataset.profile && datasetWithTags.dataset.profile !== 'null'\n      ? datasetWithTags.dataset.profile\n      : undefined;\n\n  const getRunColor = useGetExperimentRunColor();\n  const { experimentId = '', tags = {} } = runData;\n\n  return (\n    <Drawer.Root\n      open={isOpen}\n      onOpenChange={(open) => {\n        if (!open) {\n          setIsOpen(false);\n        }\n      }}\n    >\n      <Drawer.Content\n        title={\n          <div css={{ display: 'flex', alignItems: 'center', height: '100%' }}>\n            <Typography.Title level={4} css={{ marginRight: theme.spacing.sm, marginBottom: 0 }}>\n              <FormattedMessage\n                defaultMessage=\"Data details for \"\n                description=\"Text for data details for the experiment run in the dataset drawer\"\n              />\n            </Typography.Title>\n            <Link to={Routes.getRunPageRoute(experimentId, runData.runUuid)} css={styles.runLink}>\n              <RunColorPill color={getRunColor(runData.runUuid)} />\n              <span css={styles.runName}>{runData.runName}</span>\n            </Link>\n          </div>\n        }\n        width={DRAWER_WITDH}\n        footer={<Spacer size=\"xs\" />}\n      >\n        <div\n          css={{\n            display: 'flex',\n            borderTop: `1px solid ${theme.colors.border}`,\n            height: '100%',\n            marginLeft: -theme.spacing.sm,\n          }}\n        >\n          {/* column for dataset selection */}\n          <div\n            css={{\n              display: 'flex',\n              flexDirection: 'column',\n              width: '300px',\n              borderRight: `1px solid ${theme.colors.border}`,\n              height: '100%',\n            }}\n          >\n            <Typography.Text\n              color=\"secondary\"\n              css={{\n                marginBottom: theme.spacing.sm,\n                marginTop: theme.spacing.sm,\n                paddingLeft: theme.spacing.sm,\n              }}\n            >\n              {runData.datasets.length}{' '}\n              <FormattedMessage\n                defaultMessage=\"datasets used\"\n                description=\"Text for dataset count in the experiment run dataset drawer\"\n              />\n            </Typography.Text>\n            <div\n              css={{\n                display: 'flex',\n                flexDirection: 'column',\n                height: '100%',\n                overflow: 'auto',\n              }}\n              onWheel={(e) => e.stopPropagation()}\n            >\n              {runData.datasets.map((dataset) => (\n                <div\n                  key={`${dataset.dataset.name}-${dataset.dataset.digest}`}\n                  css={{\n                    display: 'flex',\n                    flexDirection: 'column',\n                    justifyContent: 'center',\n                    backgroundColor:\n                      dataset.dataset.name === datasetWithTags.dataset.name &&\n                      dataset.dataset.digest === datasetWithTags.dataset.digest\n                        ? theme.colors.backgroundSecondary\n                        : 'transparent',\n                    borderTop: `1px solid ${theme.colors.border}`,\n                    paddingBottom: theme.spacing.sm,\n                    paddingTop: theme.spacing.sm,\n                    paddingLeft: theme.spacing.sm,\n                  }}\n                >\n                  <Button\n                    componentId=\"codegen_mlflow_app_src_experiment-tracking_components_experiment-page_components_runs_experimentviewdatasetdrawer.tsx_151\"\n                    type=\"link\"\n                    css={{\n                      textAlign: 'left',\n                      overflowX: 'auto',\n                      overflowY: 'hidden',\n                    }}\n                    onClick={() => {\n                      setSelectedDatasetWithRun({ datasetWithTags: dataset, runData: runData });\n                      setIsOpen(true);\n                    }}\n                  >\n                    <ExperimentViewDatasetWithContext datasetWithTags={dataset} displayTextAsLink={false} />\n                  </Button>\n                </div>\n              ))}\n            </div>\n          </div>\n          {/* column for dataset details */}\n          <div\n            css={{\n              overflow: 'hidden',\n              paddingLeft: theme.spacing.md,\n              paddingTop: theme.spacing.md,\n              display: 'flex',\n              flexDirection: 'column',\n              width: '100%',\n            }}\n          >\n            {/* dataset metadata */}\n            <div\n              css={{\n                display: 'flex',\n                gap: theme.spacing.sm,\n              }}\n            >\n              <div css={{ flex: '1' }}>\n                <Header\n                  title={\n                    <div css={{ display: 'flex', flexDirection: 'row', alignItems: 'center' }}>\n                      <TableIcon css={{ marginRight: theme.spacing.xs }} />\n                      <Tooltip title={datasetWithTags.dataset.name}>\n                        <Typography.Title ellipsis level={3} css={{ marginBottom: 0, maxWidth: 200 }}>\n                          {datasetWithTags.dataset.name}\n                        </Typography.Title>\n                      </Tooltip>\n                      {contextTag && (\n                        <Tag\n                          css={{\n                            textTransform: 'capitalize',\n                            marginLeft: theme.spacing.xs,\n                            marginRight: theme.spacing.xs,\n                          }}\n                        >\n                          {contextTag.value}\n                        </Tag>\n                      )}\n                    </div>\n                  }\n                />\n                <Typography.Title\n                  level={4}\n                  color=\"secondary\"\n                  css={{ marginBottom: theme.spacing.xs, marginTop: theme.spacing.xs }}\n                  title={fullProfile}\n                >\n                  {datasetWithTags.dataset.profile && datasetWithTags.dataset.profile !== 'null' ? (\n                    datasetWithTags.dataset.profile.length > MAX_PROFILE_LENGTH ? (\n                      `${datasetWithTags.dataset.profile.substring(0, MAX_PROFILE_LENGTH)} ...`\n                    ) : (\n                      datasetWithTags.dataset.profile\n                    )\n                  ) : (\n                    <FormattedMessage\n                      defaultMessage=\"No profile available\"\n                      description=\"Text for no profile available in the experiment run dataset drawer\"\n                    />\n                  )}\n                </Typography.Title>\n              </div>\n              <ExperimentViewDatasetLink datasetWithTags={datasetWithTags} runTags={tags} />\n            </div>\n            <div css={{ flexShrink: 0, display: 'flex', flexDirection: 'column', gap: theme.spacing.xs }}>\n              <ExperimentViewDatasetDigest datasetWithTags={datasetWithTags} />\n              <ExperimentViewDatasetSourceType datasetWithTags={datasetWithTags} />\n              <ExperimentViewDatasetSourceURL datasetWithTags={datasetWithTags} />\n            </div>\n            {/* dataset schema */}\n            <Divider css={{ marginTop: theme.spacing.sm, marginBottom: theme.spacing.xs }} />\n            <ExperimentViewDatasetSchema datasetWithTags={datasetWithTags} />\n          </div>\n        </div>\n      </Drawer.Content>\n    </Drawer.Root>\n  );\n};\n\n// Memoize the component so it rerenders only when props change directly, preventing\n// rerenders caused e.g. by the overarching context provider.\nexport const ExperimentViewDatasetDrawer = React.memo(ExperimentViewDatasetDrawerImpl);\n\nconst styles = {\n  runLink: {\n    overflow: 'hidden',\n    display: 'flex',\n    gap: 8,\n    alignItems: 'center',\n  },\n  runName: {\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    fontSize: '13px',\n  },\n};\n","import { TableIcon, Tag, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport type { RunDatasetWithTags } from '../../../../types';\nimport React from 'react';\nimport { MLFLOW_RUN_DATASET_CONTEXT_TAG } from '../../../../constants';\n\nexport interface DatasetWithContextProps {\n  datasetWithTags: RunDatasetWithTags;\n  displayTextAsLink: boolean;\n  className?: string;\n}\n\nexport const ExperimentViewDatasetWithContext = ({\n  datasetWithTags,\n  displayTextAsLink,\n  className,\n}: DatasetWithContextProps) => {\n  const { dataset, tags } = datasetWithTags;\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        flexDirection: 'row',\n        alignItems: 'center',\n        marginTop: theme.spacing.xs,\n        marginBottom: theme.spacing.xs,\n      }}\n      className={className}\n    >\n      <TableIcon css={{ marginRight: theme.spacing.xs, color: theme.colors.textSecondary }} />\n      {displayTextAsLink ? (\n        <div>\n          {dataset.name} ({dataset.digest})\n        </div>\n      ) : (\n        <Typography.Text size=\"md\" css={{ marginBottom: 0 }}>\n          {dataset.name} ({dataset.digest})\n        </Typography.Text>\n      )}\n      <Tag\n        css={{\n          textTransform: 'capitalize',\n          marginLeft: theme.spacing.xs,\n          marginRight: theme.spacing.xs,\n        }}\n      >\n        {tags && tags.find(({ key }) => key === MLFLOW_RUN_DATASET_CONTEXT_TAG)?.value}\n      </Tag>\n    </div>\n  );\n};\n","import React, { ReactNode, useMemo } from 'react';\nimport { ExperimentPageUIState, createExperimentPageUIState } from '../models/ExperimentPageUIState';\n\nconst ExperimentPageUISetStateContext = React.createContext<\n  React.Dispatch<React.SetStateAction<ExperimentPageUIState>>\n>((state) => state);\n\n// Creates contexts for setting current UI state\nexport const ExperimentPageUIStateContextProvider = ({\n  children,\n  setUIState,\n}: {\n  children: ReactNode;\n  setUIState: React.Dispatch<React.SetStateAction<ExperimentPageUIState>>;\n}) => (\n  <ExperimentPageUISetStateContext.Provider value={setUIState}>{children}</ExperimentPageUISetStateContext.Provider>\n);\n\nexport const useUpdateExperimentViewUIState = () => React.useContext(ExperimentPageUISetStateContext);\n","import qs from 'qs';\nimport { useMemo } from 'react';\nimport { useParams, useLocation } from '../../../../common/utils/RoutingUtils';\nimport Utils from '../../../../common/utils/Utils';\n\nexport type UseExperimentIdsResult = string[];\n\n/**\n * Hook that returns requested experiment IDs basing on the URL.\n * It extracts ids basing on either route match (in case of a single experiment)\n * or query params (in case of comparing experiments.).\n *\n * @returns array of strings with experiment IDs\n */\n\nexport const useExperimentIds = (): UseExperimentIdsResult => {\n  const params = useParams<{ experimentId?: string }>();\n  const location = useLocation();\n\n  const normalizedLocationSearch = useMemo(() => decodeURIComponent(location.search), [location.search]);\n\n  /**\n   * Memoized string containing experiment IDs for comparison (\"?experiments=...\")\n   */\n  const compareExperimentIdsQueryParam = useMemo(() => {\n    const queryParams = qs.parse(normalizedLocationSearch.substring(1));\n    if (queryParams['experiments']) {\n      const experimentIdsRaw = queryParams['experiments'];\n      return experimentIdsRaw?.toString() || '';\n    }\n\n    return '';\n  }, [normalizedLocationSearch]);\n\n  return useMemo(() => {\n    // Case #1: single experiment\n    if (params?.experimentId) {\n      return [params?.experimentId];\n    }\n\n    // Case #2: multiple (compare) experiments\n    if (compareExperimentIdsQueryParam) {\n      try {\n        return JSON.parse(compareExperimentIdsQueryParam);\n      } catch {\n        // Apparently URL is malformed\n        Utils.logErrorAndNotifyUser(`Could not parse experiment query parameter ${compareExperimentIdsQueryParam}`);\n        return '';\n      }\n    }\n\n    return [];\n  }, [compareExperimentIdsQueryParam, params?.experimentId]);\n};\n","import Utils from 'common/utils/Utils';\nimport { listImagesApi } from 'experiment-tracking/actions';\nimport { EXPERIMENT_RUNS_IMAGE_AUTO_REFRESH_INTERVAL } from 'experiment-tracking/constants';\nimport { useEffect, useRef } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { ThunkDispatch } from 'redux-types';\nimport { NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE } from 'experiment-tracking/constants';\n\nexport const usePopulateImagesByRunUuid = ({\n  runUuids,\n  runUuidsIsActive,\n  autoRefreshEnabled,\n  enabled,\n}: {\n  runUuids: string[];\n  runUuidsIsActive: boolean[];\n  autoRefreshEnabled?: boolean;\n  enabled?: boolean;\n}) => {\n  // Retrieve image keys for each run. This should only re-render when the runUuids change.\n  // This populates the imagesByRunUuid with imageKeys, which will be used elsewhere to fetch metadata.\n  const dispatch = useDispatch<ThunkDispatch>();\n\n  /**\n   * The criteria to populate images for a run is\n   * 1. The run is not hidden\n   * 2. The run includes the mlflow.loggedImage tag\n   * 3. The run's image is not already populated\n   */\n  // We need to use a serialized version of runUuids to avoid re-triggering the effect when using an array.\n  const runUuidsSerialized = runUuids.slice(0, NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE).join(',');\n  useEffect(() => {\n    // Regular single fetch event with no auto-refresh capabilities. Used if auto-refresh is disabled.\n    if (!enabled || autoRefreshEnabled) {\n      return;\n    }\n    runUuidsSerialized.split(',').forEach((runUuid) => {\n      if (runUuid) {\n        dispatch(listImagesApi(runUuid));\n      }\n    });\n  }, [runUuidsSerialized, dispatch, autoRefreshEnabled, enabled]);\n\n  const refreshTimeoutRef = useRef<number | undefined>(undefined);\n  const autoRefreshEnabledRef = useRef(autoRefreshEnabled && enabled);\n  autoRefreshEnabledRef.current = autoRefreshEnabled;\n\n  const runUuidsIsActiveSerialized = runUuidsIsActive.slice(0, NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE).join(',');\n  // A fetch effect with auto-refresh capabilities. Used only if auto-refresh is enabled.\n  useEffect(() => {\n    let hookUnmounted = false;\n\n    if (!enabled || !autoRefreshEnabled) {\n      return;\n    }\n\n    const fetchImagesFn = async (autoRefresh: boolean) => {\n      const runUuids = runUuidsSerialized.split(',');\n\n      const activeRunUuids = runUuidsIsActiveSerialized.split(',');\n      // If auto-refresh is enabled, only fetch images for runs that are currently active\n      const filteredRunUuids = autoRefresh ? runUuids.filter((_, index) => activeRunUuids[index] === 'true') : runUuids;\n\n      filteredRunUuids.forEach((runUuid) => {\n        if (runUuid) {\n          dispatch(listImagesApi(runUuid, autoRefresh));\n        }\n      });\n    };\n\n    const scheduleRefresh = async () => {\n      // Initial check to confirm that auto-refresh is still enabled and the hook is still mounted\n      if (!autoRefreshEnabledRef.current || hookUnmounted) {\n        return;\n      }\n      try {\n        await fetchImagesFn(true);\n      } catch (e) {\n        // In case of error during auto-refresh, log the error but do break the auto-refresh loop\n        Utils.logErrorAndNotifyUser(e);\n      }\n      clearTimeout(refreshTimeoutRef.current);\n\n      // After loading the data, schedule the next refresh if the hook is still enabled and mounted\n      if (!autoRefreshEnabledRef.current || hookUnmounted) {\n        return;\n      }\n\n      refreshTimeoutRef.current = window.setTimeout(scheduleRefresh, EXPERIMENT_RUNS_IMAGE_AUTO_REFRESH_INTERVAL);\n    };\n\n    fetchImagesFn(false).then(scheduleRefresh);\n\n    return () => {\n      fetchImagesFn(true);\n      // Mark the hook as unmounted to prevent scheduling new auto-refreshes with current data\n      hookUnmounted = true;\n      // Clear the timeout\n      clearTimeout(refreshTimeoutRef.current);\n    };\n  }, [dispatch, runUuidsSerialized, runUuidsIsActiveSerialized, autoRefreshEnabled, enabled]);\n};\n","/**\n * NOTE: this code file was automatically migrated to TypeScript using ts-migrate and\n * may contain multiple `any` type annotations and `@ts-expect-error` directives.\n * If possible, please improve types while making changes to this file. If the type\n * annotations are already looking good, please remove this comment.\n */\n\nimport React, { Component } from 'react';\nimport { Modal } from '@databricks/design-system';\n\ntype Props = {\n  isOpen: boolean;\n  handleSubmit: (...args: any[]) => any;\n  onClose: (...args: any[]) => any;\n  title: React.ReactNode;\n  helpText: React.ReactNode;\n  confirmButtonText: React.ReactNode;\n};\n\ntype State = any;\n\nexport class ConfirmModal extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.onRequestCloseHandler = this.onRequestCloseHandler.bind(this);\n    this.handleSubmitWrapper = this.handleSubmitWrapper.bind(this);\n  }\n\n  state = {\n    isSubmitting: false,\n  };\n\n  onRequestCloseHandler() {\n    if (!this.state.isSubmitting) {\n      this.props.onClose();\n    }\n  }\n\n  handleSubmitWrapper() {\n    this.setState({ isSubmitting: true });\n    return this.props.handleSubmit().finally(() => {\n      this.props.onClose();\n      this.setState({ isSubmitting: false });\n    });\n  }\n\n  render() {\n    return (\n      <Modal\n        data-testid=\"confirm-modal\"\n        title={this.props.title}\n        visible={this.props.isOpen}\n        onOk={this.handleSubmitWrapper}\n        okText={this.props.confirmButtonText}\n        confirmLoading={this.state.isSubmitting}\n        onCancel={this.onRequestCloseHandler}\n        // @ts-expect-error TS(2322): Type '{ children: Element; \"data-testid\": string; ... Remove this comment to see the full error message\n        centered\n      >\n        <div className=\"modal-explanatory-text\">{this.props.helpText}</div>\n      </Modal>\n    );\n  }\n}\n","/**\n * NOTE: this code file was automatically migrated to TypeScript using ts-migrate and\n * may contain multiple `any` type annotations and `@ts-expect-error` directives.\n * If possible, please improve types while making changes to this file. If the type\n * annotations are already looking good, please remove this comment.\n */\n\nimport React, { Component } from 'react';\nimport { ConfirmModal } from './ConfirmModal';\nimport { deleteRunApi, openErrorModal } from '../../actions';\nimport { connect } from 'react-redux';\nimport Utils from '../../../common/utils/Utils';\nimport { IntlShape, injectIntl } from 'react-intl';\n\ntype Props = {\n  isOpen: boolean;\n  onClose: (...args: any[]) => any;\n  selectedRunIds: string[];\n  openErrorModal: (...args: any[]) => any;\n  deleteRunApi: (...args: any[]) => any;\n  onSuccess?: () => void;\n  intl: IntlShape;\n};\n\nexport class DeleteRunModalImpl extends Component<Props> {\n  constructor(props: Props) {\n    super(props);\n    this.handleSubmit = this.handleSubmit.bind(this);\n  }\n\n  handleSubmit() {\n    const deletePromises: any = [];\n    this.props.selectedRunIds.forEach((runId) => {\n      deletePromises.push(this.props.deleteRunApi(runId));\n    });\n    return Promise.all(deletePromises)\n      .catch(() => {\n        const errorModalContent = `${this.props.intl.formatMessage({\n          defaultMessage: 'While deleting an experiment run, an error occurred.',\n          description: 'Experiment tracking > delete run modal > error message',\n        })}`;\n        this.props.openErrorModal(errorModalContent);\n      })\n      .then(() => {\n        this.props.onSuccess?.();\n      });\n  }\n\n  render() {\n    const number = this.props.selectedRunIds.length;\n    return (\n      <ConfirmModal\n        isOpen={this.props.isOpen}\n        onClose={this.props.onClose}\n        handleSubmit={this.handleSubmit}\n        title={`Delete Experiment ${Utils.pluralize('Run', number)}`}\n        helpText={\n          <div>\n            <p>\n              <b>\n                {number} experiment {Utils.pluralize('run', number)} will be deleted.\n              </b>\n            </p>\n            {/* @ts-expect-error TS(4111): Property 'SHOW_GDPR_PURGING_MESSAGES' comes from a... Remove this comment to see the full error message */}\n            {process.env.SHOW_GDPR_PURGING_MESSAGES === 'true' ? (\n              <p>\n                Deleted runs are restorable for 30 days, after which they are purged along with associated metrics,\n                params, tags, and artifacts.\n              </p>\n            ) : (\n              ''\n            )}\n          </div>\n        }\n        confirmButtonText=\"Delete\"\n      />\n    );\n  }\n}\n\nconst mapDispatchToProps = {\n  deleteRunApi,\n  openErrorModal,\n};\n\nexport default connect(null, mapDispatchToProps)(injectIntl(DeleteRunModalImpl));\n","/**\n * NOTE: this code file was automatically migrated to TypeScript using ts-migrate and\n * may contain multiple `any` type annotations and `@ts-expect-error` directives.\n * If possible, please improve types while making changes to this file. If the type\n * annotations are already looking good, please remove this comment.\n */\n\nimport React, { Component } from 'react';\nimport { Modal } from '@databricks/design-system';\n\nimport Utils from '../../../common/utils/Utils';\n\ntype Props = {\n  okText?: string;\n  cancelText?: string;\n  isOpen?: boolean;\n  onClose: (...args: any[]) => any;\n  onCancel?: (...args: any[]) => any;\n  className?: string;\n  footer?: React.ReactNode;\n  handleSubmit: (...args: any[]) => any;\n  title: React.ReactNode;\n};\n\ntype State = any;\n\n/**\n * Generic modal that has a title and an input field with a save/submit button.\n * As of now, it is used to display the 'Rename Run' and 'Rename Experiment' modals.\n */\nexport class GenericInputModal extends Component<Props, State> {\n  state = {\n    isSubmitting: false,\n  };\n\n  formRef = React.createRef();\n\n  onSubmit = async () => {\n    this.setState({ isSubmitting: true });\n    try {\n      const values = await (this as any).formRef.current.validateFields();\n\n      // call handleSubmit from parent component, pass form values\n      // handleSubmit is expected to return a promise\n      return await this.props\n        .handleSubmit(values)\n        .then(this.resetAndClearModalForm)\n        .catch(this.handleSubmitFailure)\n        .finally(this.onRequestCloseHandler);\n    } catch (e) {\n      this.setState({ isSubmitting: false });\n      return Promise.reject(e);\n    }\n  };\n\n  resetAndClearModalForm = () => {\n    this.setState({ isSubmitting: false });\n    (this as any).formRef.current.resetFields();\n  };\n\n  handleSubmitFailure = (e: any) => {\n    this.setState({ isSubmitting: false });\n    Utils.logErrorAndNotifyUser(e);\n  };\n\n  onRequestCloseHandler = () => {\n    if (!this.state.isSubmitting) {\n      this.resetAndClearModalForm();\n      this.props.onClose();\n    }\n  };\n\n  handleCancel = () => {\n    this.onRequestCloseHandler();\n    // Check for optional `onCancel` method prop.\n    if (this.props.onCancel !== undefined) {\n      this.props.onCancel();\n    }\n  };\n\n  render() {\n    const { isSubmitting } = this.state;\n    const { okText, cancelText, isOpen, footer, children } = this.props;\n\n    // add props (ref) to passed component\n    const displayForm = React.Children.map(children, (child) => {\n      // Checking isValidElement is the safe way and avoids a typescript\n      // error too.\n      if (React.isValidElement(child)) {\n        // @ts-expect-error TODO: fix this\n        return React.cloneElement(child, { innerRef: this.formRef });\n      }\n      return child;\n    });\n\n    return (\n      <Modal\n        data-testid=\"mlflow-input-modal\"\n        className={this.props.className}\n        title={this.props.title}\n        // @ts-expect-error TS(2322): Type '{ children: {}[] | null | undefined; \"data-t... Remove this comment to see the full error message\n        width={540}\n        visible={isOpen}\n        onOk={this.onSubmit}\n        okText={okText}\n        cancelText={cancelText}\n        confirmLoading={isSubmitting}\n        onCancel={this.handleCancel}\n        footer={footer}\n        centered\n      >\n        {displayForm}\n      </Modal>\n    );\n  }\n}\n","/**\n * NOTE: this code file was automatically migrated to TypeScript using ts-migrate and\n * may contain multiple `any` type annotations and `@ts-expect-error` directives.\n * If possible, please improve types while making changes to this file. If the type\n * annotations are already looking good, please remove this comment.\n */\n\nimport React, { Component } from 'react';\n\nimport { Form, Input } from '@databricks/design-system';\n\nexport const NEW_NAME_FIELD = 'newName';\n\ntype Props = {\n  type: string;\n  name: string;\n  visible: boolean;\n  validator?: (...args: any[]) => any;\n  innerRef: any;\n};\n\n/**\n * Component that renders a form for updating a run's or experiment's name.\n */\nclass RenameFormComponent extends Component<Props> {\n  inputToAutoFocus: any;\n\n  componentDidUpdate(prevProps: Props) {\n    this.autoFocus(prevProps);\n    this.resetFields(prevProps);\n  }\n\n  autoFocusInputRef = (inputToAutoFocus: any) => {\n    this.inputToAutoFocus = inputToAutoFocus;\n    inputToAutoFocus && inputToAutoFocus.focus();\n    inputToAutoFocus && inputToAutoFocus.select();\n  };\n\n  autoFocus = (prevProps: any) => {\n    if (prevProps.visible === false && this.props.visible === true) {\n      // focus on input field\n      this.inputToAutoFocus && this.inputToAutoFocus.focus();\n      // select text\n      this.inputToAutoFocus && this.inputToAutoFocus.select();\n    }\n  };\n\n  resetFields = (prevProps: any) => {\n    const formRef = this.props.innerRef;\n    if (prevProps.name !== this.props.name) {\n      // reset input field to reset displayed initialValue\n      formRef.current.resetFields([NEW_NAME_FIELD]);\n    }\n  };\n\n  render() {\n    return (\n      // @ts-expect-error TS(2322): Type '{ children: Element; ref: any; layout: \"vert... Remove this comment to see the full error message\n      <Form ref={this.props.innerRef} layout=\"vertical\">\n        <Form.Item\n          name={NEW_NAME_FIELD}\n          initialValue={this.props.name}\n          rules={[\n            { required: true, message: `Please input a new name for the ${this.props.type}.` },\n            { validator: this.props.validator },\n          ]}\n          label={`New ${this.props.type} name`}\n        >\n          <Input\n            placeholder={`Input a ${this.props.type} name`}\n            ref={this.autoFocusInputRef}\n            data-testid=\"rename-modal-input\"\n          />\n        </Form.Item>\n      </Form>\n    );\n  }\n}\n\nexport const RenameForm = RenameFormComponent;\n","/**\n * NOTE: this code file was automatically migrated to TypeScript using ts-migrate and\n * may contain multiple `any` type annotations and `@ts-expect-error` directives.\n * If possible, please improve types while making changes to this file. If the type\n * annotations are already looking good, please remove this comment.\n */\n\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { IntlShape, injectIntl } from 'react-intl';\n\nimport { GenericInputModal } from './GenericInputModal';\nimport { RenameForm, NEW_NAME_FIELD } from './RenameForm';\n\nimport { updateRunApi } from '../../actions';\nimport { getUUID } from '../../../common/utils/ActionUtils';\n\ntype Props = {\n  isOpen?: boolean;\n  runUuid: string;\n  runName: string;\n  onClose: (...args: any[]) => any;\n  updateRunApi: (...args: any[]) => any;\n  intl: IntlShape;\n  onSuccess?: (...args: any[]) => any;\n};\n\nexport class RenameRunModalImpl extends Component<Props> {\n  handleRenameRun = (values: any) => {\n    // get value of input field\n    const newRunName = values[NEW_NAME_FIELD];\n\n    const updateRunRequestId = getUUID();\n\n    return this.props\n      .updateRunApi(this.props.runUuid, newRunName, updateRunRequestId)\n      .then(() => this.props.onSuccess?.());\n  };\n\n  render() {\n    const { isOpen, runName } = this.props;\n    return (\n      <GenericInputModal\n        title={this.props.intl.formatMessage({\n          defaultMessage: 'Rename Run',\n          description: 'Modal title to rename the experiment run name',\n        })}\n        okText={this.props.intl.formatMessage({\n          defaultMessage: 'Save',\n          description: 'Modal button text to save the changes to rename the experiment run name',\n        })}\n        isOpen={isOpen}\n        handleSubmit={this.handleRenameRun}\n        onClose={this.props.onClose}\n      >\n        <RenameForm\n          type=\"run\"\n          name={runName}\n          // @ts-expect-error TS(2769): No overload matches this call.\n          visible={isOpen}\n          validator={async (_, value) => {\n            if (typeof value === 'string' && value.length && !value.trim()) {\n              throw new Error(\n                this.props.intl.formatMessage({\n                  defaultMessage: 'Run name cannot consist only of whitespace!',\n                  description: \"An error shown when user sets the run's name to whitespace characters only\",\n                }),\n              );\n            }\n            return true;\n          }}\n        />\n      </GenericInputModal>\n    );\n  }\n}\n\nconst mapDispatchToProps = {\n  updateRunApi,\n};\n\nexport const RenameRunModalWithIntl = injectIntl(RenameRunModalImpl);\nexport const RenameRunModal = connect(undefined, mapDispatchToProps)(RenameRunModalWithIntl);\n","import { LegacySelect, Typography, useDesignSystemTheme } from '@databricks/design-system';\nimport React, { ComponentProps, PropsWithChildren } from 'react';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { makeCanonicalSortKey } from '../../../experiment-page/utils/experimentPage.common-utils';\nimport { shouldUseNewRunRowsVisibilityModel } from '../../../../../common/utils/FeatureUtils';\n\n/**\n * Represents a field in the compare run charts configuration modal.\n * Displays a title and content with proper margins.\n */\nexport const RunsChartsConfigureField = ({\n  title,\n  children,\n}: PropsWithChildren<{\n  title: string;\n}>) => {\n  const { theme } = useDesignSystemTheme();\n  return (\n    <div css={{ marginBottom: theme.spacing.md * 2 }} data-testid=\"experiment-view-compare-runs-config-field\">\n      <Typography.Title level={4}>{title}:</Typography.Title>\n      {children}\n    </div>\n  );\n};\n\n/**\n * A searchable select for selecting metric or param from a categorized list.\n */\nexport const RunsChartsMetricParamSelect = ({\n  value,\n  onChange,\n  metricKeyList,\n  paramKeyList,\n}: {\n  value: string;\n  onChange: ComponentProps<typeof LegacySelect>['onChange'];\n  metricKeyList?: string[];\n  paramKeyList?: string[];\n}) => {\n  const { formatMessage } = useIntl();\n\n  const isEmpty = !paramKeyList?.length && !metricKeyList?.length;\n\n  return (\n    <LegacySelect\n      css={styles.selectFull}\n      value={\n        isEmpty\n          ? formatMessage({\n              description:\n                'Message displayed when no metrics or params are available in the compare runs chart configure modal',\n              defaultMessage: 'No metrics or parameters available',\n            })\n          : value\n      }\n      disabled={isEmpty}\n      onChange={onChange}\n      dangerouslySetAntdProps={{ showSearch: true }}\n    >\n      {metricKeyList?.length ? (\n        <LegacySelect.OptGroup\n          label={formatMessage({\n            defaultMessage: 'Metrics',\n            description: \"Label for 'metrics' option group in the compare runs chart configure modal\",\n          })}\n        >\n          {metricKeyList.map((metric) => (\n            <LegacySelect.Option\n              key={makeCanonicalSortKey('METRIC', metric)}\n              value={makeCanonicalSortKey('METRIC', metric)}\n            >\n              {metric}\n            </LegacySelect.Option>\n          ))}\n        </LegacySelect.OptGroup>\n      ) : null}\n      {paramKeyList?.length ? (\n        <LegacySelect.OptGroup\n          label={formatMessage({\n            defaultMessage: 'Params',\n            description: \"Label for 'params' option group in the compare runs chart configure modal\",\n          })}\n        >\n          {paramKeyList.map((param) => (\n            <LegacySelect.Option\n              key={makeCanonicalSortKey('PARAM', param)}\n              value={makeCanonicalSortKey('PARAM', param)}\n            >\n              {param}\n            </LegacySelect.Option>\n          ))}\n        </LegacySelect.OptGroup>\n      ) : null}\n    </LegacySelect>\n  );\n};\n\nexport const RunsChartsRunNumberSelect = ({\n  onChange,\n  value,\n  options,\n}: {\n  value?: number;\n  onChange: ComponentProps<typeof LegacySelect<number>>['onChange'];\n  options: (number | { value: number; label: React.ReactNode })[];\n}) => {\n  const { formatMessage } = useIntl();\n\n  // After moving to the new run rows visibility model, we don't configure run count per chart\n  if (shouldUseNewRunRowsVisibilityModel()) {\n    return null;\n  }\n  return (\n    <RunsChartsConfigureField\n      title={formatMessage({\n        defaultMessage: 'Max. no of runs shown',\n        description: 'Label for the control allowing selection of number of runs displayed in a compare runs chart',\n      })}\n    >\n      <LegacySelect<number> css={styles.selectFull} value={value} onChange={onChange}>\n        {options.map((countOption) => {\n          const optionValue = typeof countOption === 'number' ? countOption : countOption.value;\n          const label = typeof countOption === 'number' ? countOption : countOption.label;\n          return (\n            <LegacySelect.Option key={optionValue} value={optionValue}>\n              {label}\n            </LegacySelect.Option>\n          );\n        })}\n      </LegacySelect>\n    </RunsChartsConfigureField>\n  );\n};\n\nexport const runsChartsRunCountDefaultOptions: { value: number; label: React.ReactNode }[] = [\n  // We're not using any procedural generation so react-intl extractor can parse it\n  {\n    value: 5,\n    label: (\n      <FormattedMessage\n        defaultMessage=\"5\"\n        description=\"Label for 5 first runs visible in run count selector within runs compare configuration modal\"\n      />\n    ),\n  },\n  {\n    value: 10,\n    label: (\n      <FormattedMessage\n        defaultMessage=\"10\"\n        description=\"Label for 10 first runs visible in run count selector within runs compare configuration modal\"\n      />\n    ),\n  },\n  {\n    value: 20,\n    label: (\n      <FormattedMessage\n        defaultMessage=\"20\"\n        description=\"Label for 20 first runs visible in run count selector within runs compare configuration modal\"\n      />\n    ),\n  },\n];\n\nconst styles = { selectFull: { width: '100%' } };\n","import { LegacySelect } from '@databricks/design-system';\nimport { useCallback, useEffect } from 'react';\nimport type { RunsChartsCardConfig, RunsChartsBarCardConfig } from '../../runs-charts.types';\nimport {\n  RunsChartsConfigureField,\n  runsChartsRunCountDefaultOptions,\n  RunsChartsRunNumberSelect,\n} from './RunsChartsConfigure.common';\n\n/**\n * Form containing configuration controls for runs compare charts.\n */\nexport const RunsChartsConfigureBarChart = ({\n  state,\n  onStateChange,\n  metricKeyList,\n}: {\n  metricKeyList: string[];\n  state: Partial<RunsChartsBarCardConfig>;\n  onStateChange: (setter: (current: RunsChartsCardConfig) => RunsChartsBarCardConfig) => void;\n}) => {\n  /**\n   * Callback for updating metric key\n   */\n  const updateMetric = useCallback(\n    (metricKey: string) => {\n      onStateChange((current) => ({ ...(current as RunsChartsBarCardConfig), metricKey }));\n    },\n    [onStateChange],\n  );\n\n  /**\n   * Callback for updating run count\n   */\n  const updateVisibleRunCount = useCallback(\n    (runsCountToCompare: number) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsBarCardConfig),\n        runsCountToCompare,\n      }));\n    },\n    [onStateChange],\n  );\n\n  /**\n   * If somehow metric key is not predetermined, automatically\n   * select the first one so it's not empty\n   */\n  useEffect(() => {\n    if (!state.metricKey && metricKeyList?.[0]) {\n      updateMetric(metricKeyList[0]);\n    }\n  }, [state.metricKey, updateMetric, metricKeyList]);\n\n  const emptyMetricsList = metricKeyList.length === 0;\n\n  return (\n    <>\n      <RunsChartsConfigureField title=\"Metric\">\n        <LegacySelect\n          css={styles.selectFull}\n          value={emptyMetricsList ? 'No metrics available' : state.metricKey}\n          onChange={updateMetric}\n          disabled={emptyMetricsList}\n          dangerouslySetAntdProps={{ showSearch: true }}\n        >\n          {metricKeyList.map((metric) => (\n            <LegacySelect.Option key={metric} value={metric} data-testid={`metric-${metric}`}>\n              {metric}\n            </LegacySelect.Option>\n          ))}\n        </LegacySelect>\n      </RunsChartsConfigureField>\n      <RunsChartsRunNumberSelect\n        value={state.runsCountToCompare}\n        onChange={updateVisibleRunCount}\n        options={runsChartsRunCountDefaultOptions}\n      />\n    </>\n  );\n};\n\nconst styles = { selectFull: { width: '100%' } };\n","import { LegacySelect } from '@databricks/design-system';\nimport { useCallback } from 'react';\nimport type { RunsChartsCardConfig, RunsChartsParallelCardConfig } from '../../runs-charts.types';\nimport { RunsChartsConfigureField } from './RunsChartsConfigure.common';\n\n/**\n * Form containing configuration controls for runs compare charts.\n */\nexport const RunsChartsConfigureParallelChart = ({\n  state,\n  onStateChange,\n  metricKeyList,\n  paramKeyList,\n}: {\n  metricKeyList: string[];\n  paramKeyList: string[];\n  state: Partial<RunsChartsParallelCardConfig>;\n  onStateChange: (setter: (current: RunsChartsCardConfig) => RunsChartsParallelCardConfig) => void;\n}) => {\n  /**\n   * Callback for updating selected metrics and params\n   */\n\n  const updateSelectedParams = useCallback(\n    (selectedParams: string[]) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsParallelCardConfig),\n        selectedParams,\n      }));\n    },\n    [onStateChange],\n  );\n\n  const updateSelectedMetrics = useCallback(\n    (selectedMetrics: string[]) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsParallelCardConfig),\n        selectedMetrics,\n      }));\n    },\n    [onStateChange],\n  );\n\n  const emptyMetricsList = metricKeyList.length === 0;\n  const emptyParamsList = paramKeyList.length === 0;\n\n  return (\n    <>\n      <RunsChartsConfigureField title=\"Params\">\n        <LegacySelect\n          mode={emptyParamsList ? undefined : 'multiple'}\n          onChange={updateSelectedParams}\n          style={{\n            width: 300,\n          }}\n          value={emptyParamsList ? ('No parameters available' as any) : state.selectedParams}\n          disabled={emptyParamsList}\n        >\n          {paramKeyList.map((param) => (\n            <LegacySelect.Option value={param} key={param}>\n              {param}\n            </LegacySelect.Option>\n          ))}\n        </LegacySelect>\n      </RunsChartsConfigureField>\n      <RunsChartsConfigureField title=\"Metrics\">\n        <LegacySelect\n          mode={emptyMetricsList ? undefined : 'multiple'}\n          onChange={updateSelectedMetrics}\n          style={{\n            width: 300,\n          }}\n          value={emptyMetricsList ? ('No metrics available' as any) : state.selectedMetrics}\n          disabled={emptyMetricsList}\n        >\n          {metricKeyList.map((metric) => (\n            <LegacySelect.Option value={metric} key={metric}>\n              {metric}\n            </LegacySelect.Option>\n          ))}\n        </LegacySelect>\n      </RunsChartsConfigureField>\n    </>\n  );\n};\n","import {\n  Radio,\n  LegacySelect,\n  Switch,\n  Tooltip,\n  QuestionMarkIcon,\n  Form,\n  useDesignSystemTheme,\n  ThemeType,\n  SegmentedControlGroup,\n  SegmentedControlButton,\n  InfoIcon,\n} from '@databricks/design-system';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { useCallback, useEffect, useState } from 'react';\nimport type { RunsChartsCardConfig, RunsChartsLineCardConfig } from '../../runs-charts.types';\nimport { RunsChartsConfigureField, RunsChartsRunNumberSelect } from './RunsChartsConfigure.common';\nimport { shouldEnableDeepLearningUIPhase3 } from 'common/utils/FeatureUtils';\nimport { RunsChartsLineChartXAxisType } from 'experiment-tracking/components/runs-charts/components/RunsCharts.common';\nimport { LineSmoothSlider } from 'experiment-tracking/components/LineSmoothSlider';\n\nconst renderMetricSelectorV1 = ({\n  metricKeyList,\n  metricKey,\n  updateMetric,\n}: {\n  metricKeyList: string[];\n  metricKey?: string;\n  updateMetric: (metricKey: string) => void;\n}) => {\n  const emptyMetricsList = metricKeyList.length === 0;\n\n  return (\n    <LegacySelect\n      css={styles.selectFull}\n      value={emptyMetricsList ? 'No metrics available' : metricKey}\n      onChange={updateMetric}\n      disabled={emptyMetricsList}\n      dangerouslySetAntdProps={{ showSearch: true }}\n    >\n      {metricKeyList.map((metric) => (\n        <LegacySelect.Option key={metric} value={metric} data-testid={`metric-${metric}`}>\n          {metric}\n        </LegacySelect.Option>\n      ))}\n    </LegacySelect>\n  );\n};\n\nconst renderMetricSelectorV2 = ({\n  metricKeyList,\n  selectedMetricKeys,\n  updateSelectedMetrics,\n}: {\n  metricKeyList: string[];\n  selectedMetricKeys?: string[];\n  updateSelectedMetrics: (metricKeys: string[]) => void;\n}) => {\n  const emptyMetricsList = metricKeyList.length === 0;\n\n  return (\n    <LegacySelect\n      mode=\"multiple\"\n      placeholder={\n        emptyMetricsList ? (\n          <FormattedMessage\n            defaultMessage=\"No metrics available\"\n            description=\"Text shown in a disabled multi-selector when there are no selectable metrics.\"\n          />\n        ) : (\n          <FormattedMessage\n            defaultMessage=\"Select metrics\"\n            description=\"Placeholder text for a metric multi-selector when configuring a line chart\"\n          />\n        )\n      }\n      css={styles.selectFull}\n      value={emptyMetricsList ? [] : selectedMetricKeys}\n      onChange={updateSelectedMetrics}\n      disabled={emptyMetricsList}\n      dangerouslySetAntdProps={{ showSearch: true }}\n    >\n      {metricKeyList.map((metric) => (\n        <LegacySelect.Option key={metric} value={metric} data-testid={`metric-${metric}`}>\n          {metric}\n        </LegacySelect.Option>\n      ))}\n    </LegacySelect>\n  );\n};\n\nconst renderXAxisMetricSelector = ({\n  theme,\n  metricKeyList,\n  selectedXAxisMetricKey,\n  updateSelectedXAxisMetricKey,\n}: {\n  theme: ThemeType;\n  metricKeyList: string[];\n  selectedXAxisMetricKey?: string;\n  updateSelectedXAxisMetricKey: (metricKey: string) => void;\n}) => {\n  const emptyMetricsList = metricKeyList.length === 0;\n\n  return (\n    <Radio value={RunsChartsLineChartXAxisType.METRIC}>\n      <FormattedMessage\n        defaultMessage=\"Metric\"\n        description=\"Label for a radio button that configures the x-axis on a line chart. This option makes the X-axis a custom metric that the user selects.\"\n      />\n      <LegacySelect\n        css={{\n          marginTop: theme.spacing.xs,\n          width: '100%',\n        }}\n        value={selectedXAxisMetricKey || undefined}\n        placeholder={\n          emptyMetricsList ? (\n            <FormattedMessage\n              defaultMessage=\"No metrics available\"\n              description=\"Text shown in a disabled metric selector when there are no selectable metrics.\"\n            />\n          ) : (\n            <FormattedMessage\n              defaultMessage=\"Select metric\"\n              description=\"Placeholder text for a metric selector when configuring a line chart\"\n            />\n          )\n        }\n        onClick={(e: React.MouseEvent<HTMLElement>) => {\n          // this is to prevent the radio button\n          // from automatically closing the selector\n          e.preventDefault();\n          e.stopPropagation();\n        }}\n        onChange={updateSelectedXAxisMetricKey}\n        disabled={emptyMetricsList}\n        dangerouslySetAntdProps={{ showSearch: true }}\n      >\n        {metricKeyList.map((metric) => (\n          <LegacySelect.Option key={metric} value={metric} data-testid={`metric-${metric}`}>\n            {metric}\n          </LegacySelect.Option>\n        ))}\n      </LegacySelect>\n    </Radio>\n  );\n};\n\n/**\n * Form containing configuration controls for runs compare charts.\n */\nexport const RunsChartsConfigureLineChart = ({\n  state,\n  onStateChange,\n  metricKeyList,\n}: {\n  metricKeyList: string[];\n  state: Partial<RunsChartsLineCardConfig>;\n  onStateChange: (setter: (current: RunsChartsCardConfig) => RunsChartsLineCardConfig) => void;\n}) => {\n  const shouldEnableMetricsOnXAxis = shouldEnableDeepLearningUIPhase3();\n  const { theme } = useDesignSystemTheme();\n  const intl = useIntl();\n  const runSelectOptions = [5, 10, 20, 50, 100];\n\n  /**\n   * Callback for updating metric key\n   */\n  const updateMetric = useCallback(\n    (metricKey: string) => {\n      onStateChange((current) => ({ ...(current as RunsChartsLineCardConfig), metricKey }));\n    },\n    [onStateChange],\n  );\n\n  const updateSelectedMetrics = useCallback(\n    (metricKeys: string[]) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsLineCardConfig),\n        metricKey: metricKeys[0],\n        selectedMetricKeys: metricKeys,\n      }));\n    },\n    [onStateChange],\n  );\n\n  const updateXAxisKey = useCallback(\n    (xAxisKey: RunsChartsLineCardConfig['xAxisKey']) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsLineCardConfig),\n        xAxisKey,\n        selectedXAxisMetricKey: '',\n      }));\n    },\n    [onStateChange],\n  );\n\n  const updateXAxisScaleType = useCallback(\n    (isLogType: boolean) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsLineCardConfig),\n        xAxisScaleType: isLogType ? 'log' : 'linear',\n      }));\n    },\n    [onStateChange],\n  );\n\n  const updateSelectedXAxisMetricKey = useCallback(\n    (selectedXAxisMetricKey: string) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsLineCardConfig),\n        selectedXAxisMetricKey,\n        xAxisKey: RunsChartsLineChartXAxisType.METRIC,\n      }));\n    },\n    [onStateChange],\n  );\n\n  const updateYAxisType = useCallback(\n    (isLogType: boolean) =>\n      onStateChange((current) => ({\n        ...(current as RunsChartsLineCardConfig),\n        scaleType: isLogType ? 'log' : 'linear',\n      })),\n    [onStateChange],\n  );\n\n  const updateSmoothing = useCallback(\n    (lineSmoothness: number) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsLineCardConfig),\n        lineSmoothness: lineSmoothness,\n      }));\n    },\n    [onStateChange],\n  );\n\n  /**\n   * Callback for updating run count\n   */\n  const updateVisibleRunCount = useCallback(\n    (runsCountToCompare: number) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsLineCardConfig),\n        runsCountToCompare,\n      }));\n    },\n    [onStateChange],\n  );\n\n  /**\n   * If somehow metric key is not predetermined, automatically\n   * select the first one so it's not empty\n   */\n  useEffect(() => {\n    if (!state.metricKey && metricKeyList?.[0]) {\n      updateMetric(metricKeyList[0]);\n    }\n  }, [state.metricKey, updateMetric, metricKeyList]);\n\n  // for backwards compatibility, if selectedMetricKeys\n  // is not present, set it using metricKey.\n  useEffect(() => {\n    if (state.selectedMetricKeys === undefined && state.metricKey !== undefined && state.metricKey !== '') {\n      updateSelectedMetrics([state.metricKey]);\n    }\n  }, [state.selectedMetricKeys, state.metricKey, updateSelectedMetrics]);\n\n  return (\n    <>\n      <RunsChartsConfigureField title=\"Metric (Y-axis)\">\n        {renderMetricSelectorV2({\n          metricKeyList,\n          selectedMetricKeys: state.selectedMetricKeys,\n          updateSelectedMetrics,\n        })}\n      </RunsChartsConfigureField>\n      <RunsChartsConfigureField title=\"X-axis\">\n        <Radio.Group\n          name=\"runs-charts-field-group-x-axis\"\n          value={state.xAxisKey}\n          onChange={({ target: { value } }) => updateXAxisKey(value)}\n        >\n          <Radio value={RunsChartsLineChartXAxisType.STEP}>\n            <FormattedMessage\n              defaultMessage=\"Step\"\n              description=\"Label for a radio button that configures the x-axis on a line chart. This option is for the step number that the metrics were logged.\"\n            />\n          </Radio>\n          <Radio value={RunsChartsLineChartXAxisType.TIME}>\n            <FormattedMessage\n              defaultMessage=\"Time (wall)\"\n              description=\"Label for a radio button that configures the x-axis on a line chart. This option is for the absolute time that the metrics were logged.\"\n            />\n            <Tooltip\n              title={\n                <FormattedMessage\n                  defaultMessage=\"Absolute date and time\"\n                  description=\"A tooltip line chart configuration for the step function of wall time\"\n                />\n              }\n              placement=\"right\"\n            >\n              {' '}\n              <QuestionMarkIcon css={styles.timeStepQuestionMarkIcon} />\n            </Tooltip>\n          </Radio>\n          <Radio value={RunsChartsLineChartXAxisType.TIME_RELATIVE}>\n            <FormattedMessage\n              defaultMessage=\"Time (relative)\"\n              description=\"Label for a radio button that configures the x-axis on a line chart. This option is for relative time since the first metric was logged.\"\n            />\n            <Tooltip\n              title={\n                <FormattedMessage\n                  defaultMessage=\"Amount of time that has passed since the first metric value was logged\"\n                  description=\"A tooltip line chart configuration for the step function of relative time\"\n                />\n              }\n              placement=\"right\"\n            >\n              {' '}\n              <QuestionMarkIcon css={styles.timeStepQuestionMarkIcon} />\n            </Tooltip>\n          </Radio>\n          {shouldEnableMetricsOnXAxis &&\n            renderXAxisMetricSelector({\n              theme,\n              metricKeyList,\n              selectedXAxisMetricKey: state.selectedXAxisMetricKey,\n              updateSelectedXAxisMetricKey,\n            })}\n        </Radio.Group>\n      </RunsChartsConfigureField>\n      {state.xAxisKey === RunsChartsLineChartXAxisType.STEP && (\n        <RunsChartsConfigureField title=\"X-axis log scale\">\n          <Switch checked={state.xAxisScaleType === 'log'} onChange={updateXAxisScaleType} label=\"Enabled\" />\n        </RunsChartsConfigureField>\n      )}\n      <RunsChartsConfigureField title=\"Y-axis log scale\">\n        <Switch checked={state.scaleType === 'log'} onChange={updateYAxisType} label=\"Enabled\" />\n      </RunsChartsConfigureField>\n      <RunsChartsConfigureField\n        title={intl.formatMessage({\n          defaultMessage: 'Display points',\n          description: 'Runs charts > line chart > display points > label',\n        })}\n      >\n        <SegmentedControlGroup\n          name={intl.formatMessage({\n            defaultMessage: 'Display points',\n            description: 'Runs charts > line chart > display points > label',\n          })}\n          value={state.displayPoints}\n          onChange={({ target }) => {\n            onStateChange((current) => ({\n              ...(current as RunsChartsLineCardConfig),\n              displayPoints: target.value,\n            }));\n          }}\n        >\n          <SegmentedControlButton\n            value={undefined}\n            aria-label={[\n              intl.formatMessage({\n                defaultMessage: 'Display points',\n                description: 'Runs charts > line chart > display points > label',\n              }),\n              intl.formatMessage({\n                defaultMessage: 'Auto',\n                description: 'Runs charts > line chart > display points > auto setting label',\n              }),\n            ].join(': ')}\n          >\n            <FormattedMessage\n              defaultMessage=\"Auto\"\n              description=\"Runs charts > line chart > display points > auto setting label\"\n            />{' '}\n            <Tooltip\n              title={\n                <FormattedMessage\n                  defaultMessage=\"Show points on line charts if there are fewer than 60 data points per trace\"\n                  description=\"Runs charts > line chart > display points > auto tooltip\"\n                />\n              }\n            >\n              <InfoIcon />\n            </Tooltip>\n          </SegmentedControlButton>\n          <SegmentedControlButton\n            value\n            aria-label={[\n              intl.formatMessage({\n                defaultMessage: 'Display points',\n                description: 'Runs charts > line chart > display points > label',\n              }),\n              intl.formatMessage({\n                defaultMessage: 'On',\n                description: 'Runs charts > line chart > display points > on setting label',\n              }),\n            ].join(': ')}\n          >\n            <FormattedMessage\n              defaultMessage=\"On\"\n              description=\"Runs charts > line chart > display points > on setting label\"\n            />\n          </SegmentedControlButton>\n          <SegmentedControlButton\n            value={false}\n            aria-label={[\n              intl.formatMessage({\n                defaultMessage: 'Display points',\n                description: 'Runs charts > line chart > display points > label',\n              }),\n              intl.formatMessage({\n                defaultMessage: 'Off',\n                description: 'Runs charts > line chart > display points > off setting label',\n              }),\n            ].join(': ')}\n          >\n            <FormattedMessage\n              defaultMessage=\"Off\"\n              description=\"Runs charts > line chart > display points > off setting label\"\n            />\n          </SegmentedControlButton>\n        </SegmentedControlGroup>\n      </RunsChartsConfigureField>\n      <RunsChartsConfigureField title=\"Line smoothness\">\n        <LineSmoothSlider\n          data-testid=\"smoothness-toggle\"\n          min={0}\n          max={100}\n          onChange={updateSmoothing}\n          defaultValue={state.lineSmoothness ? state.lineSmoothness : 0}\n        />\n      </RunsChartsConfigureField>\n      <RunsChartsRunNumberSelect\n        value={state.runsCountToCompare}\n        onChange={updateVisibleRunCount}\n        options={runSelectOptions}\n      />\n    </>\n  );\n};\n\nconst styles = {\n  selectFull: { width: '100%' },\n  timeStepQuestionMarkIcon: () => ({\n    svg: { width: 12, height: 12 },\n  }),\n};\n","import { LegacySkeleton } from '@databricks/design-system';\nimport { useMemo } from 'react';\nimport { connect } from 'react-redux';\nimport { ReduxState } from '../../../../../redux-types';\nimport { MetricHistoryByName } from '../../../../types';\nimport { RunsChartsLineChartXAxisType, type RunsChartsRunData } from '../RunsCharts.common';\nimport { RunsMetricsLinePlot } from '../RunsMetricsLinePlot';\nimport { RunsChartsTooltipMode, useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport { RunsChartsLineCardConfig } from '../../runs-charts.types';\nimport { shouldEnableDeepLearningUIPhase3 } from '../../../../../common/utils/FeatureUtils';\nimport { useSampledMetricHistory } from '../../hooks/useSampledMetricHistory';\nimport { compact, uniq } from 'lodash';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\nimport { useGroupedChartRunData } from '../../../runs-compare/hooks/useGroupedChartRunData';\n\nexport const RunsChartsConfigureLineChartPreviewImpl = ({\n  previewData,\n  cardConfig,\n  metricsByRunUuid,\n  groupBy,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsLineCardConfig;\n  groupBy: RunsGroupByConfig | null;\n\n  metricsByRunUuid: Record<string, MetricHistoryByName>;\n}) => {\n  const usingMultipleRunsHoverTooltip = shouldEnableDeepLearningUIPhase3();\n\n  const isGrouped = useMemo(() => previewData.some((r) => r.groupParentInfo), [previewData]);\n\n  const { aggregateFunction } = groupBy || {};\n\n  const runUuidsToFetch = useMemo(() => {\n    if (isGrouped) {\n      const runsInGroups = compact(previewData.map((r) => r.groupParentInfo)).flatMap((g) => g.runUuids);\n      const ungroupedRuns = compact(\n        previewData.filter((r) => !r.groupParentInfo && !r.belongsToGroup).map((r) => r.runInfo?.runUuid),\n      );\n      return [...runsInGroups, ...ungroupedRuns];\n    }\n    return compact(previewData.map((r) => r.runInfo)).map((g) => g.runUuid);\n  }, [previewData, isGrouped]);\n\n  const metricKeysToFetch = useMemo(() => {\n    const fallback = [cardConfig.metricKey];\n\n    const yAxisKeys = cardConfig.selectedMetricKeys ?? fallback;\n    const xAxisKeys = !cardConfig.selectedXAxisMetricKey ? [] : [cardConfig.selectedXAxisMetricKey];\n    return yAxisKeys.concat(xAxisKeys);\n  }, [cardConfig.metricKey, cardConfig.selectedMetricKeys, cardConfig.selectedXAxisMetricKey]);\n\n  const { resultsByRunUuid, isLoading } = useSampledMetricHistory({\n    runUuids: runUuidsToFetch,\n    metricKeys: metricKeysToFetch,\n    enabled: true,\n    maxResults: 320,\n    autoRefreshEnabled: false,\n  });\n\n  const sampledData = useMemo(\n    () =>\n      previewData.map((run) => {\n        const metricsHistory = metricKeysToFetch.reduce((acc: MetricHistoryByName, key) => {\n          const history = resultsByRunUuid[run.uuid]?.[key]?.metricsHistory;\n          if (history) {\n            acc[key] = history;\n          }\n          return acc;\n        }, {});\n\n        return {\n          ...run,\n          metricsHistory,\n        };\n      }),\n    [metricKeysToFetch, resultsByRunUuid, previewData],\n  );\n\n  const sampledGroupData = useGroupedChartRunData({\n    enabled: isGrouped,\n    ungroupedRunsData: sampledData,\n    metricKeys: metricKeysToFetch,\n    sampledDataResultsByRunUuid: resultsByRunUuid,\n    aggregateFunction,\n    selectedXAxisMetricKey:\n      cardConfig.xAxisKey === RunsChartsLineChartXAxisType.METRIC ? cardConfig.selectedXAxisMetricKey : undefined,\n  });\n\n  // Use grouped data traces only if enabled and if there are any groups\n  const chartData = isGrouped ? sampledGroupData : sampledData;\n\n  const { setTooltip, resetTooltip } = useRunsChartsTooltip(\n    cardConfig,\n    usingMultipleRunsHoverTooltip ? RunsChartsTooltipMode.MultipleTracesWithScanline : RunsChartsTooltipMode.Simple,\n  );\n\n  if (isLoading) {\n    return <LegacySkeleton />;\n  }\n\n  return (\n    <RunsMetricsLinePlot\n      runsData={chartData}\n      metricKey={cardConfig.metricKey}\n      selectedMetricKeys={cardConfig.selectedMetricKeys}\n      scaleType={cardConfig.scaleType}\n      xAxisScaleType={cardConfig.xAxisScaleType}\n      lineSmoothness={cardConfig.lineSmoothness}\n      xAxisKey={cardConfig.xAxisKey}\n      selectedXAxisMetricKey={cardConfig.selectedXAxisMetricKey}\n      displayPoints={cardConfig.displayPoints}\n      useDefaultHoverBox={false}\n      onHover={setTooltip}\n      onUnhover={resetTooltip}\n    />\n  );\n};\n\nconst mapStateToProps = ({ entities: { metricsByRunUuid } }: ReduxState) => ({\n  metricsByRunUuid,\n});\n\n/**\n * Preview of line chart used in compare runs configuration modal\n */\nexport const RunsChartsConfigureLineChartPreview = connect(mapStateToProps, undefined, undefined, {\n  areStatesEqual: (nextState, prevState) => nextState.entities.metricsByRunUuid === prevState.entities.metricsByRunUuid,\n})(RunsChartsConfigureLineChartPreviewImpl);\n","import { RunsChartsRunData } from '../RunsCharts.common';\nimport LazyParallelCoordinatesPlot, { processParallelCoordinateData } from '../charts/LazyParallelCoordinatesPlot';\nimport { useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport { RunsChartsParallelCardConfig } from '../../runs-charts.types';\nimport { useMemo } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\n\nexport const RunsChartsConfigureParallelChartPreview = ({\n  previewData,\n  cardConfig,\n  groupBy,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsParallelCardConfig;\n  groupBy: RunsGroupByConfig | null;\n}) => {\n  const selectedParamsCount = cardConfig.selectedParams?.length || 0;\n  const selectedMetricsCount = cardConfig.selectedMetrics?.length || 0;\n\n  const isConfigured = selectedParamsCount + selectedMetricsCount >= 2;\n\n  const { setTooltip, resetTooltip } = useRunsChartsTooltip(cardConfig);\n\n  const containsStringValues = useMemo(\n    () =>\n      cardConfig.selectedParams?.some(\n        (paramKey) => previewData?.some((dataTrace) => isNaN(Number(dataTrace.params[paramKey]?.value))),\n        [cardConfig.selectedParams, previewData],\n      ),\n    [cardConfig.selectedParams, previewData],\n  );\n\n  if (containsStringValues && groupBy) {\n    return (\n      <div css={{ display: 'flex', justifyContent: 'center', alignItems: 'center', textAlign: 'center' }}>\n        <FormattedMessage\n          defaultMessage=\"Parallel coordinates chart does not support aggregated string values. Use other parameters or disable run grouping to continue.\"\n          description=\"Experiment page > compare runs > parallel coordinates chart configuration modal > unsupported string values warning\"\n        />\n      </div>\n    );\n  }\n\n  const filteredData = isConfigured\n    ? processParallelCoordinateData(previewData, cardConfig.selectedParams, cardConfig.selectedMetrics)\n    : [];\n\n  if (!isConfigured) {\n    return (\n      <div css={{ display: 'flex', justifyContent: 'center', alignItems: 'center' }}>\n        Select at least two metrics and params first\n      </div>\n    );\n  }\n\n  return filteredData.length ? (\n    /* Avoid displaying empty set, otherwise parcoord-es crashes */\n    <LazyParallelCoordinatesPlot\n      selectedMetrics={cardConfig.selectedMetrics}\n      selectedParams={cardConfig.selectedParams}\n      data={filteredData}\n      axesRotateThreshold={6}\n      onHover={setTooltip}\n      onUnhover={resetTooltip}\n    />\n  ) : null;\n};\n","import { useCallback, useEffect } from 'react';\nimport { useIntl } from 'react-intl';\nimport {\n  extractCanonicalSortKey,\n  isCanonicalSortKeyOfType,\n  makeCanonicalSortKey,\n} from '../../../experiment-page/utils/experimentPage.common-utils';\nimport type { RunsChartsCardConfig, RunsChartsContourCardConfig } from '../../runs-charts.types';\nimport {\n  RunsChartsMetricParamSelect,\n  RunsChartsConfigureField,\n  RunsChartsRunNumberSelect,\n} from './RunsChartsConfigure.common';\n\ntype ValidAxis = keyof Pick<RunsChartsContourCardConfig, 'xaxis' | 'yaxis' | 'zaxis'>;\n\n/**\n * Form containing configuration controls for Contour runs compare chart.\n */\nexport const RunsChartsConfigureContourChart = ({\n  state,\n  onStateChange,\n  metricKeyList,\n  paramKeyList,\n}: {\n  metricKeyList: string[];\n  paramKeyList: string[];\n  state: RunsChartsContourCardConfig;\n  onStateChange: (setter: (current: RunsChartsCardConfig) => RunsChartsContourCardConfig) => void;\n}) => {\n  const { formatMessage } = useIntl();\n  const runSelectOptions = [5, 10, 20, 50, 100];\n\n  /**\n   * Callback for updating X or Y axis\n   */\n  const updateAxis = useCallback(\n    (canonicalKey: string, axis: ValidAxis) => {\n      const type = isCanonicalSortKeyOfType(canonicalKey, 'METRIC') ? 'METRIC' : 'PARAM';\n      const key = extractCanonicalSortKey(canonicalKey, type);\n      onStateChange((current) => ({\n        ...(current as RunsChartsContourCardConfig),\n        [axis]: { key, type },\n      }));\n    },\n    [onStateChange],\n  );\n\n  /**\n   * Callback for updating run count\n   */\n  const updateVisibleRunCount = useCallback(\n    (runsCountToCompare: number) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsContourCardConfig),\n        runsCountToCompare,\n      }));\n    },\n    [onStateChange],\n  );\n\n  /**\n   * If somehow axes are not predetermined, automatically\n   * select the first metric/param so it's not empty\n   */\n  useEffect(() => {\n    const firstMetric = metricKeyList?.[0];\n    const firstParam = paramKeyList?.[0];\n    if (!state.xaxis?.key) {\n      if (firstMetric) {\n        updateAxis(makeCanonicalSortKey('METRIC', firstMetric), 'xaxis');\n      } else if (firstParam) {\n        updateAxis(makeCanonicalSortKey('PARAM', firstParam), 'xaxis');\n      }\n    }\n    if (!state.yaxis?.key) {\n      if (firstMetric) {\n        updateAxis(makeCanonicalSortKey('METRIC', firstMetric), 'yaxis');\n      } else if (firstParam) {\n        updateAxis(makeCanonicalSortKey('PARAM', firstParam), 'yaxis');\n      }\n    }\n    if (!state.zaxis?.key) {\n      if (firstMetric) {\n        updateAxis(makeCanonicalSortKey('METRIC', firstMetric), 'zaxis');\n      } else if (firstParam) {\n        updateAxis(makeCanonicalSortKey('PARAM', firstParam), 'zaxis');\n      }\n    }\n  }, [state.xaxis, state.yaxis, state.zaxis, updateAxis, metricKeyList, paramKeyList]);\n\n  return (\n    <>\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'X axis',\n          description: 'Label for X axis in Contour chart configurator in compare runs chart config modal',\n        })}\n      >\n        <RunsChartsMetricParamSelect\n          value={state.xaxis.key ? makeCanonicalSortKey(state.xaxis.type, state.xaxis.key) : ''}\n          onChange={(value) => {\n            updateAxis(value, 'xaxis');\n          }}\n          paramKeyList={paramKeyList}\n          metricKeyList={metricKeyList}\n        />\n      </RunsChartsConfigureField>\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'Y axis',\n          description: 'Label for Y axis in Contour chart configurator in compare runs chart config modal',\n        })}\n      >\n        <RunsChartsMetricParamSelect\n          value={state.yaxis.key ? makeCanonicalSortKey(state.yaxis.type, state.yaxis.key) : ''}\n          onChange={(value) => {\n            updateAxis(value, 'yaxis');\n          }}\n          paramKeyList={paramKeyList}\n          metricKeyList={metricKeyList}\n        />\n      </RunsChartsConfigureField>\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'Z axis',\n          description: 'Label for Z axis in Contour chart configurator in compare runs chart config modal',\n        })}\n      >\n        <RunsChartsMetricParamSelect\n          value={state.zaxis.key ? makeCanonicalSortKey(state.zaxis.type, state.zaxis.key) : ''}\n          onChange={(value) => {\n            updateAxis(value, 'zaxis');\n          }}\n          paramKeyList={paramKeyList}\n          metricKeyList={metricKeyList}\n        />\n      </RunsChartsConfigureField>\n      <RunsChartsRunNumberSelect\n        value={state.runsCountToCompare}\n        onChange={updateVisibleRunCount}\n        options={runSelectOptions}\n      />\n    </>\n  );\n};\n","import { useCallback, useEffect } from 'react';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport {\n  extractCanonicalSortKey,\n  isCanonicalSortKeyOfType,\n  makeCanonicalSortKey,\n} from '../../../experiment-page/utils/experimentPage.common-utils';\nimport type { RunsChartsCardConfig, RunsChartsScatterCardConfig } from '../../runs-charts.types';\nimport {\n  RunsChartsMetricParamSelect,\n  RunsChartsConfigureField,\n  RunsChartsRunNumberSelect,\n  runsChartsRunCountDefaultOptions,\n} from './RunsChartsConfigure.common';\n\ntype ValidAxis = keyof Pick<RunsChartsScatterCardConfig, 'xaxis' | 'yaxis'>;\n\nconst scatterPlotDefaultOptions = runsChartsRunCountDefaultOptions;\nscatterPlotDefaultOptions.push(\n  {\n    value: 100,\n    label: (\n      <FormattedMessage\n        defaultMessage=\"100\"\n        description=\"Label for 100 first runs visible in run count selector within runs compare configuration modal\"\n      />\n    ),\n  },\n  {\n    value: 250,\n    label: (\n      <FormattedMessage\n        defaultMessage=\"250\"\n        description=\"Label for 250 first runs visible in run count selector within runs compare configuration modal\"\n      />\n    ),\n  },\n  {\n    value: 500,\n    label: (\n      <FormattedMessage\n        defaultMessage=\"500\"\n        description=\"Label for 500 first runs visible in run count selector within runs compare configuration modal\"\n      />\n    ),\n  },\n);\n\n/**\n * Form containing configuration controls for scatter runs compare chart.\n */\nexport const RunsChartsConfigureScatterChart = ({\n  state,\n  onStateChange,\n  metricKeyList,\n  paramKeyList,\n}: {\n  metricKeyList: string[];\n  paramKeyList: string[];\n  state: RunsChartsScatterCardConfig;\n  onStateChange: (setter: (current: RunsChartsCardConfig) => RunsChartsScatterCardConfig) => void;\n}) => {\n  const { formatMessage } = useIntl();\n\n  /**\n   * Callback for updating X or Y axis\n   */\n  const updateAxis = useCallback(\n    (canonicalKey: string, axis: ValidAxis) => {\n      const type = isCanonicalSortKeyOfType(canonicalKey, 'METRIC') ? 'METRIC' : 'PARAM';\n      const key = extractCanonicalSortKey(canonicalKey, type);\n      onStateChange((current) => ({\n        ...(current as RunsChartsScatterCardConfig),\n        [axis]: { key, type },\n      }));\n    },\n    [onStateChange],\n  );\n\n  /**\n   * Callback for updating run count\n   */\n  const updateVisibleRunCount = useCallback(\n    (runsCountToCompare: number) => {\n      onStateChange((current) => ({\n        ...(current as RunsChartsScatterCardConfig),\n        runsCountToCompare,\n      }));\n    },\n    [onStateChange],\n  );\n\n  /**\n   * If somehow axes are not predetermined, automatically\n   * select the first metric/param so it's not empty\n   */\n  useEffect(() => {\n    const firstMetric = metricKeyList?.[0];\n    const firstParam = paramKeyList?.[0];\n    if (!state.xaxis?.key) {\n      if (firstMetric) {\n        updateAxis(makeCanonicalSortKey('METRIC', firstMetric), 'xaxis');\n      } else if (firstParam) {\n        updateAxis(makeCanonicalSortKey('PARAM', firstParam), 'xaxis');\n      }\n    }\n    if (!state.yaxis?.key) {\n      if (firstMetric) {\n        updateAxis(makeCanonicalSortKey('METRIC', firstMetric), 'yaxis');\n      } else if (firstParam) {\n        updateAxis(makeCanonicalSortKey('PARAM', firstParam), 'yaxis');\n      }\n    }\n  }, [state.xaxis, state.yaxis, updateAxis, metricKeyList, paramKeyList]);\n\n  return (\n    <>\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'X axis',\n          description: 'Label for X axis in scatter chart configurator in compare runs chart config modal',\n        })}\n      >\n        <RunsChartsMetricParamSelect\n          value={state.xaxis.key ? makeCanonicalSortKey(state.xaxis.type, state.xaxis.key) : ''}\n          onChange={(value) => {\n            updateAxis(value, 'xaxis');\n          }}\n          paramKeyList={paramKeyList}\n          metricKeyList={metricKeyList}\n        />\n      </RunsChartsConfigureField>\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'Y axis',\n          description: 'Label for Y axis in scatter chart configurator in compare runs chart config modal',\n        })}\n      >\n        <RunsChartsMetricParamSelect\n          value={state.yaxis.key ? makeCanonicalSortKey(state.yaxis.type, state.yaxis.key) : ''}\n          onChange={(value) => {\n            updateAxis(value, 'yaxis');\n          }}\n          paramKeyList={paramKeyList}\n          metricKeyList={metricKeyList}\n        />\n      </RunsChartsConfigureField>\n      <RunsChartsRunNumberSelect\n        value={state.runsCountToCompare}\n        onChange={updateVisibleRunCount}\n        options={scatterPlotDefaultOptions}\n      />\n    </>\n  );\n};\n","import { FormattedMessage } from 'react-intl';\nimport {\n  DifferenceCardConfigCompareGroup,\n  RunsChartsCardConfig,\n  RunsChartsDifferenceCardConfig,\n} from '../../runs-charts.types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { DifferenceViewPlot } from '../charts/DifferenceViewPlot';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\n\nexport const RunsChartsConfigureDifferenceChartPreview = ({\n  previewData,\n  groupBy,\n  cardConfig,\n  setCardConfig,\n}: {\n  previewData: RunsChartsRunData[];\n  groupBy: RunsGroupByConfig | null;\n  cardConfig: RunsChartsDifferenceCardConfig;\n  setCardConfig: (setter: (current: RunsChartsCardConfig) => RunsChartsDifferenceCardConfig) => void;\n}) => {\n  return (\n    <div css={{ width: '100%', overflow: 'auto hidden', height: '100%' }}>\n      <DifferenceViewPlot\n        previewData={previewData}\n        groupBy={groupBy}\n        cardConfig={cardConfig}\n        setCardConfig={setCardConfig}\n      />\n    </div>\n  );\n};\n","import {\n  Checkbox,\n  Input,\n  Switch,\n  useDesignSystemTheme,\n  Tooltip,\n  InfoIcon,\n  InfoTooltip,\n} from '@databricks/design-system';\nimport {\n  DISABLED_GROUP_WHEN_GROUPBY,\n  DifferenceCardConfigCompareGroup,\n  RunsChartsCardConfig,\n  RunsChartsDifferenceCardConfig,\n} from '../../runs-charts.types';\nimport { RunsChartsConfigureField } from './RunsChartsConfigure.common';\nimport { useCallback } from 'react';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\n\n/**\n * Form containing configuration controls for runs compare difference view chart.\n */\nexport const RunsChartsConfigureDifferenceChart = ({\n  state,\n  onStateChange,\n  metricKeyList,\n  paramKeyList,\n  groupBy,\n}: {\n  metricKeyList: string[];\n  paramKeyList: string[];\n  state: Partial<RunsChartsDifferenceCardConfig>;\n  onStateChange: (setter: (current: RunsChartsCardConfig) => RunsChartsDifferenceCardConfig) => void;\n  groupBy: RunsGroupByConfig | null;\n}) => {\n  /**\n   * Callback for updating compare groups\n   */\n  const updateCompareGroups = useCallback(\n    (compareGroup: DifferenceCardConfigCompareGroup) => {\n      onStateChange((current) => {\n        const currentConfig = current as RunsChartsDifferenceCardConfig;\n        const compareGroups = currentConfig.compareGroups;\n        if (compareGroups.includes(compareGroup)) {\n          return {\n            ...(current as RunsChartsDifferenceCardConfig),\n            compareGroups: compareGroups.filter((group) => group !== compareGroup),\n          };\n        } else {\n          return { ...(current as RunsChartsDifferenceCardConfig), compareGroups: [...compareGroups, compareGroup] };\n        }\n      });\n    },\n    [onStateChange],\n  );\n\n  const updateChartName = useCallback(\n    (e) => onStateChange((current) => ({ ...(current as RunsChartsDifferenceCardConfig), chartName: e.target.value })),\n    [onStateChange],\n  );\n\n  const updateShowChangeFromBaseline = useCallback(\n    (showChangeFromBaseline: boolean) =>\n      onStateChange((current) => ({\n        ...(current as RunsChartsDifferenceCardConfig),\n        showChangeFromBaseline,\n      })),\n    [onStateChange],\n  );\n\n  const updateShowDifferencesOnly = useCallback(\n    (showDifferencesOnly: boolean) =>\n      onStateChange((current) => ({\n        ...(current as RunsChartsDifferenceCardConfig),\n        showDifferencesOnly,\n      })),\n    [onStateChange],\n  );\n\n  const { theme } = useDesignSystemTheme();\n  const { formatMessage } = useIntl();\n\n  return (\n    <>\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'Compare',\n          description:\n            'Runs charts > components > config > RunsChartsConfigureDifferenceChart > Compare config section',\n        })}\n      >\n        <Checkbox.Group id=\"checkbox-group\" defaultValue={state.compareGroups}>\n          {Object.values(DifferenceCardConfigCompareGroup).map((group) => {\n            const groupedCondition = groupBy ? DISABLED_GROUP_WHEN_GROUPBY.includes(group) : false;\n            return (\n              <div css={{ display: 'inline-flex', alignItems: 'center' }}>\n                <Checkbox\n                  key={group}\n                  value={group}\n                  isChecked={state.compareGroups?.includes(group)}\n                  onChange={() => updateCompareGroups(group)}\n                  disabled={groupedCondition}\n                >\n                  {group}\n                </Checkbox>\n                {groupedCondition && (\n                  <InfoTooltip\n                    title={\n                      <FormattedMessage\n                        defaultMessage=\"Disable grouped runs to compare\"\n                        description=\"Experiment tracking > components > runs-charts > RunsChartsConfigureDifferenceCharts > disable grouped runs info message\"\n                      />\n                    }\n                  />\n                )}\n              </div>\n            );\n          })}\n        </Checkbox.Group>\n        <div\n          css={{\n            display: 'flex',\n            flexDirection: 'column',\n            padding: `${theme.spacing.md}px 0px`,\n            gap: theme.spacing.sm,\n          }}\n        >\n          <Switch\n            checked={state.showChangeFromBaseline}\n            onChange={updateShowChangeFromBaseline}\n            label={formatMessage({\n              defaultMessage: 'Show change from baseline',\n              description:\n                'Runs charts > components > config > RunsChartsConfigureDifferenceChart > Show change from baseline toggle',\n            })}\n          />\n          <Switch\n            checked={state.showDifferencesOnly}\n            onChange={updateShowDifferencesOnly}\n            label={formatMessage({\n              defaultMessage: 'Show differences only',\n              description:\n                'Runs charts > components > config > RunsChartsConfigureDifferenceChart > Show differences only toggle',\n            })}\n          />\n        </div>\n      </RunsChartsConfigureField>\n\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'Chart name',\n          description:\n            'Runs charts > components > config > RunsChartsConfigureDifferenceChart > Chart name config section',\n        })}\n      >\n        <Input value={state.chartName} onChange={updateChartName} />\n      </RunsChartsConfigureField>\n    </>\n  );\n};\n","import { useCallback } from 'react';\nimport { RunsChartsCardConfig, RunsChartsImageCardConfig } from '../../runs-charts.types';\nimport { Input } from '@databricks/design-system';\nimport { useIntl } from 'react-intl';\nimport { RunsChartsConfigureField } from './RunsChartsConfigure.common';\nimport { DialogCombobox } from '@databricks/design-system';\nimport { DialogComboboxContent } from '@databricks/design-system';\nimport { DialogComboboxTrigger } from '@databricks/design-system';\nimport { DialogComboboxOptionListCheckboxItem } from '@databricks/design-system';\nimport { DialogComboboxOptionList } from '@databricks/design-system';\nimport { useImageSliderStepMarks } from '../../hooks/useImageSliderStepMarks';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { Slider } from 'antd';\nimport { useDesignSystemTheme } from '@databricks/design-system';\nimport { LineSmoothSlider } from 'experiment-tracking/components/LineSmoothSlider';\n\nexport const RunsChartsConfigureImageChart = ({\n  previewData,\n  state,\n  onStateChange,\n  imageKeyList,\n}: {\n  previewData: RunsChartsRunData[];\n  imageKeyList: string[];\n  state: Partial<RunsChartsImageCardConfig>;\n  onStateChange: (setter: (current: RunsChartsCardConfig) => RunsChartsImageCardConfig) => void;\n}) => {\n  const IMAGE_CONFIG_WIDTH = 300;\n\n  const { stepMarks, maxMark, minMark } = useImageSliderStepMarks({\n    data: previewData,\n    selectedImageKeys: state.imageKeys || [],\n  });\n\n  const updateImageKeys = useCallback(\n    (imageKeys: string[]) => {\n      onStateChange((current) => {\n        return { ...(current as RunsChartsImageCardConfig), imageKeys };\n      });\n    },\n    [onStateChange],\n  );\n\n  const updateStep = useCallback(\n    (step: number) => {\n      onStateChange((current) => {\n        return { ...(current as RunsChartsImageCardConfig), step };\n      });\n    },\n    [onStateChange],\n  );\n\n  const { formatMessage } = useIntl();\n\n  const handleUpdate = (imageKey: string) => {\n    onStateChange((current) => {\n      const currentConfig = current as RunsChartsImageCardConfig;\n      if (currentConfig.imageKeys?.includes(imageKey)) {\n        return {\n          ...currentConfig,\n          imageKeys: currentConfig.imageKeys?.filter((key) => key !== imageKey),\n        };\n      } else {\n        return { ...currentConfig, imageKeys: [...(currentConfig.imageKeys || []), imageKey] };\n      }\n    });\n  };\n\n  const handleClear = () => {\n    onStateChange((current) => {\n      return { ...(current as RunsChartsImageCardConfig), imageKeys: [] };\n    });\n  };\n\n  return (\n    <>\n      <RunsChartsConfigureField\n        title={formatMessage({\n          defaultMessage: 'Images',\n          description: 'Runs charts > components > config > RunsChartsConfigureImageGrid > Images section',\n        })}\n      >\n        <DialogCombobox value={state.imageKeys} label=\"Images\" multiSelect>\n          <DialogComboboxTrigger onClear={handleClear} minWidth={IMAGE_CONFIG_WIDTH} />\n          <DialogComboboxContent matchTriggerWidth>\n            <DialogComboboxOptionList>\n              {imageKeyList.map((imageKey) => {\n                return (\n                  <DialogComboboxOptionListCheckboxItem\n                    key={imageKey}\n                    value={imageKey}\n                    onChange={handleUpdate}\n                    checked={state.imageKeys?.includes(imageKey)}\n                  />\n                );\n              })}\n            </DialogComboboxOptionList>\n          </DialogComboboxContent>\n        </DialogCombobox>\n      </RunsChartsConfigureField>\n      <RunsChartsConfigureField title=\"Step\">\n        <LineSmoothSlider\n          max={maxMark}\n          min={minMark}\n          marks={stepMarks}\n          defaultValue={state.step}\n          disabled={Object.keys(stepMarks).length <= 1}\n          onChange={updateStep}\n          step={null}\n        />\n      </RunsChartsConfigureField>\n    </>\n  );\n};\n","import { RunsGroupByConfig } from 'experiment-tracking/components/experiment-page/utils/experimentPage.group-row-utils';\nimport { RunsChartsCardConfig, RunsChartsImageCardConfig } from '../../runs-charts.types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { ImageGridPlot } from '../charts/ImageGridPlot';\n\nexport const RunsChartsConfigureImageChartPreview = ({\n  previewData,\n  cardConfig,\n  setCardConfig,\n  groupBy,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsImageCardConfig;\n  setCardConfig: (setter: (current: RunsChartsCardConfig) => RunsChartsImageCardConfig) => void;\n  groupBy: RunsGroupByConfig | null;\n}) => {\n  return (\n    <div css={{ width: '100%', overflow: 'auto hidden' }}>\n      <ImageGridPlot\n        previewData={previewData}\n        cardConfig={cardConfig}\n        setCardConfig={setCardConfig}\n        containerWidth={500}\n        groupBy={groupBy}\n      />\n    </div>\n  );\n};\n","/**\n * TODO: implement actual UI for this modal, it's a crude placeholder with minimal logic for now\n */\nimport { Modal, LegacySelect, useDesignSystemTheme } from '@databricks/design-system';\nimport { Interpolation, Theme } from '@emotion/react';\nimport React, { useCallback, useMemo, useState } from 'react';\nimport { useIntl, FormattedMessage } from 'react-intl';\nimport {\n  RunsChartsBarCardConfig,\n  RunsChartsCardConfig,\n  RunsChartType,\n  RunsChartsLineCardConfig,\n  RunsChartsContourCardConfig,\n  RunsChartsScatterCardConfig,\n  RunsChartsParallelCardConfig,\n  RunsChartsDifferenceCardConfig,\n  RunsChartsImageCardConfig,\n} from '../runs-charts.types';\n\nimport { ReactComponent as ChartBarIcon } from '../../../../common/static/chart-bar.svg';\nimport { ReactComponent as ChartContourIcon } from '../../../../common/static/chart-contour.svg';\nimport { ReactComponent as ChartLineIcon } from '../../../../common/static/chart-line.svg';\nimport { ReactComponent as ChartParallelIcon } from '../../../../common/static/chart-parallel.svg';\nimport { ReactComponent as ChartScatterIcon } from '../../../../common/static/chart-scatter.svg';\nimport { ReactComponent as ChartDifferenceIcon } from '../../../../common/static/chart-difference.svg';\nimport { ReactComponent as ChartImageIcon } from '../../../../common/static/chart-image.svg';\nimport { RunsChartsConfigureBarChart } from './config/RunsChartsConfigureBarChart';\nimport { RunsChartsConfigureParallelChart } from './config/RunsChartsConfigureParallelChart';\nimport type { RunsChartsRunData } from './RunsCharts.common';\nimport { RunsChartsConfigureField } from './config/RunsChartsConfigure.common';\nimport { RunsChartsConfigureLineChart } from './config/RunsChartsConfigureLineChart';\nimport { RunsChartsConfigureLineChartPreview } from './config/RunsChartsConfigureLineChart.preview';\nimport { RunsChartsConfigureBarChartPreview } from './config/RunsChartsConfigureBarChart.preview';\nimport { RunsChartsConfigureContourChartPreview } from './config/RunsChartsConfigureContourChart.preview';\nimport { RunsChartsConfigureScatterChartPreview } from './config/RunsChartsConfigureScatterChart.preview';\nimport { RunsChartsConfigureParallelChartPreview } from './config/RunsChartsConfigureParallelChart.preview';\nimport { RunsChartsConfigureContourChart } from './config/RunsChartsConfigureContourChart';\nimport { RunsChartsConfigureScatterChart } from './config/RunsChartsConfigureScatterChart';\nimport { RunsChartsTooltipBody } from './RunsChartsTooltipBody';\nimport { RunsChartsTooltipWrapper } from '../hooks/useRunsChartsTooltip';\nimport {\n  shouldEnableDifferenceViewCharts,\n  shouldEnableImageGridCharts,\n  shouldUseNewRunRowsVisibilityModel,\n} from 'common/utils/FeatureUtils';\nimport { RunsChartsConfigureDifferenceChartPreview } from './config/RunsChartsConfigureDifferenceChart.preview';\nimport { RunsChartsConfigureDifferenceChart } from './config/RunsChartsConfigureDifferenceChart';\nimport type { RunsGroupByConfig } from '../../experiment-page/utils/experimentPage.group-row-utils';\nimport { RunsChartsConfigureImageChart } from './config/RunsChartsConfigureImageChart';\nimport { RunsChartsConfigureImageChartPreview } from './config/RunsChartsConfigureImageChart.preview';\n\nconst previewComponentsMap: Record<\n  RunsChartType,\n  React.FC<{\n    previewData: RunsChartsRunData[];\n    cardConfig: any;\n    groupBy: RunsGroupByConfig | null;\n    setCardConfig: (\n      setter: (current: RunsChartsCardConfig) => RunsChartsDifferenceCardConfig | RunsChartsImageCardConfig,\n    ) => void;\n  }>\n> = {\n  [RunsChartType.BAR]: RunsChartsConfigureBarChartPreview,\n  [RunsChartType.CONTOUR]: RunsChartsConfigureContourChartPreview,\n  [RunsChartType.LINE]: RunsChartsConfigureLineChartPreview,\n  [RunsChartType.PARALLEL]: RunsChartsConfigureParallelChartPreview,\n  [RunsChartType.SCATTER]: RunsChartsConfigureScatterChartPreview,\n  [RunsChartType.DIFFERENCE]: RunsChartsConfigureDifferenceChartPreview,\n  [RunsChartType.IMAGE]: RunsChartsConfigureImageChartPreview,\n};\n\nexport const RunsChartsConfigureModal = ({\n  onCancel,\n  onSubmit,\n  config,\n  chartRunData,\n  metricKeyList,\n  paramKeyList,\n  groupBy,\n  supportedChartTypes,\n}: {\n  metricKeyList: string[];\n  paramKeyList: string[];\n  config: RunsChartsCardConfig;\n  chartRunData: RunsChartsRunData[];\n  onCancel: () => void;\n  groupBy: RunsGroupByConfig | null;\n  onSubmit: (formData: Partial<RunsChartsCardConfig>) => void;\n  supportedChartTypes?: RunsChartType[] | undefined;\n}) => {\n  const isChartTypeSupported = (type: RunsChartType) => !supportedChartTypes || supportedChartTypes.includes(type);\n  const { theme } = useDesignSystemTheme();\n\n  const [currentFormState, setCurrentFormState] = useState<RunsChartsCardConfig>(config);\n\n  const isEditing = Boolean(currentFormState.uuid);\n\n  const updateChartType = useCallback((type?: RunsChartType) => {\n    if (!type) {\n      return;\n    }\n    const emptyChartCard = RunsChartsCardConfig.getEmptyChartCardByType(type, true);\n    if (emptyChartCard) {\n      setCurrentFormState(emptyChartCard);\n    }\n  }, []);\n\n  const previewData = useMemo(() => {\n    if (shouldUseNewRunRowsVisibilityModel()) {\n      return chartRunData.filter(({ hidden }) => !hidden).reverse();\n    }\n    return chartRunData.slice(0, currentFormState.runsCountToCompare).reverse();\n  }, [chartRunData, currentFormState.runsCountToCompare]);\n\n  const imageKeyList = useMemo(() => {\n    const imageKeys = new Set<string>();\n    previewData.forEach((run) => {\n      Object.keys(run.images).forEach((imageKey) => {\n        imageKeys.add(imageKey);\n      });\n    });\n    return Array.from(imageKeys).sort();\n  }, [previewData]);\n\n  const renderConfigOptionsforChartType = (type?: RunsChartType) => {\n    if (type === RunsChartType.BAR) {\n      return (\n        <RunsChartsConfigureBarChart\n          metricKeyList={metricKeyList}\n          state={currentFormState as RunsChartsBarCardConfig}\n          onStateChange={setCurrentFormState}\n        />\n      );\n    }\n    if (type === RunsChartType.CONTOUR) {\n      return (\n        <RunsChartsConfigureContourChart\n          metricKeyList={metricKeyList}\n          paramKeyList={paramKeyList}\n          state={currentFormState as RunsChartsContourCardConfig}\n          onStateChange={setCurrentFormState}\n        />\n      );\n    }\n    if (type === RunsChartType.LINE) {\n      return (\n        <RunsChartsConfigureLineChart\n          metricKeyList={metricKeyList}\n          state={currentFormState as RunsChartsLineCardConfig}\n          onStateChange={setCurrentFormState}\n        />\n      );\n    }\n    if (type === RunsChartType.PARALLEL) {\n      return (\n        <RunsChartsConfigureParallelChart\n          metricKeyList={metricKeyList}\n          paramKeyList={paramKeyList}\n          state={currentFormState as RunsChartsParallelCardConfig}\n          onStateChange={setCurrentFormState}\n        />\n      );\n    }\n    if (type === RunsChartType.SCATTER) {\n      return (\n        <RunsChartsConfigureScatterChart\n          metricKeyList={metricKeyList}\n          paramKeyList={paramKeyList}\n          state={currentFormState as RunsChartsScatterCardConfig}\n          onStateChange={setCurrentFormState}\n        />\n      );\n    }\n    if (shouldEnableDifferenceViewCharts() && type === RunsChartType.DIFFERENCE) {\n      return (\n        <RunsChartsConfigureDifferenceChart\n          metricKeyList={metricKeyList}\n          paramKeyList={paramKeyList}\n          state={currentFormState as RunsChartsDifferenceCardConfig}\n          onStateChange={setCurrentFormState}\n          groupBy={groupBy}\n        />\n      );\n    }\n    if (shouldEnableImageGridCharts() && type === RunsChartType.IMAGE) {\n      return (\n        <RunsChartsConfigureImageChart\n          previewData={previewData}\n          imageKeyList={imageKeyList}\n          state={currentFormState as RunsChartsImageCardConfig}\n          onStateChange={setCurrentFormState}\n        />\n      );\n    }\n    return null;\n  };\n\n  const renderPreviewChartType = (type?: RunsChartType) => {\n    if (!type) {\n      return null;\n    }\n    const PreviewComponent = previewComponentsMap[type];\n    if (!PreviewComponent) {\n      return null;\n    }\n    return (\n      <PreviewComponent\n        previewData={previewData}\n        cardConfig={currentFormState}\n        groupBy={groupBy}\n        setCardConfig={setCurrentFormState}\n      />\n    );\n  };\n\n  const { formatMessage } = useIntl();\n\n  let disableSaveButton = false;\n  if (currentFormState.type === RunsChartType.LINE) {\n    const lineCardConfig = currentFormState as RunsChartsLineCardConfig;\n    disableSaveButton = (lineCardConfig.selectedMetricKeys ?? []).length === 0;\n  }\n\n  return (\n    <Modal\n      visible\n      onCancel={onCancel}\n      onOk={() => onSubmit(currentFormState)}\n      title={\n        isEditing\n          ? formatMessage({\n              defaultMessage: 'Edit chart',\n              description: 'Title of the modal when editing a runs comparison chart',\n            })\n          : formatMessage({\n              defaultMessage: 'Add new chart',\n              description: 'Title of the modal when adding a new runs comparison chart',\n            })\n      }\n      okButtonProps={{\n        'data-testid': 'experiment-view-compare-runs-chart-modal-confirm',\n        disabled: disableSaveButton,\n      }}\n      cancelText={formatMessage({\n        defaultMessage: 'Cancel',\n        description: 'Cancel button label within a modal for adding/editing a new runs comparison chart',\n      })}\n      okText={\n        isEditing\n          ? formatMessage({\n              defaultMessage: 'Save changes',\n              description: 'Confirm button label within a modal when editing a runs comparison chart',\n            })\n          : formatMessage({\n              defaultMessage: 'Add chart',\n              description: 'Confirm button label within a modal when adding a new runs comparison chart',\n            })\n      }\n      size=\"wide\"\n      css={{ width: 1280 }}\n    >\n      <div css={styles.wrapper}>\n        <div>\n          {!isEditing && (\n            <RunsChartsConfigureField title=\"Type\">\n              <LegacySelect<RunsChartType>\n                css={{ width: '100%' }}\n                value={currentFormState.type}\n                onChange={updateChartType}\n              >\n                {isChartTypeSupported(RunsChartType.BAR) && (\n                  <LegacySelect.Option value={RunsChartType.BAR}>\n                    <div css={styles.chartTypeOption(theme)}>\n                      <ChartBarIcon />\n                      <FormattedMessage\n                        defaultMessage=\"Bar chart\"\n                        description=\"Experiment tracking > runs charts > add chart menu > bar chart\"\n                      />\n                    </div>\n                  </LegacySelect.Option>\n                )}\n                {isChartTypeSupported(RunsChartType.SCATTER) && (\n                  <LegacySelect.Option value={RunsChartType.SCATTER}>\n                    <div css={styles.chartTypeOption(theme)}>\n                      <ChartScatterIcon />\n                      <FormattedMessage\n                        defaultMessage=\"Scatter chart\"\n                        description=\"Experiment tracking > runs charts > add chart menu > scatter plot\"\n                      />\n                    </div>\n                  </LegacySelect.Option>\n                )}\n                {isChartTypeSupported(RunsChartType.LINE) && (\n                  <LegacySelect.Option value={RunsChartType.LINE}>\n                    <div css={styles.chartTypeOption(theme)}>\n                      <ChartLineIcon />\n                      <FormattedMessage\n                        defaultMessage=\"Line chart\"\n                        description=\"Experiment tracking > runs charts > add chart menu > line chart\"\n                      />\n                    </div>\n                  </LegacySelect.Option>\n                )}\n                {isChartTypeSupported(RunsChartType.PARALLEL) && (\n                  <LegacySelect.Option value={RunsChartType.PARALLEL}>\n                    <div css={styles.chartTypeOption(theme)}>\n                      <ChartParallelIcon />\n                      <FormattedMessage\n                        defaultMessage=\"Parallel coordinates\"\n                        description=\"Experiment tracking > runs charts > add chart menu > parallel coordinates\"\n                      />\n                    </div>\n                  </LegacySelect.Option>\n                )}\n                {isChartTypeSupported(RunsChartType.CONTOUR) && (\n                  <LegacySelect.Option value={RunsChartType.CONTOUR}>\n                    <div css={styles.chartTypeOption(theme)}>\n                      <ChartContourIcon />\n                      <FormattedMessage\n                        defaultMessage=\"Contour chart\"\n                        description=\"Experiment tracking > runs charts > add chart menu > contour chart\"\n                      />\n                    </div>\n                  </LegacySelect.Option>\n                )}\n                {shouldEnableDifferenceViewCharts() && isChartTypeSupported(RunsChartType.DIFFERENCE) && (\n                  <LegacySelect.Option value={RunsChartType.DIFFERENCE}>\n                    <div css={styles.chartTypeOption(theme)}>\n                      <ChartDifferenceIcon />\n                      <FormattedMessage\n                        defaultMessage=\"Difference view\"\n                        description=\"Experiment tracking > runs charts > add chart menu > difference view\"\n                      />\n                    </div>\n                  </LegacySelect.Option>\n                )}\n                {shouldEnableImageGridCharts() && isChartTypeSupported(RunsChartType.IMAGE) && (\n                  <LegacySelect.Option value={RunsChartType.IMAGE}>\n                    <div css={styles.chartTypeOption(theme)}>\n                      <ChartImageIcon />\n                      <FormattedMessage\n                        defaultMessage=\"Image grid\"\n                        description=\"Experiment tracking > runs charts > add chart menu > image grid\"\n                      />\n                    </div>\n                  </LegacySelect.Option>\n                )}\n              </LegacySelect>\n            </RunsChartsConfigureField>\n          )}\n          {renderConfigOptionsforChartType(currentFormState.type)}\n        </div>\n        <RunsChartsTooltipWrapper contextData={{ runs: chartRunData }} component={RunsChartsTooltipBody} hoverOnly>\n          <div css={styles.chartWrapper}>{renderPreviewChartType(currentFormState.type)}</div>\n        </RunsChartsTooltipWrapper>\n      </div>\n    </Modal>\n  );\n};\n\nconst styles = {\n  chartTypeOption: (theme: Theme) =>\n    ({\n      display: 'grid',\n      gridTemplateColumns: `${theme.general.iconSize + theme.spacing.xs}px 1fr`,\n      gap: theme.spacing.xs,\n      alignItems: 'center',\n    } as Interpolation<Theme>),\n  wrapper: {\n    // TODO: wait for modal dimensions decision\n    display: 'grid',\n    gridTemplateColumns: '300px 1fr',\n    gap: 32,\n  } as Interpolation<Theme>,\n  field: {\n    // TODO: wait for modal dimensions decision\n    display: 'grid',\n    gridTemplateColumns: '80px 1fr',\n    marginBottom: 16,\n  } as Interpolation<Theme>,\n  chartWrapper: {\n    height: 400,\n    width: 500,\n  },\n};\n","import { barChartCardDefaultMargin } from '../cards/RunsChartsBarChartCard';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { RunsMetricsBarPlot } from '../RunsMetricsBarPlot';\nimport { useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport { RunsChartsBarCardConfig } from '../../runs-charts.types';\n\nexport const RunsChartsConfigureBarChartPreview = ({\n  previewData,\n  cardConfig,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsBarCardConfig;\n}) => {\n  const { resetTooltip, setTooltip } = useRunsChartsTooltip(cardConfig);\n\n  return (\n    <RunsMetricsBarPlot\n      useDefaultHoverBox={false}\n      displayRunNames={false}\n      displayMetricKey={false}\n      metricKey={cardConfig.metricKey}\n      runsData={previewData}\n      margin={barChartCardDefaultMargin}\n      onHover={setTooltip}\n      onUnhover={resetTooltip}\n    />\n  );\n};\n","import { RunsChartsRunData } from '../RunsCharts.common';\nimport { RunsContourPlot } from '../RunsContourPlot';\nimport { useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport { RunsChartsContourCardConfig } from '../../runs-charts.types';\n\nexport const RunsChartsConfigureContourChartPreview = ({\n  previewData,\n  cardConfig,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsContourCardConfig;\n}) => {\n  const { resetTooltip, setTooltip } = useRunsChartsTooltip(cardConfig);\n\n  return (\n    <RunsContourPlot\n      xAxis={cardConfig.xaxis}\n      yAxis={cardConfig.yaxis}\n      zAxis={cardConfig.zaxis}\n      runsData={previewData}\n      onHover={setTooltip}\n      onUnhover={resetTooltip}\n      useDefaultHoverBox={false}\n    />\n  );\n};\n","import { RunsChartsRunData } from '../RunsCharts.common';\nimport { RunsScatterPlot } from '../RunsScatterPlot';\nimport { useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport { RunsChartsScatterCardConfig } from '../../runs-charts.types';\n\nexport const RunsChartsConfigureScatterChartPreview = ({\n  previewData,\n  cardConfig,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsScatterCardConfig;\n}) => {\n  const { resetTooltip, setTooltip } = useRunsChartsTooltip(cardConfig);\n\n  return (\n    <RunsScatterPlot\n      xAxis={cardConfig.xaxis}\n      yAxis={cardConfig.yaxis}\n      runsData={previewData}\n      onHover={setTooltip}\n      onUnhover={resetTooltip}\n      useDefaultHoverBox={false}\n    />\n  );\n};\n","import { ReactNode } from 'react';\nimport { RunsChartsCardConfig } from '../runs-charts.types';\nimport { RunsChartsRunData } from './RunsCharts.common';\nimport { Modal, useDesignSystemTheme } from '@databricks/design-system';\nimport { RunsChartsTooltipBodyProps, RunsChartsTooltipWrapper } from '../hooks/useRunsChartsTooltip';\nimport { RunsChartsCard } from './cards/RunsChartsCard';\nimport type { RunsGroupByConfig } from '../../experiment-page/utils/experimentPage.group-row-utils';\n\nexport const RunsChartsFullScreenModal = <TContext,>({\n  chartData,\n  isMetricHistoryLoading = false,\n  groupBy,\n  fullScreenChart,\n  onCancel,\n  tooltipContextValue,\n  tooltipComponent,\n  autoRefreshEnabled,\n}: {\n  chartData: RunsChartsRunData[];\n  isMetricHistoryLoading?: boolean;\n  groupBy: RunsGroupByConfig | null;\n  autoRefreshEnabled?: boolean;\n  fullScreenChart: { config: RunsChartsCardConfig; title: string; subtitle: ReactNode } | undefined;\n  onCancel: () => void;\n  tooltipContextValue: TContext;\n  tooltipComponent: React.ComponentType<RunsChartsTooltipBodyProps<TContext>>;\n}) => {\n  const { theme, getPrefixedClassName } = useDesignSystemTheme();\n\n  const emptyReorderProps = {\n    canMoveDown: false,\n    canMoveUp: false,\n    onMoveDown: () => {},\n    onMoveUp: () => {},\n    onReorderWith: () => {},\n  };\n\n  const emptyConfigureProps = {\n    onRemoveChart: () => {},\n    onReorderCharts: () => {},\n    onStartEditChart: () => {},\n    setFullScreenChart: () => {},\n  };\n\n  if (!fullScreenChart) {\n    return null;\n  }\n\n  return (\n    <Modal\n      visible\n      onCancel={onCancel}\n      title={\n        <div css={{ display: 'flex', flexDirection: 'column' }}>\n          {fullScreenChart.title}\n          <span\n            css={{\n              color: theme.colors.textSecondary,\n              fontSize: theme.typography.fontSizeSm,\n              marginRight: theme.spacing.xs,\n            }}\n          >\n            {fullScreenChart.subtitle}\n          </span>\n        </div>\n      }\n      footer={null}\n      verticalSizing=\"maxed_out\"\n      dangerouslySetAntdProps={{ width: '95%' }}\n      css={{\n        [`.${getPrefixedClassName('modal-body')}`]: {\n          flex: 1,\n        },\n      }}\n    >\n      <RunsChartsTooltipWrapper contextData={tooltipContextValue} component={tooltipComponent}>\n        <RunsChartsCard\n          cardConfig={fullScreenChart.config}\n          chartRunData={chartData}\n          groupBy={groupBy}\n          index={0}\n          sectionIndex={0}\n          fullScreen\n          autoRefreshEnabled={autoRefreshEnabled}\n          {...emptyConfigureProps}\n          {...emptyReorderProps}\n        />\n      </RunsChartsTooltipWrapper>\n    </Modal>\n  );\n};\n","import { isNil } from 'lodash';\nimport { Button, CloseIcon, PinIcon, PinFillIcon, Tooltip, VisibleIcon, Typography } from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\nimport { FormattedMessage } from 'react-intl';\nimport { Link } from '../../../../common/utils/RoutingUtils';\nimport Routes from '../../../routes';\nimport { useExperimentIds } from '../../experiment-page/hooks/useExperimentIds';\nimport { RunsChartsRunData, RunsChartsLineChartXAxisType } from './RunsCharts.common';\nimport {\n  RunsChartsTooltipBodyProps,\n  RunsChartsTooltipMode,\n  containsMultipleRunsTooltipData,\n} from '../hooks/useRunsChartsTooltip';\nimport {\n  RunsChartsBarCardConfig,\n  RunsChartsCardConfig,\n  RunsChartType,\n  RunsChartsScatterCardConfig,\n  RunsChartsContourCardConfig,\n  RunsChartsLineCardConfig,\n  RunsChartsParallelCardConfig,\n} from '../runs-charts.types';\nimport {\n  type RunsCompareMultipleTracesTooltipData,\n  type RunsMetricsSingleTraceTooltipData,\n} from './RunsMetricsLinePlot';\nimport { RunsMultipleTracesTooltipBody } from './RunsMultipleTracesTooltipBody';\nimport { shouldEnableRelativeTimeDateAxis } from 'common/utils/FeatureUtils';\n\ninterface RunsChartsContextMenuContentDataType {\n  runs: RunsChartsRunData[];\n  onTogglePin?: (runUuid: string) => void;\n  onHideRun?: (runUuid: string) => void;\n}\n\ntype RunsChartContextMenuHoverDataType = RunsChartsCardConfig;\n\nconst createBarChartValuesBox = (cardConfig: RunsChartsBarCardConfig, activeRun: RunsChartsRunData) => {\n  const { metricKey } = cardConfig;\n  const metric = activeRun?.metrics[metricKey];\n\n  if (!metric) {\n    return null;\n  }\n\n  return (\n    <div css={styles.value}>\n      <strong>{metric.key}:</strong> {metric.value}\n    </div>\n  );\n};\n\nconst createScatterChartValuesBox = (cardConfig: RunsChartsScatterCardConfig, activeRun: RunsChartsRunData) => {\n  const { xaxis, yaxis } = cardConfig;\n  const xKey = xaxis.key;\n  const yKey = yaxis.key;\n\n  const xValue = xaxis.type === 'METRIC' ? activeRun.metrics[xKey]?.value : activeRun.params[xKey]?.value;\n\n  const yValue = yaxis.type === 'METRIC' ? activeRun.metrics[yKey]?.value : activeRun.params[yKey]?.value;\n\n  return (\n    <>\n      {xValue && (\n        <div css={styles.value}>\n          <strong>X ({xKey}):</strong> {xValue}\n        </div>\n      )}\n      {yValue && (\n        <div css={styles.value}>\n          <strong>Y ({yKey}):</strong> {yValue}\n        </div>\n      )}\n    </>\n  );\n};\n\nconst createContourChartValuesBox = (cardConfig: RunsChartsContourCardConfig, activeRun: RunsChartsRunData) => {\n  const { xaxis, yaxis, zaxis } = cardConfig;\n  const xKey = xaxis.key;\n  const yKey = yaxis.key;\n  const zKey = zaxis.key;\n\n  const xValue = xaxis.type === 'METRIC' ? activeRun.metrics[xKey]?.value : activeRun.params[xKey]?.value;\n\n  const yValue = yaxis.type === 'METRIC' ? activeRun.metrics[yKey]?.value : activeRun.params[yKey]?.value;\n\n  const zValue = zaxis.type === 'METRIC' ? activeRun.metrics[zKey]?.value : activeRun.params[zKey]?.value;\n\n  return (\n    <>\n      {xValue && (\n        <div css={styles.value}>\n          <strong>X ({xKey}):</strong> {xValue}\n        </div>\n      )}\n      {yValue && (\n        <div css={styles.value}>\n          <strong>Y ({yKey}):</strong> {yValue}\n        </div>\n      )}\n      {zValue && (\n        <div css={styles.value}>\n          <strong>Z ({zKey}):</strong> {zValue}\n        </div>\n      )}\n    </>\n  );\n};\n\nconst normalizeRelativeTimeChartTooltipValue = (value: string | number) => {\n  if (typeof value === 'number') {\n    return value;\n  }\n  return value.split(' ')[1] || '00:00:00';\n};\n\nconst getTooltipXValue = (\n  hoverData: RunsMetricsSingleTraceTooltipData | undefined,\n  xAxisKey: RunsChartsLineChartXAxisType,\n) => {\n  if (xAxisKey === RunsChartsLineChartXAxisType.METRIC) {\n    return hoverData?.xValue ?? '';\n  }\n\n  if (shouldEnableRelativeTimeDateAxis() && xAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE) {\n    return normalizeRelativeTimeChartTooltipValue(hoverData?.xValue ?? '');\n  }\n\n  // Default return for other cases\n  return hoverData?.xValue;\n};\n\nconst createLineChartValuesBox = (\n  cardConfig: RunsChartsLineCardConfig,\n  activeRun: RunsChartsRunData,\n  hoverData?: RunsMetricsSingleTraceTooltipData,\n) => {\n  const { metricKey: metricKeyFromConfig, xAxisKey } = cardConfig;\n  const metricKey = hoverData?.metricEntity?.key || metricKeyFromConfig;\n\n  // If there's available value from x axis (step or time), extract entry from\n  // metric history instead of latest metric.\n  const metricValue = hoverData?.yValue ?? activeRun?.metrics[metricKey].value;\n\n  if (isNil(metricValue)) {\n    return null;\n  }\n\n  const xValue = getTooltipXValue(hoverData, xAxisKey);\n\n  return (\n    <>\n      {hoverData && (\n        <div css={styles.value}>\n          <strong>{hoverData.label}:</strong> {xValue}\n        </div>\n      )}\n      <div css={styles.value}>\n        <strong>{metricKey}:</strong> {metricValue}\n      </div>\n    </>\n  );\n};\n\nconst createParallelChartValuesBox = (\n  cardConfig: RunsChartsParallelCardConfig,\n  activeRun: RunsChartsRunData,\n  isHovering?: boolean,\n) => {\n  const { selectedParams, selectedMetrics } = cardConfig as RunsChartsParallelCardConfig;\n  const paramsList = selectedParams.map((paramKey) => {\n    const param = activeRun?.params[paramKey];\n    if (param) {\n      return (\n        <div key={paramKey}>\n          <strong>{param.key}:</strong> {param.value}\n        </div>\n      );\n    }\n    return true;\n  });\n  const metricsList = selectedMetrics.map((metricKey) => {\n    const metric = activeRun?.metrics[metricKey];\n    if (metric) {\n      return (\n        <div key={metricKey}>\n          <strong>{metric.key}:</strong> {metric.value}\n        </div>\n      );\n    }\n    return true;\n  });\n\n  // show only first 3 params and primary metric if hovering, else show all\n  if (isHovering) {\n    return (\n      <>\n        {paramsList.slice(0, 3)}\n        {(paramsList.length > 3 || metricsList.length > 1) && <div>...</div>}\n        {metricsList[metricsList.length - 1]}\n      </>\n    );\n  } else {\n    return (\n      <>\n        {paramsList}\n        {metricsList}\n      </>\n    );\n  }\n};\n\n/**\n * Internal component that displays metrics/params - its final design\n * is a subject to change\n */\nconst ValuesBox = ({\n  activeRun,\n  cardConfig,\n  isHovering,\n  hoverData,\n}: {\n  activeRun: RunsChartsRunData;\n  cardConfig: RunsChartsCardConfig;\n  isHovering?: boolean;\n  hoverData?: RunsMetricsSingleTraceTooltipData;\n}) => {\n  if (cardConfig.type === RunsChartType.BAR) {\n    return createBarChartValuesBox(cardConfig as RunsChartsBarCardConfig, activeRun);\n  }\n\n  if (cardConfig.type === RunsChartType.SCATTER) {\n    return createScatterChartValuesBox(cardConfig as RunsChartsScatterCardConfig, activeRun);\n  }\n\n  if (cardConfig.type === RunsChartType.CONTOUR) {\n    return createContourChartValuesBox(cardConfig as RunsChartsContourCardConfig, activeRun);\n  }\n\n  if (cardConfig.type === RunsChartType.LINE) {\n    return createLineChartValuesBox(cardConfig as RunsChartsLineCardConfig, activeRun, hoverData);\n  }\n\n  if (cardConfig.type === RunsChartType.PARALLEL) {\n    return createParallelChartValuesBox(cardConfig as RunsChartsParallelCardConfig, activeRun, isHovering);\n  }\n\n  return null;\n};\n\nexport const RunsChartsTooltipBody = ({\n  closeContextMenu,\n  contextData,\n  hoverData,\n  chartData,\n  runUuid,\n  isHovering,\n  mode,\n}: RunsChartsTooltipBodyProps<\n  RunsChartsContextMenuContentDataType,\n  RunsChartContextMenuHoverDataType,\n  RunsMetricsSingleTraceTooltipData | RunsCompareMultipleTracesTooltipData\n>) => {\n  const { runs, onTogglePin, onHideRun } = contextData;\n  const [experimentId] = useExperimentIds();\n  const activeRun = runs?.find((run) => run.uuid === runUuid);\n\n  if (\n    containsMultipleRunsTooltipData(hoverData) &&\n    mode === RunsChartsTooltipMode.MultipleTracesWithScanline &&\n    isHovering\n  ) {\n    return <RunsMultipleTracesTooltipBody hoverData={hoverData} />;\n  }\n\n  const singleTraceHoverData = containsMultipleRunsTooltipData(hoverData) ? hoverData.hoveredDataPoint : hoverData;\n\n  if (!activeRun) {\n    return null;\n  }\n\n  const runName = activeRun.displayName || activeRun.uuid;\n  const metricSuffix = singleTraceHoverData?.metricEntity ? ` (${singleTraceHoverData.metricEntity.key})` : '';\n\n  return (\n    <div>\n      <div css={styles.contentWrapper}>\n        <div css={styles.header}>\n          <div css={styles.colorPill} style={{ backgroundColor: activeRun.color }} />\n          {activeRun.groupParentInfo ? (\n            <Typography.Text>{runName + metricSuffix}</Typography.Text>\n          ) : (\n            <Link\n              to={Routes.getRunPageRoute(experimentId, runUuid)}\n              target=\"_blank\"\n              css={styles.runLink}\n              onClick={closeContextMenu}\n            >\n              {runName + metricSuffix}\n            </Link>\n          )}\n        </div>\n        {!isHovering && (\n          <Button\n            componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_runscomparetooltipbody.tsx_259\"\n            size=\"small\"\n            onClick={closeContextMenu}\n            icon={<CloseIcon />}\n          />\n        )}\n      </div>\n\n      <ValuesBox\n        isHovering={isHovering}\n        activeRun={activeRun}\n        cardConfig={chartData}\n        hoverData={singleTraceHoverData}\n      />\n\n      <div css={styles.actionsWrapper}>\n        {activeRun.pinnable && onTogglePin && (\n          <Tooltip\n            title={\n              activeRun.pinned ? (\n                <FormattedMessage\n                  defaultMessage=\"Unpin run\"\n                  description=\"A tooltip for the pin icon button in the runs table next to the pinned run\"\n                />\n              ) : (\n                <FormattedMessage\n                  defaultMessage=\"Click to pin the run\"\n                  description=\"A tooltip for the pin icon button in the runs chart tooltip next to the not pinned run\"\n                />\n              )\n            }\n            placement=\"bottom\"\n          >\n            <Button\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_runscomparetooltipbody.tsx_282\"\n              size=\"small\"\n              onClick={() => {\n                onTogglePin(runUuid);\n                closeContextMenu();\n              }}\n              icon={activeRun.pinned ? <PinFillIcon /> : <PinIcon />}\n            />\n          </Tooltip>\n        )}\n        {onHideRun && (\n          <Tooltip\n            title={\n              <FormattedMessage\n                defaultMessage=\"Click to hide the run\"\n                description='A tooltip for the \"hide\" icon button in the runs chart tooltip'\n              />\n            }\n            placement=\"bottom\"\n          >\n            <Button\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_runscomparetooltipbody.tsx_302\"\n              data-testid=\"experiment-view-compare-runs-tooltip-visibility-button\"\n              size=\"small\"\n              onClick={() => {\n                onHideRun(runUuid);\n                closeContextMenu();\n              }}\n              icon={<VisibleIcon />}\n            />\n          </Tooltip>\n        )}\n      </div>\n    </div>\n  );\n};\n\nconst styles = {\n  runLink: (theme: Theme) => ({\n    color: theme.colors.primary,\n    '&:hover': {},\n  }),\n  actionsWrapper: {\n    marginTop: 8,\n    display: 'flex',\n    gap: 8,\n    alignItems: 'center',\n  },\n  header: {\n    display: 'flex',\n    gap: 8,\n    alignItems: 'center',\n  },\n  value: {\n    maxWidth: 300,\n    whiteSpace: 'nowrap' as const,\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n  },\n  contentWrapper: {\n    display: 'flex',\n    gap: 8,\n    alignItems: 'center',\n    marginBottom: 12,\n    justifyContent: 'space-between',\n    height: 24,\n  },\n  colorPill: { width: 12, height: 12, borderRadius: '100%' },\n};\n","import { useDesignSystemTheme } from '@databricks/design-system';\nimport { Data, Datum, Layout, PlotMouseEvent } from 'plotly.js';\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { LazyPlot } from '../../LazyPlot';\nimport { useMutableChartHoverCallback } from '../hooks/useMutableHoverCallback';\nimport { highlightScatterTraces, useRunsChartTraceHighlight } from '../hooks/useRunsChartTraceHighlight';\nimport {\n  commonRunsChartStyles,\n  RunsChartsRunData,\n  RunsChartAxisDef,\n  runsChartDefaultContourMargin,\n  runsChartHoverlabel,\n  RunsPlotsCommonProps,\n  createThemedPlotlyLayout,\n  useDynamicPlotSize,\n  getLegendDataFromRuns,\n} from './RunsCharts.common';\nimport RunsMetricsLegendWrapper from './RunsMetricsLegendWrapper';\nimport { createChartImageDownloadHandler } from '../hooks/useChartImageDownloadHandler';\n\nexport interface RunsContourPlotProps extends RunsPlotsCommonProps {\n  /**\n   * Horizontal axis with a metric or a param\n   */\n  xAxis: RunsChartAxisDef;\n\n  /**\n   * Vertical axis with a metric or a param\n   */\n  yAxis: RunsChartAxisDef;\n\n  /**\n   * Depth dimension with a metric or a param\n   */\n  zAxis: RunsChartAxisDef;\n\n  /**\n   * Array of runs data with corresponding values\n   */\n  runsData: RunsChartsRunData[];\n\n  /**\n   * Sets the color scale in [[0.35, 'rgb(40,60,190)'],[0.5, 'rgb(70,100,245)'],...] format.\n   * Leave unset to use the defualt scale.\n   */\n  colorScale?: [number, string][];\n\n  /**\n   * Set to `true` in order to reverse the color scale.\n   */\n  reverseScale?: boolean;\n}\n\nconst PLOT_CONFIG = {\n  displaylogo: false,\n  scrollZoom: false,\n  modeBarButtonsToRemove: ['toImage'],\n};\n\nconst DEFAULT_COLOR_SCALE: [number, string][] = [\n  [0, 'rgb(5,10,172)'],\n  [0.35, 'rgb(40,60,190)'],\n  [0.5, 'rgb(70,100,245)'],\n  [0.6, 'rgb(90,120,245)'],\n  [0.7, 'rgb(106,137,247)'],\n  [1, 'rgb(220,220,220)'],\n];\n\nexport const createTooltipTemplate = (zAxisTitle: string) =>\n  '<b>%{customdata[1]}:</b><br>' +\n  '<b>%{xaxis.title.text}:</b> %{x:.2f}<br>' +\n  '<b>%{yaxis.title.text}:</b> %{y:.2f}<br>' +\n  `<b>${zAxisTitle}:</b> %{customdata[2]:.2f}` +\n  '<extra></extra>';\n\n/**\n * Implementation of plotly.js chart displaying\n * contour plot comparing values for a given\n * set of experiments runs\n */\nexport const RunsContourPlot = React.memo(\n  ({\n    runsData,\n    xAxis,\n    yAxis,\n    zAxis,\n    markerSize = 10,\n    className,\n    reverseScale,\n    margin = runsChartDefaultContourMargin,\n    colorScale = DEFAULT_COLOR_SCALE,\n    onUpdate,\n    onHover,\n    onUnhover,\n    width,\n    height,\n    useDefaultHoverBox = true,\n    selectedRunUuid,\n    onSetDownloadHandler,\n  }: RunsContourPlotProps) => {\n    const { theme } = useDesignSystemTheme();\n\n    const { layoutHeight, layoutWidth, setContainerDiv, containerDiv, isDynamicSizeSupported } = useDynamicPlotSize();\n\n    const plotData = useMemo(() => {\n      // Prepare empty values\n      const xValues: (number | string)[] = [];\n      const yValues: (number | string)[] = [];\n      const zValues: (number | string)[] = [];\n      const colors: (number | string)[] = [];\n      const tooltipData: Datum[] = [];\n\n      // Iterate through all the runs and aggregate selected metrics/params\n      for (const runData of runsData) {\n        const { metrics, params, color, uuid, displayName } = runData;\n        const xAxisData = xAxis.type === 'METRIC' ? metrics : params;\n        const yAxisData = yAxis.type === 'METRIC' ? metrics : params;\n        const zAxisData = zAxis.type === 'METRIC' ? metrics : params;\n\n        const x = xAxisData?.[xAxis.key]?.value || undefined;\n        const y = yAxisData?.[yAxis.key]?.value || undefined;\n        const z = zAxisData?.[zAxis.key]?.value || undefined;\n\n        if (x && y && z) {\n          xValues.push(x);\n          yValues.push(y);\n          zValues.push(z);\n          colors.push(color || theme.colors.primary);\n          tooltipData.push([uuid, displayName || uuid, z] as any);\n        }\n      }\n\n      // Let's compile chart layers\n      const layers = [\n        // The top layer with the scatter plot (dots)\n        {\n          x: xValues,\n          y: yValues,\n          customdata: tooltipData,\n          text: runsData.map(({ displayName }) => displayName),\n          hovertemplate: useDefaultHoverBox ? createTooltipTemplate(zAxis.key) : undefined,\n          hoverinfo: useDefaultHoverBox ? undefined : 'none',\n          hoverlabel: useDefaultHoverBox ? runsChartHoverlabel : undefined,\n          type: 'scatter',\n          mode: 'markers',\n          textposition: 'bottom center',\n          marker: {\n            size: markerSize,\n            color: colors,\n            line: {\n              color: 'black',\n              width: 1,\n            },\n          },\n        },\n      ] as Data[];\n\n      // If there are at least two runs, add a contour chart layer\n      if (runsData.length > 1) {\n        layers.unshift({\n          x: xValues,\n          y: yValues,\n          z: zValues,\n          type: 'contour',\n          connectgaps: true,\n          hoverinfo: 'none',\n          contours: {\n            coloring: 'heatmap',\n          },\n          colorscale: colorScale,\n          reversescale: reverseScale,\n          colorbar: {\n            tickfont: { size: 11, color: theme.colors.textSecondary, family: '' },\n          },\n        } as Data);\n      }\n      return layers;\n    }, [\n      colorScale,\n      reverseScale,\n      markerSize,\n      runsData,\n      xAxis.type,\n      xAxis.key,\n      yAxis.type,\n      yAxis.key,\n      zAxis.type,\n      zAxis.key,\n      theme.colors.primary,\n      theme.colors.textSecondary,\n      useDefaultHoverBox,\n    ]);\n\n    const plotlyThemedLayout = useMemo(() => createThemedPlotlyLayout(theme), [theme]);\n\n    const [layout, setLayout] = useState<Partial<Layout>>({\n      width: width || layoutWidth,\n      height: height || layoutHeight,\n      margin,\n      xaxis: { title: xAxis.key, tickfont: { size: 11, color: theme.colors.textSecondary } },\n      yaxis: {\n        ticks: 'inside',\n        title: { standoff: 32, text: yAxis.key },\n        tickfont: { size: 11, color: theme.colors.textSecondary },\n      },\n      template: { layout: plotlyThemedLayout },\n    });\n\n    useEffect(() => {\n      setLayout((current) => {\n        const newLayout = {\n          ...current,\n          width: width || layoutWidth,\n          height: height || layoutHeight,\n          margin,\n        };\n\n        if (newLayout.xaxis) {\n          newLayout.xaxis.title = xAxis.key;\n        }\n\n        if (newLayout.yaxis) {\n          newLayout.yaxis.title = { standoff: 32, text: yAxis.key };\n        }\n\n        return newLayout;\n      });\n    }, [layoutWidth, layoutHeight, margin, xAxis.key, yAxis.key, width, height]);\n\n    const { setHoveredPointIndex } = useRunsChartTraceHighlight(\n      containerDiv,\n      selectedRunUuid,\n      runsData,\n      highlightScatterTraces,\n    );\n\n    const hoverCallback = useCallback(\n      ({ points }: PlotMouseEvent) => {\n        // Find hover event corresponding to the second curve (scatter plot) only\n        const scatterPoints = points.find(({ curveNumber }) => curveNumber === 1);\n\n        setHoveredPointIndex(scatterPoints?.pointIndex ?? -1);\n\n        if (!scatterPoints) {\n          return;\n        }\n\n        // Find the corresponding run UUID by basing on \"customdata\" field set in the trace data.\n        // Plotly TS typings don't support custom fields so we need to cast to \"any\" first\n        const pointCustomDataRunUuid = (scatterPoints as any)?.customdata?.[0];\n        if (pointCustomDataRunUuid) {\n          onHover?.(pointCustomDataRunUuid);\n        }\n      },\n      [onHover, setHoveredPointIndex],\n    );\n\n    const unhoverCallback = useCallback(() => {\n      onUnhover?.();\n      setHoveredPointIndex(-1);\n    }, [onUnhover, setHoveredPointIndex]);\n\n    /**\n     * Unfortunately plotly.js memorizes first onHover callback given on initial render,\n     * so in order to achieve updated behavior we need to wrap its most recent implementation\n     * in the immutable callback.\n     */\n    const mutableHoverCallback = useMutableChartHoverCallback(hoverCallback);\n\n    const legendLabelData = useMemo(() => getLegendDataFromRuns(runsData), [runsData]);\n\n    useEffect(() => {\n      const dataToExport: Data[] = plotData.map((trace: Data) => ({\n        ...trace,\n        mode: 'text+markers',\n      }));\n      onSetDownloadHandler?.(createChartImageDownloadHandler(dataToExport, layout));\n    }, [layout, onSetDownloadHandler, plotData]);\n\n    const chart = (\n      <div\n        css={[commonRunsChartStyles.chartWrapper(theme), commonRunsChartStyles.scatterChartHighlightStyles]}\n        className={className}\n        ref={setContainerDiv}\n      >\n        <LazyPlot\n          data={plotData}\n          useResizeHandler={!isDynamicSizeSupported}\n          css={commonRunsChartStyles.chart(theme)}\n          onUpdate={onUpdate}\n          layout={layout}\n          config={PLOT_CONFIG}\n          onHover={mutableHoverCallback}\n          onUnhover={unhoverCallback}\n        />\n      </div>\n    );\n\n    return <RunsMetricsLegendWrapper labelData={legendLabelData}>{chart}</RunsMetricsLegendWrapper>;\n  },\n);\n","import { useDesignSystemTheme } from '@databricks/design-system';\nimport { Config, Data, Layout } from 'plotly.js';\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { useIntl } from 'react-intl';\nimport { LazyPlot } from '../../LazyPlot';\nimport { useMutableChartHoverCallback } from '../hooks/useMutableHoverCallback';\nimport { highlightBarTraces, useRunsChartTraceHighlight } from '../hooks/useRunsChartTraceHighlight';\nimport {\n  commonRunsChartStyles,\n  RunsChartsRunData,\n  runsChartDefaultMargin,\n  runsChartHoverlabel,\n  RunsPlotsCommonProps,\n  createThemedPlotlyLayout,\n  normalizeChartValue,\n  useDynamicPlotSize,\n  getLegendDataFromRuns,\n} from './RunsCharts.common';\nimport type { MetricEntity } from '../../../types';\nimport RunsMetricsLegendWrapper from './RunsMetricsLegendWrapper';\nimport { createChartImageDownloadHandler } from '../hooks/useChartImageDownloadHandler';\n\n// We're not using params in bar plot\nexport type BarPlotRunData = Omit<RunsChartsRunData, 'params' | 'tags' | 'images'>;\n\nexport interface RunsMetricsBarPlotHoverData {\n  xValue: string;\n  yValue: number;\n  index: number;\n  metricEntity?: MetricEntity;\n}\n\nexport interface RunsMetricsBarPlotProps extends RunsPlotsCommonProps {\n  /**\n   * Determines which metric are we comparing by\n   */\n  metricKey: string;\n\n  /**\n   * Array of runs data with corresponding values\n   */\n  runsData: BarPlotRunData[];\n\n  /**\n   * Relative width of the plot bar\n   */\n  barWidth?: number;\n\n  /**\n   * Display run names on the Y axis\n   */\n  displayRunNames?: boolean;\n\n  /**\n   * Display metric key on the X axis\n   */\n  displayMetricKey?: boolean;\n}\n\nconst PLOT_CONFIG: Partial<Config> = {\n  displaylogo: false,\n  scrollZoom: false,\n  doubleClick: 'autosize',\n  showTips: false,\n  modeBarButtonsToRemove: ['toImage'],\n};\n\nexport const Y_AXIS_PARAMS = {\n  ticklabelposition: 'inside',\n  tickfont: { size: 11 },\n  fixedrange: true,\n};\n\nconst getFixedPointValue = (val: string | number, places = 2) => (typeof val === 'number' ? val.toFixed(places) : val);\n\n/**\n * Implementation of plotly.js chart displaying\n * bar plot comparing metrics for a given\n * set of experiments runs\n */\nexport const RunsMetricsBarPlot = React.memo(\n  ({\n    runsData,\n    metricKey,\n    className,\n    margin = runsChartDefaultMargin,\n    onUpdate,\n    onHover,\n    onUnhover,\n    barWidth = 3 / 4,\n    width,\n    height,\n    displayRunNames = true,\n    useDefaultHoverBox = true,\n    displayMetricKey = true,\n    selectedRunUuid,\n    onSetDownloadHandler,\n  }: RunsMetricsBarPlotProps) => {\n    const plotData = useMemo(() => {\n      // Run uuids\n      const ids = runsData.map((d) => d.uuid);\n\n      // Trace names\n      const names = runsData.map(({ displayName }) => displayName);\n\n      // Actual metric values\n      const values = runsData.map((d) => normalizeChartValue(d.metrics[metricKey]?.value));\n\n      // Displayed metric values\n      const textValues = runsData.map((d) => getFixedPointValue(d.metrics[metricKey]?.value));\n\n      // Colors corresponding to each run\n      const colors = runsData.map((d) => d.color);\n\n      return [\n        {\n          y: ids,\n          x: values,\n          names,\n          text: textValues,\n          textposition: values.map((value) => (value === 0 ? 'outside' : 'auto')),\n          textfont: {\n            size: 11,\n          },\n          metrics: runsData.map((d) => d.metrics[metricKey]),\n          // Display run name on hover. \"<extra></extra>\" removes plotly's \"extra\" tooltip that\n          // is unnecessary here.\n          type: 'bar' as any,\n          hovertemplate: useDefaultHoverBox ? '%{label}<extra></extra>' : undefined,\n          hoverinfo: useDefaultHoverBox ? 'y' : 'none',\n          hoverlabel: useDefaultHoverBox ? runsChartHoverlabel : undefined,\n          width: barWidth,\n\n          orientation: 'h',\n          marker: {\n            color: colors,\n          },\n        } as Data & { names: string[] },\n      ];\n    }, [runsData, metricKey, barWidth, useDefaultHoverBox]);\n\n    const { layoutHeight, layoutWidth, setContainerDiv, containerDiv, isDynamicSizeSupported } = useDynamicPlotSize();\n\n    const { formatMessage } = useIntl();\n    const { theme } = useDesignSystemTheme();\n    const plotlyThemedLayout = useMemo(() => createThemedPlotlyLayout(theme), [theme]);\n\n    const [layout, setLayout] = useState<Partial<Layout>>({\n      width: width || layoutWidth,\n      height: height || layoutHeight,\n      margin,\n      xaxis: {\n        title: displayMetricKey ? metricKey : undefined,\n        tickfont: { size: 11, color: theme.colors.textSecondary },\n      },\n      yaxis: {\n        showticklabels: displayRunNames,\n        title: displayRunNames\n          ? formatMessage({\n              defaultMessage: 'Run name',\n              description: 'Label for Y axis in bar chart when comparing metrics between runs',\n            })\n          : undefined,\n        tickfont: { size: 11, color: theme.colors.textSecondary },\n        fixedrange: true,\n      },\n      template: { layout: plotlyThemedLayout },\n    });\n\n    useEffect(() => {\n      setLayout((current) => ({\n        ...current,\n        width: width || layoutWidth,\n        height: height || layoutHeight,\n        margin,\n        xaxis: {\n          ...current.xaxis,\n          title: displayMetricKey ? metricKey : undefined,\n        },\n      }));\n    }, [layoutWidth, layoutHeight, margin, metricKey, width, height, displayMetricKey]);\n\n    const { setHoveredPointIndex } = useRunsChartTraceHighlight(\n      containerDiv,\n      selectedRunUuid,\n      runsData,\n      highlightBarTraces,\n    );\n\n    const hoverCallback = useCallback(\n      ({ points, event }) => {\n        const metricEntity = points[0].data?.metrics[points[0].pointIndex];\n        setHoveredPointIndex(points[0]?.pointIndex ?? -1);\n\n        const hoverData: RunsMetricsBarPlotHoverData = {\n          xValue: points[0].x,\n          yValue: points[0].value,\n          // The index of the X datum\n          index: points[0].pointIndex,\n          metricEntity,\n        };\n\n        const runUuid = points[0]?.label;\n        if (runUuid) {\n          onHover?.(runUuid, event, hoverData);\n        }\n      },\n      [onHover, setHoveredPointIndex],\n    );\n\n    const unhoverCallback = useCallback(() => {\n      onUnhover?.();\n      setHoveredPointIndex(-1);\n    }, [onUnhover, setHoveredPointIndex]);\n\n    /**\n     * Unfortunately plotly.js memorizes first onHover callback given on initial render,\n     * so in order to achieve updated behavior we need to wrap its most recent implementation\n     * in the immutable callback.\n     */\n    const mutableHoverCallback = useMutableChartHoverCallback(hoverCallback);\n\n    const legendLabelData = useMemo(() => getLegendDataFromRuns(runsData), [runsData]);\n\n    useEffect(() => {\n      // Prepare layout and data traces to export\n      const layoutToExport = {\n        ...layout,\n        yaxis: {\n          ...layout.yaxis,\n          showticklabels: true,\n          automargin: true,\n        },\n      };\n\n      const dataToExport = plotData.map((trace) => ({\n        ...trace,\n        // In exported image, use names for Y axes\n        y: trace.names,\n      }));\n      onSetDownloadHandler?.(createChartImageDownloadHandler(dataToExport, layoutToExport));\n    }, [layout, onSetDownloadHandler, plotData]);\n\n    const chart = (\n      <div\n        css={[commonRunsChartStyles.chartWrapper(theme), styles.highlightStyles]}\n        className={className}\n        ref={setContainerDiv}\n      >\n        <LazyPlot\n          data={plotData}\n          useResizeHandler={!isDynamicSizeSupported}\n          css={commonRunsChartStyles.chart(theme)}\n          onUpdate={onUpdate}\n          layout={layout}\n          config={PLOT_CONFIG}\n          onHover={mutableHoverCallback}\n          onUnhover={unhoverCallback}\n        />\n      </div>\n    );\n\n    return <RunsMetricsLegendWrapper labelData={legendLabelData}>{chart}</RunsMetricsLegendWrapper>;\n  },\n);\n\nconst styles = {\n  highlightStyles: {\n    '.trace.bars g.point path': {\n      transition: 'var(--trace-transition)',\n    },\n    '.trace.bars.is-highlight g.point path': {\n      opacity: 'var(--trace-opacity-dimmed-high) !important',\n    },\n    '.trace.bars g.point.is-hover-highlight path': {\n      opacity: 'var(--trace-opacity-highlighted) !important',\n    },\n    '.trace.bars g.point.is-selection-highlight path': {\n      opacity: 'var(--trace-opacity-highlighted) !important',\n      stroke: 'var(--trace-stroke-color)',\n      strokeWidth: 'var(--trace-stroke-width) !important',\n    },\n  },\n};\n","import { Typography, useDesignSystemTheme } from '@databricks/design-system';\n\nimport React from 'react';\nimport { Dash } from 'plotly.js';\n\nconst STROKE_WIDTH = 3;\n\n/**\n * Replicating plotly.js's dasharrays for each dash type, with smaller spaces\n * https://github.com/plotly/plotly.js/blob/master/src/components/drawing/index.js#L162\n */\nconst getDashArray = (dashType: Dash) => {\n  switch (dashType) {\n    case 'dot':\n      return `${STROKE_WIDTH}`;\n    case 'dash':\n      return `${2 * STROKE_WIDTH}, ${STROKE_WIDTH}`;\n    case 'longdash':\n      return `${3 * STROKE_WIDTH}, ${STROKE_WIDTH}`;\n    case 'dashdot':\n      return `${2 * STROKE_WIDTH}, ${STROKE_WIDTH}, ${STROKE_WIDTH}, ${STROKE_WIDTH}`;\n    case 'longdashdot':\n      return `${3 * STROKE_WIDTH}, ${STROKE_WIDTH}, ${STROKE_WIDTH}, ${STROKE_WIDTH}`;\n    default:\n      return '';\n  }\n};\n\nexport type LegendLabelData = {\n  label: string;\n  color: string;\n  dashStyle?: Dash;\n  uuid?: string;\n  metricKey?: string;\n};\n\nconst TraceLabel: React.FC<LegendLabelData> = ({ label, color, dashStyle }) => {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        alignItems: 'center',\n        textOverflow: 'ellipsis',\n        flexShrink: 0,\n        marginRight: theme.spacing.md,\n        maxWidth: '100%',\n      }}\n    >\n      <TraceLabelColorIndicator color={color} dashStyle={dashStyle} />\n      <Typography.Text\n        color=\"secondary\"\n        size=\"sm\"\n        css={{ whiteSpace: 'nowrap', textOverflow: 'ellipsis', overflow: 'hidden' }}\n      >\n        {label}\n      </Typography.Text>\n    </div>\n  );\n};\n\nexport const TraceLabelColorIndicator: React.FC<Pick<LegendLabelData, 'color' | 'dashStyle'>> = ({\n  color,\n  dashStyle,\n}) => {\n  const { theme } = useDesignSystemTheme();\n  const strokeDasharray = dashStyle ? getDashArray(dashStyle) : undefined;\n  const pathYOffset = theme.typography.fontSizeSm / 2;\n\n  return (\n    <svg\n      css={{\n        height: theme.typography.fontSizeSm,\n        width: STROKE_WIDTH * 8,\n        marginRight: theme.spacing.xs,\n        flexShrink: 0,\n      }}\n    >\n      <path\n        d={`M0,${pathYOffset}h${STROKE_WIDTH * 8}`}\n        style={{\n          strokeWidth: STROKE_WIDTH,\n          stroke: color,\n          strokeDasharray,\n        }}\n      />\n    </svg>\n  );\n};\ntype RunsMetricsLegendProps = {\n  labelData: LegendLabelData[];\n  height: number;\n  fullScreen?: boolean;\n};\n\nconst RunsMetricsLegend: React.FC<RunsMetricsLegendProps> = ({ labelData, height, fullScreen }) => {\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div\n      css={{\n        display: 'flex',\n        flexWrap: 'wrap',\n        height,\n        alignContent: fullScreen ? 'flex-start' : 'normal',\n        gap: fullScreen ? theme.spacing.sm : 0,\n        overflowY: 'auto',\n        overflowX: 'hidden',\n        marginTop: fullScreen ? theme.spacing.lg : theme.spacing.sm,\n      }}\n    >\n      {labelData.map((labelDatum) => (\n        <TraceLabel key={labelDatum.label} {...labelDatum} />\n      ))}\n    </div>\n  );\n};\n\nexport default RunsMetricsLegend;\n","import React from 'react';\n\nimport RunsMetricsLegend, { LegendLabelData } from './RunsMetricsLegend';\nimport { useDesignSystemTheme } from '@databricks/design-system';\n\nconst RunsMetricsLegendWrapper = ({\n  labelData,\n  fullScreen,\n  children,\n}: React.PropsWithChildren<{\n  labelData: LegendLabelData[];\n  fullScreen?: boolean;\n}>) => {\n  const { theme } = useDesignSystemTheme();\n\n  const FULL_SCREEN_LEGEND_HEIGHT = 100;\n  const LEGEND_HEIGHT = 32;\n\n  const height = fullScreen ? FULL_SCREEN_LEGEND_HEIGHT : LEGEND_HEIGHT;\n  const heightBuffer = fullScreen ? theme.spacing.lg : theme.spacing.md;\n\n  return (\n    <>\n      <div css={{ height: `calc(100% - ${height + heightBuffer}px)` }}>{children}</div>\n      <RunsMetricsLegend labelData={labelData} height={height} fullScreen={fullScreen} />\n    </>\n  );\n};\n\nexport default RunsMetricsLegendWrapper;\n","import { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport type { Figure } from 'react-plotly.js';\nimport type {\n  LineChartTraceData,\n  RunsCompareMultipleTracesTooltipData,\n  RunsMetricsLinePlotProps,\n  RunsMetricsSingleTraceTooltipData,\n} from '../components/RunsMetricsLinePlot';\nimport { compact, isNumber, isString, isUndefined, orderBy, throttle, uniq } from 'lodash';\nimport type { LegendLabelData } from '../components/RunsMetricsLegend';\nimport { RunsChartsLineChartXAxisType } from '../components/RunsCharts.common';\n\n// Plotly-specific selectors for finding particular elements of interest in the plot DOM structure\nconst PLOTLY_SVG_SELECTOR = '.main-svg';\nconst PLOTLY_DRAGLAYER_SELECTOR = '.main-svg .draglayer .nsewdrag';\n\n// Interval for throttling the tooltip data update handler\nconst TOOLTIP_DATA_UPDATE_INTERVAL = 50;\n\n/**\n * Utility function, parses the microseconds from the plotly's axis boundary string\n * which are not supported by JavaScript's Date object and have to be added manually.\n *\n * E.g. transforms 2024-02-02 14:35:37.5747 into 0.7\n */\nconst parseMicroseconds = (plotlyAxisBoundary: string) => {\n  const microsecondsString =\n    isString(plotlyAxisBoundary) && plotlyAxisBoundary.match(/[0-9]{2}:[0-9]{2}:[0-9]{2}\\.([0-9]+)/)?.[1];\n  if (!microsecondsString) {\n    return 0;\n  }\n\n  // We turn the microseconds into a fraction of a millisecond, e.g. 0.5743 -> 574.3 -> 0.3\n  return (Number(`0.${microsecondsString}`) * 1000) % 1;\n};\n\nexport const useRunsMultipleTracesTooltipData = ({\n  onUnhover,\n  onHover,\n  runsData,\n  plotData,\n  legendLabelData,\n  containsMultipleMetricKeys,\n  xAxisKeyLabel,\n  xAxisKey,\n  disabled,\n  setHoveredPointIndex,\n  xAxisScaleType = 'linear',\n}: Pick<RunsMetricsLinePlotProps, 'runsData' | 'onHover' | 'onUnhover'> & {\n  plotData: LineChartTraceData[];\n  legendLabelData: LegendLabelData[];\n  containsMultipleMetricKeys?: boolean;\n  xAxisKeyLabel: string;\n  disabled: boolean;\n  xAxisKey: RunsChartsLineChartXAxisType;\n  setHoveredPointIndex: (value: number) => void;\n  xAxisScaleType?: 'linear' | 'log';\n}) => {\n  // Save current boundaries/dimensions of the plot in the mutable ref object\n  const chartBoundaries = useRef<{\n    containerLeftPixels: number;\n    plotWidthPixels: number;\n    plotOffsetPixels: number;\n    lowerBoundValue: number;\n    valueRange: number;\n    mainContainer: SVGElement | null;\n    dragLayer: SVGElement | null;\n    initialized: boolean;\n  }>({\n    containerLeftPixels: 0,\n    plotWidthPixels: 0,\n    plotOffsetPixels: 0,\n    lowerBoundValue: 0,\n    valueRange: 0,\n    mainContainer: null,\n    dragLayer: null,\n    initialized: false,\n  });\n\n  // Keep the reference to the scanline element\n  const scanlineElementRef = useRef<HTMLDivElement>(null);\n\n  // Keep the reference to the current hovered trace data\n  const currentHoveredDataPoint = useRef<RunsMetricsSingleTraceTooltipData | undefined>(undefined);\n\n  // Calculate all visible X values each time the plot data changes\n  const visibleXValues = useMemo(() => uniq(plotData.map(({ x }) => x).flat()) as number[], [plotData]);\n\n  // Store the reference to the initialized plotly's figure object, helps keep track when the plot is initialized\n  const [initializedFigure, setInitializedFigure] = useState<{\n    figure: Readonly<Figure>;\n    graphDiv: Readonly<HTMLElement>;\n  } | null>(null);\n\n  // We are calculating the tooltip data outside of React to avoid unnecessary re-renders,\n  // so we're copying all the input data to the mutable ref objects\n  const immediateHoverData = useRef<RunsCompareMultipleTracesTooltipData | undefined>(undefined);\n  const immediateLegendLabelData = useRef(legendLabelData);\n  const immediateRunsData = useRef(runsData);\n  const immediatePlotData = useRef(plotData);\n  const immediateXValuesData = useRef(visibleXValues);\n\n  // Update the mutable ref objects when the input data changes\n  immediateLegendLabelData.current = legendLabelData;\n  immediateRunsData.current = runsData;\n  immediatePlotData.current = plotData;\n  immediateXValuesData.current = visibleXValues;\n\n  // Setup the boundaries of the plot\n  const setupBoundaries = useCallback((figure: Readonly<Figure>) => {\n    const lowerAxisValue = figure.layout.xaxis?.range?.[0];\n    const upperAxisValue = figure.layout.xaxis?.range?.[1];\n\n    // If the axis values are numbers, use them as is, otherwise convert them to timestamps\n    let lowerBoundary = isNumber(lowerAxisValue) ? lowerAxisValue : new Date(lowerAxisValue ?? 0).getTime();\n    let upperBoundary = isNumber(upperAxisValue) ? upperAxisValue : new Date(upperAxisValue ?? 0).getTime();\n\n    lowerBoundary += parseMicroseconds(lowerAxisValue);\n    upperBoundary += parseMicroseconds(upperAxisValue);\n\n    // Save the boundaries to the mutable ref object\n    chartBoundaries.current.lowerBoundValue = lowerBoundary ?? 0;\n    chartBoundaries.current.valueRange = (upperBoundary ?? 0) - chartBoundaries.current.lowerBoundValue;\n  }, []);\n\n  const updateContainerPosition = useCallback(() => {\n    const { mainContainer, dragLayer } = chartBoundaries.current;\n\n    if (mainContainer && dragLayer) {\n      const containerRect = mainContainer.getBoundingClientRect();\n      const dragLayerRect = dragLayer.getBoundingClientRect();\n\n      // Save the boundaries to the mutable ref object\n      chartBoundaries.current.containerLeftPixels = containerRect.x;\n      chartBoundaries.current.plotWidthPixels = dragLayerRect.width;\n      chartBoundaries.current.plotOffsetPixels = dragLayerRect.x - containerRect.x;\n      chartBoundaries.current.initialized = dragLayerRect.width > 0;\n    }\n  }, []);\n\n  // This is a handler of plotly's onUpdate callback.\n  // It is called when the plot is initialized and when the plot is updated.\n  const onUpdatePlotHandler = useCallback(\n    (figure: Readonly<Figure>, graphDiv: Readonly<HTMLElement>) => {\n      setupBoundaries(figure);\n\n      const mainContainer: SVGElement | null = graphDiv.querySelector(PLOTLY_SVG_SELECTOR);\n      const dragLayer: SVGElement | null = graphDiv.querySelector(PLOTLY_DRAGLAYER_SELECTOR);\n\n      chartBoundaries.current.mainContainer = mainContainer;\n      chartBoundaries.current.dragLayer = dragLayer;\n      updateContainerPosition();\n    },\n    [setupBoundaries, updateContainerPosition],\n  );\n\n  // This is a handler of plotly's onInit callback.\n  const onInitPlotHandler = useCallback(\n    (figure: Readonly<Figure>, graphDiv: Readonly<HTMLElement>) => {\n      setInitializedFigure({ figure, graphDiv });\n      onUpdatePlotHandler(figure, graphDiv);\n    },\n    [onUpdatePlotHandler],\n  );\n\n  // Hides the scanline when the mouse leaves the plot\n  const pointerLeavePlotCallback = useCallback(\n    (e: PointerEvent) => {\n      // Noop if the mouse is moving to plotly's dragcover element\n      if (e.relatedTarget instanceof Element && e.relatedTarget.classList.contains('dragcover')) {\n        return;\n      }\n      onUnhover?.();\n      if (scanlineElementRef.current) {\n        scanlineElementRef.current.style.display = 'none';\n      }\n    },\n    [onUnhover],\n  );\n\n  // This is a handler of plotly's onHover callback.\n  const onPointHoverCallback = useCallback(\n    ({ points }) => {\n      const hoveredPoint = points[0];\n      const hoveredPointData = hoveredPoint?.data;\n\n      setHoveredPointIndex(hoveredPoint?.curveNumber ?? -1);\n\n      if (!hoveredPointData) {\n        return;\n      }\n\n      // Extract metric entity\n      const metricEntity = hoveredPointData.metricHistory?.[hoveredPoint.pointIndex];\n\n      const singleTraceData: RunsMetricsSingleTraceTooltipData = {\n        // Value of the \"x\" axis (time, step)\n        xValue: hoveredPoint.x,\n        // Value of the \"y\" axis\n        yValue: hoveredPoint.y,\n        // Metric entity value\n        metricEntity,\n        // The index of the X datum\n        index: hoveredPoint.pointIndex,\n        // Current label (\"Step\", \"Time\" etc.)\n        label: xAxisKeyLabel,\n        // Run/group UUID\n        traceUuid: hoveredPointData.uuid,\n      };\n\n      // Save the hovered point/trace data to the mutable ref object\n      currentHoveredDataPoint.current = singleTraceData;\n    },\n    [xAxisKeyLabel, setHoveredPointIndex],\n  );\n\n  // This is a handler of plotly's onUnhover callback.\n  const onPointUnhoverCallback = useCallback(() => {\n    currentHoveredDataPoint.current = undefined;\n    setHoveredPointIndex(-1);\n  }, [setHoveredPointIndex]);\n\n  const getClosestXValue = useCallback(\n    (pointerClientX: number) => {\n      const boundaries = chartBoundaries.current;\n      // Calculate the X value of the hovered point\n      const resultX =\n        (pointerClientX - boundaries.plotOffsetPixels - boundaries.containerLeftPixels) / boundaries.plotWidthPixels;\n\n      // Calculate the current step based on the X value and precalculated boundaries\n      let currentStep = boundaries.lowerBoundValue + boundaries.valueRange * resultX;\n      if (xAxisScaleType === 'log') {\n        currentStep = 10 ** currentStep;\n      }\n      // Find the closest existing X value to the currently hovered value\n      const closestXValue = immediateXValuesData.current.reduce((acc, x) => {\n        if (Math.abs(x - currentStep) < Math.abs(acc - currentStep)) {\n          return x;\n        }\n        return acc;\n      }, immediateXValuesData.current[0]);\n      return closestXValue;\n    },\n    [xAxisScaleType],\n  );\n\n  useEffect(() => {\n    // Return early if this tooltip is disabled\n    if (disabled) {\n      return;\n    }\n    // Return early if the figure is not initialized yet\n    if (!initializedFigure) {\n      return;\n    }\n\n    // Setup the boundaries of the plot at the beginning\n    setupBoundaries(initializedFigure.figure);\n\n    // Get the drag layer element - this is the event-sensitive layer of rendered plotly chart\n    const dragLayer: SVGElement | null = initializedFigure.graphDiv.querySelector(PLOTLY_DRAGLAYER_SELECTOR);\n\n    // This is a throttled handler of the pointermove event, it contains some heavier logic so it's throttled for 50ms\n    const tooltipDataUpdateHandler = throttle(\n      (e: PointerEvent) => {\n        // If for some reason the chart sizing is not initialized yet, do it now\n        if (!chartBoundaries.current.initialized) {\n          updateContainerPosition();\n        }\n        const closestXValue = getClosestXValue(e.clientX);\n\n        // Calculate the tooltip data - based on existing legend, plot and runs data\n        const data = immediateLegendLabelData.current.map((legendEntry) => {\n          // First, find the corresponding data entry (from chart components's input data) and trace (from data prepared for plotly)\n          const correspondingDataEntry = immediateRunsData.current.find(({ uuid }) => uuid === legendEntry.uuid);\n          const correspondingDataTrace = immediatePlotData.current.find(\n            ({ uuid, metricKey }) => uuid === legendEntry.uuid && legendEntry.metricKey === metricKey,\n          );\n\n          if (!correspondingDataTrace) {\n            return undefined;\n          }\n\n          // Determine the display name of the metric - if there are multiple metrics, use the legend label,\n          // otherwise use the display name of the corresponding data entry.\n          const displayName = containsMultipleMetricKeys ? legendEntry.label : correspondingDataEntry?.displayName;\n\n          // Find the value of the corresponding data trace at the closest X value\n          const xIndex = correspondingDataTrace.x?.indexOf(closestXValue);\n          if (isUndefined(xIndex) || xIndex === -1) {\n            return undefined;\n          }\n          const value = correspondingDataTrace.y?.[xIndex];\n\n          // Construct the tooltip legend entry\n          return {\n            displayName: displayName || '',\n            value: isNumber(value) ? value : undefined,\n            color: legendEntry?.color,\n            dashStyle: legendEntry?.dashStyle,\n            uuid: `${legendEntry.uuid}.${legendEntry.metricKey}`,\n          };\n        });\n\n        // Save the tooltip data to the mutable ref object\n        immediateHoverData.current = {\n          tooltipLegendItems: orderBy(compact(data), 'value', 'desc'),\n          hoveredDataPoint: currentHoveredDataPoint?.current,\n          xValue: closestXValue,\n          xAxisKey,\n          xAxisKeyLabel,\n        };\n      },\n      TOOLTIP_DATA_UPDATE_INTERVAL,\n      { leading: true },\n    );\n\n    const windowResizeHandler = throttle(updateContainerPosition, TOOLTIP_DATA_UPDATE_INTERVAL);\n\n    // This is a handler of the pointermove event.\n    // It's not throttled: it just updates the scanline and tooltip position and pass precalculated tooltip data\n    const hoverHandler = (e: PointerEvent) => {\n      if (!immediateHoverData.current) {\n        return;\n      }\n\n      const boundaries = chartBoundaries.current;\n      const closestXValue = getClosestXValue(e.clientX);\n      const closestXValueLeftX =\n        ((xAxisScaleType === 'log' ? Math.log10(closestXValue) : closestXValue) - boundaries.lowerBoundValue) /\n        boundaries.valueRange;\n      const closestXValueLeftInPixels = closestXValueLeftX * boundaries.plotWidthPixels;\n\n      // Enable and reposition the scanline\n      if (scanlineElementRef.current) {\n        scanlineElementRef.current.style.display = 'block';\n        scanlineElementRef.current.style.left = `${boundaries.plotOffsetPixels + closestXValueLeftInPixels}px`;\n      }\n\n      onHover?.(\n        immediateHoverData.current?.hoveredDataPoint?.traceUuid || '',\n        {\n          x: boundaries.containerLeftPixels + boundaries.plotOffsetPixels + closestXValueLeftInPixels,\n          y: e.clientY,\n          originalEvent: e,\n        },\n        immediateHoverData.current,\n      );\n    };\n\n    if (dragLayer) {\n      // Assign two separate handlers for move: one for updating the tooltip data, one for updating the scanline and tooltip position\n      dragLayer.addEventListener('pointermove', tooltipDataUpdateHandler);\n      dragLayer.addEventListener('pointermove', hoverHandler);\n      window.addEventListener('resize', windowResizeHandler);\n\n      // Assign a handler that hides the scanline and tooltip\n      dragLayer.addEventListener('pointerleave', pointerLeavePlotCallback);\n      return () => {\n        dragLayer.removeEventListener('pointermove', tooltipDataUpdateHandler);\n        dragLayer.removeEventListener('pointermove', hoverHandler);\n        dragLayer.removeEventListener('pointerleave', pointerLeavePlotCallback);\n        window.removeEventListener('resize', windowResizeHandler);\n      };\n    }\n\n    return () => {};\n  }, [\n    pointerLeavePlotCallback,\n    initializedFigure,\n    setupBoundaries,\n    onHover,\n    containsMultipleMetricKeys,\n    currentHoveredDataPoint,\n    disabled,\n    xAxisKey,\n    xAxisKeyLabel,\n    xAxisScaleType,\n    getClosestXValue,\n    updateContainerPosition,\n  ]);\n\n  const scanlineElement = disabled ? null : (\n    <div\n      css={{\n        top: 0,\n        width: 0,\n        borderLeft: `1px dashed rgba(0,0,0,0.5)`,\n        height: '100%',\n        position: 'absolute',\n        pointerEvents: 'none',\n      }}\n      ref={scanlineElementRef}\n      style={{ display: 'none' }}\n    />\n  );\n\n  return {\n    updateHandler: onUpdatePlotHandler,\n    initHandler: onInitPlotHandler,\n    scanlineElement,\n    onPointHover: onPointHoverCallback,\n    onPointUnhover: onPointUnhoverCallback,\n  };\n};\n","import { useDesignSystemTheme } from '@databricks/design-system';\nimport { compact, isEmpty, isEqual, maxBy, minBy } from 'lodash';\nimport { Config, Dash, Data as PlotlyData, Datum, Layout, LayoutAxis, TypedArray } from 'plotly.js';\nimport { Figure } from 'react-plotly.js';\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { useIntl } from 'react-intl';\nimport { MetricEntity } from '../../../types';\nimport { LazyPlot } from '../../LazyPlot';\nimport { useMutableChartHoverCallback } from '../hooks/useMutableHoverCallback';\nimport { highlightLineTraces, useRunsChartTraceHighlight } from '../hooks/useRunsChartTraceHighlight';\nimport {\n  commonRunsChartStyles,\n  RunsChartsRunData,\n  runsChartDefaultMargin,\n  runsChartHoverlabel,\n  RunsPlotsCommonProps,\n  createThemedPlotlyLayout,\n  normalizeChartValue,\n  useDynamicPlotSize,\n  getLineChartLegendData,\n  lineDashStyles,\n  containsDuplicateXValues,\n  createFadedTraceColor,\n  getChartAxisLabelDescriptor,\n  RunsChartsLineChartXAxisType,\n} from './RunsCharts.common';\nimport { EMA } from '../../MetricsPlotView';\nimport RunsMetricsLegendWrapper from './RunsMetricsLegendWrapper';\nimport { shouldEnableDeepLearningUIPhase3, shouldEnableRelativeTimeDateAxis } from 'common/utils/FeatureUtils';\nimport { useRunsMultipleTracesTooltipData } from '../hooks/useRunsChartsMultipleTracesTooltip';\nimport { createChartImageDownloadHandler } from '../hooks/useChartImageDownloadHandler';\nimport {\n  EPOCH_RELATIVE_TIME,\n  HOUR_IN_MILLISECONDS,\n  LINE_CHART_RELATIVE_TIME_THRESHOLD,\n} from 'experiment-tracking/constants';\n\nexport type LineChartTraceData = PlotlyData & {\n  x?: number[] | undefined;\n  y?: number[];\n  uuid?: string;\n  metricKey?: string;\n};\n\n// Display markers only if there are less than 60 points in the single data trace\nconst MARKER_DISPLAY_THRESHOLD = 60;\n\nconst getDataTraceForRun = ({\n  runEntry,\n  metricKey,\n  xAxisKey,\n  selectedXAxisMetricKey,\n  useDefaultHoverBox,\n  lineSmoothness,\n  lineShape,\n  lineDash,\n  displayPoints,\n}: {\n  runEntry: Omit<RunsChartsRunData, 'metrics' | 'params' | 'tags' | 'images'>;\n  metricKey: RunsMetricsLinePlotProps['metricKey'];\n  xAxisKey: RunsMetricsLinePlotProps['xAxisKey'];\n  selectedXAxisMetricKey: RunsMetricsLinePlotProps['selectedXAxisMetricKey'];\n  useDefaultHoverBox: RunsMetricsLinePlotProps['useDefaultHoverBox'];\n  lineSmoothness: RunsMetricsLinePlotProps['lineSmoothness'];\n  lineShape: RunsMetricsLinePlotProps['lineShape'];\n  lineDash?: Dash;\n  displayPoints?: boolean;\n}): LineChartTraceData => {\n  if (!runEntry.metricsHistory) {\n    return {};\n  }\n\n  const sortedMetricsHistory = runEntry.metricsHistory[metricKey]?.sort((a, b) =>\n    xAxisKey === RunsChartsLineChartXAxisType.STEP ? a.step - b.step : a.timestamp - b.timestamp,\n  );\n\n  let xValues;\n  let yValues;\n  if (xAxisKey === RunsChartsLineChartXAxisType.METRIC) {\n    const xValuesWithSteps = prepareXAxisDataForMetricType(runEntry.metricsHistory[selectedXAxisMetricKey]);\n    const stepOrder = xValuesWithSteps.map(({ step }) => step);\n    const yValueHistory = orderBySteps(sortedMetricsHistory ?? [], stepOrder);\n\n    xValues = xValuesWithSteps.map(({ value }) => value);\n    yValues = orderBySteps(yValueHistory, stepOrder).map(({ value }) => normalizeChartValue(value));\n  } else {\n    xValues = prepareMetricHistoryByAxisType(sortedMetricsHistory, xAxisKey);\n    yValues = sortedMetricsHistory?.map(({ value }) => normalizeChartValue(value));\n  }\n\n  // If there are any duplicate X values, use linear line shape\n  // to avoid bending splines in the wrong direction\n  const optimizedLineShape = containsDuplicateXValues(xValues) ? 'linear' : lineShape;\n\n  // Use chart card's configuration or if its unset, use the automatic behavior by checking the number of points\n  const shouldDisplayMarkers = displayPoints ?? xValues.length < MARKER_DISPLAY_THRESHOLD;\n\n  const containsSingleValue = yValues?.length === 1;\n\n  return {\n    // Let's add UUID to each run so it can be distinguished later (e.g. on hover)\n    uuid: runEntry.uuid,\n    name: runEntry.runInfo?.runName || '',\n    x: xValues,\n    // The actual value is on Y axis\n    y: EMA(yValues ?? [], lineSmoothness),\n    // Save the metric history\n    metricHistory: sortedMetricsHistory,\n    metricKey,\n    hovertext: runEntry.runInfo?.runName || '',\n    text: 'x',\n    textposition: 'outside',\n    textfont: {\n      size: 11,\n    },\n    mode: containsSingleValue || shouldDisplayMarkers ? 'lines+markers' : 'lines',\n    hovertemplate: useDefaultHoverBox ? createTooltipTemplate(runEntry.runInfo?.runName || '') : undefined,\n    hoverinfo: useDefaultHoverBox ? undefined : 'none',\n    hoverlabel: useDefaultHoverBox ? runsChartHoverlabel : undefined,\n    type: 'scatter',\n    line: { dash: lineDash, shape: optimizedLineShape },\n    marker: {\n      color: runEntry.color,\n    },\n  } as LineChartTraceData;\n};\n\nconst getBandTraceForRun = ({\n  runEntry,\n  metricKey,\n  lineShape,\n  xAxisKey,\n  selectedXAxisMetricKey,\n}: {\n  runEntry: Omit<RunsChartsRunData, 'metrics' | 'params' | 'tags' | 'images'>;\n  metricKey: RunsMetricsLinePlotProps['metricKey'];\n  lineShape: RunsMetricsLinePlotProps['lineShape'];\n  xAxisKey: RunsChartsLineChartXAxisType;\n  selectedXAxisMetricKey: RunsMetricsLinePlotProps['selectedXAxisMetricKey'];\n}): LineChartTraceData => {\n  if (!runEntry.aggregatedMetricsHistory) {\n    return {};\n  }\n\n  // Get upper and lower boundaries to draw a band\n  const { max, min } = runEntry.aggregatedMetricsHistory[metricKey];\n\n  let xMins, xMaxes, yMins, yMaxes;\n  if (xAxisKey === RunsChartsLineChartXAxisType.METRIC) {\n    if (!runEntry.metricsHistory) {\n      return {};\n    }\n    const xValuesWithSteps = prepareXAxisDataForMetricType(runEntry.metricsHistory[selectedXAxisMetricKey]);\n    const stepOrder = xValuesWithSteps.map((e) => e.step);\n    const xValues = xValuesWithSteps.map((e) => e.value);\n\n    yMins = orderBySteps(min, stepOrder)\n      .map(({ value }) => normalizeChartValue(value))\n      .reverse();\n    yMaxes = orderBySteps(max, stepOrder).map(({ value }) => normalizeChartValue(value));\n    xMins = xValues.slice().reverse();\n    xMaxes = xValues;\n  } else {\n    // Reverse one of the arrays so that the band is drawn correctly\n    const minReversed = min.slice().reverse();\n    xMins = prepareMetricHistoryByAxisType(minReversed, xAxisKey);\n    xMaxes = prepareMetricHistoryByAxisType(max, xAxisKey);\n    yMins = minReversed.map(({ value }) => normalizeChartValue(value));\n    yMaxes = max.map(({ value }) => normalizeChartValue(value));\n  }\n\n  // Place a null value in the middle to create a gap, otherwise Plotly will\n  // connect the lines and the fill will be drawn incorrectly\n  const xValues = [...xMins, null, ...xMaxes];\n  const bandValues = [...yMins, null, ...yMaxes];\n\n  return {\n    name: runEntry.runInfo?.runName || '',\n    x: xValues,\n    y: bandValues,\n    fillcolor: createFadedTraceColor(runEntry.color, 0.2),\n    hovertemplate: undefined,\n    hoverlabel: undefined,\n    hoverinfo: 'skip',\n    line: { color: 'transparent', shape: lineShape },\n    fill: 'tozeroy',\n    type: 'scatter',\n  } as LineChartTraceData;\n};\n\n/**\n * This function takes a list of metric entities and returns a copy ordered by\n * the step order provided. This is used in metric-type X axes, where the Y values\n * need to be ordered by the X values.\n *\n * For example:\n * dataPoints = [{step: 0, value: 1}, {step: 1, value: 2}, {step: 2, value: 3}]\n * stepOrder = [2, 0, 1]\n * return = [{step: 2, value: 3}, {step: 0, value: 1}, {step: 1, value: 2}]\n */\nconst orderBySteps = (dataPoints: MetricEntity[], stepOrder: number[]) => {\n  const stepIndexes = stepOrder.reduce((acc, step, idx) => {\n    acc[step] = idx;\n    return acc;\n  }, {} as Record<number, number>);\n\n  return dataPoints.slice().sort((a, b) => stepIndexes[a.step] - stepIndexes[b.step]);\n};\n\nexport interface RunsMetricsSingleTraceTooltipData {\n  xValue: string | number;\n  yValue: number;\n  index: number;\n  label: string;\n  traceUuid?: string;\n  metricEntity?: MetricEntity;\n}\n\nexport interface RunsCompareMultipleTracesTooltipData {\n  tooltipLegendItems: {\n    uuid: string;\n    color?: string;\n    dashStyle?: Dash;\n    displayName: string;\n    value?: string | number;\n  }[];\n  xValue: string | number;\n  xAxisKey: RunsChartsLineChartXAxisType;\n  xAxisKeyLabel: string;\n  hoveredDataPoint?: RunsMetricsSingleTraceTooltipData;\n}\n\nexport interface RunsMetricsLinePlotProps extends RunsPlotsCommonProps {\n  /**\n   * Determines which metric are we comparing by\n   * NOTE: used only as a fallback in V2 charts\n   */\n  metricKey: string;\n\n  /**\n   * Determines which metric keys to display in V2 charts\n   * NOTE: this prop may not be present in V1 chart configs\n   */\n  selectedMetricKeys?: string[];\n\n  /**\n   * Smoothing factor for EMA\n   */\n  lineSmoothness?: number;\n\n  /**\n   * X axis mode\n   */\n  xAxisScaleType?: 'linear' | 'log';\n\n  /**\n   * Y axis mode\n   */\n  scaleType?: 'linear' | 'log';\n\n  /**\n   * Use spline or polyline. Spline is default mode.\n   */\n  lineShape?: 'linear' | 'spline';\n\n  /**\n   * Choose X axis mode - numeric step or absolute time\n   */\n  xAxisKey?: RunsChartsLineChartXAxisType;\n\n  /**\n   * Name of the metric to use for the X axis. Used when xAxisKey is set to 'metric'\n   */\n  selectedXAxisMetricKey: string;\n\n  /**\n   * Array of runs data with corresponding values\n   */\n  runsData: Omit<RunsChartsRunData, 'metrics' | 'params' | 'tags' | 'images'>[];\n\n  /**\n   * Currently visible range on x-axis.\n   */\n  xRange?: [number | string, number | string];\n\n  /**\n   * Currently visible range on y-axis\n   */\n  yRange?: [number | string, number | string];\n\n  /**\n   * If set to true, only x-axis can be zoomed by dragging\n   */\n  lockXAxisZoom?: boolean;\n\n  /**\n   * Display points on the line chart. Undefined means \"auto\" mode, i.e. display points only when\n   * there are fewer than 60 datapoints on the chart.\n   */\n  displayPoints?: boolean;\n}\n\nconst PLOT_CONFIG: Partial<Config> = {\n  displaylogo: false,\n  doubleClick: 'autosize',\n  scrollZoom: false,\n  modeBarButtonsToRemove: ['toImage'],\n};\n\nexport const createTooltipTemplate = (runName: string) =>\n  `<b>${runName}</b>:<br>` +\n  '<b>%{xaxis.title.text}:</b> %{x}<br>' +\n  '<b>%{yaxis.title.text}:</b> %{y:.2f}<br>' +\n  '<extra></extra>';\n\n/**\n * Prepares dataset's X axis according to selected visualization type: step, time-wall and time-relative\n *\n * NOTE: metric-type X axes are handled by `prepareXAxisDataForMetricType()`, since we need to retain\n *       step information in order to format the Y axis data correctly.\n */\nconst prepareMetricHistoryByAxisType = (\n  metricHistory?: MetricEntity[],\n  axisType?: RunsMetricsLinePlotProps['xAxisKey'],\n) => {\n  if (!metricHistory) {\n    return [];\n  }\n  if (axisType === RunsChartsLineChartXAxisType.TIME_RELATIVE) {\n    const { timestamp: minTimestamp } = minBy(metricHistory, 'timestamp') || {};\n    if (minTimestamp) {\n      if (shouldEnableRelativeTimeDateAxis()) {\n        return metricHistory.map(({ timestamp }) => timestamp - minTimestamp + EPOCH_RELATIVE_TIME);\n      }\n      return metricHistory.map(({ timestamp }) => (timestamp - minTimestamp) / 1000); // Milliseconds -> seconds\n    }\n    return metricHistory.map(({ step }) => step);\n  } else if (shouldEnableRelativeTimeDateAxis() && axisType === RunsChartsLineChartXAxisType.TIME_RELATIVE_HOURS) {\n    const { timestamp: minTimestamp } = minBy(metricHistory, 'timestamp') || {};\n    if (minTimestamp) {\n      return metricHistory.map(({ timestamp }) => (timestamp - minTimestamp) / HOUR_IN_MILLISECONDS);\n    }\n  } else if (axisType === RunsChartsLineChartXAxisType.TIME) {\n    return metricHistory.map(({ timestamp }) => timestamp);\n  }\n\n  return metricHistory.map(({ step }) => step);\n};\n\n/**\n * Prepares dataset's X axis when axisType is 'metric'. This is separate from\n * `prepareMetricHistoryByAxisType` because we need to keep track of the `step`\n * in addition to the `value`, so that the Y axis data can be associated to the\n * correct X datapoint.\n */\nconst prepareXAxisDataForMetricType = (\n  metricHistory?: MetricEntity[],\n): Array<{\n  value: number | undefined;\n  step: number;\n}> => {\n  if (!metricHistory) {\n    return [];\n  }\n\n  return metricHistory\n    .map((datapoint) => ({\n      value: normalizeChartValue(datapoint.value),\n      step: datapoint.step,\n    }))\n    .sort((a, b) => {\n      // sort by value in ascending order\n      return Number(a.value) - Number(b.value);\n    });\n};\n\n/**\n * Implementation of plotly.js chart displaying\n * line plot comparing metrics' history for a given\n * set of experiments runs\n */\nexport const RunsMetricsLinePlot = React.memo(\n  ({\n    runsData,\n    metricKey,\n    selectedMetricKeys,\n    scaleType = 'linear',\n    xAxisScaleType = 'linear',\n    xAxisKey = RunsChartsLineChartXAxisType.STEP,\n    selectedXAxisMetricKey = '',\n    lineSmoothness = 70,\n    className,\n    margin = runsChartDefaultMargin,\n    lineShape = 'linear',\n    onUpdate,\n    onHover,\n    onUnhover,\n    width,\n    height,\n    useDefaultHoverBox = true,\n    selectedRunUuid,\n    xRange,\n    yRange,\n    lockXAxisZoom,\n    fullScreen,\n    displayPoints,\n    onSetDownloadHandler,\n  }: RunsMetricsLinePlotProps) => {\n    const { theme } = useDesignSystemTheme();\n    const usingMultipleRunsHoverTooltip = shouldEnableDeepLearningUIPhase3();\n\n    const dynamicXAxisKey = useMemo(() => {\n      let dynamicXAxisKey = xAxisKey;\n      if (shouldEnableRelativeTimeDateAxis() && xAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE) {\n        const metricKeys = selectedMetricKeys || [metricKey];\n        let maxDiff = 0;\n        runsData.forEach((runData) => {\n          const metricHistory = runData.metricsHistory;\n          if (metricHistory) {\n            metricKeys.forEach((metricKey) => {\n              if (metricHistory[metricKey]) {\n                const { timestamp: minTimestamp } = minBy(metricHistory[metricKey], 'timestamp') || {};\n                const { timestamp: maxTimestamp } = maxBy(metricHistory[metricKey], 'timestamp') || {};\n                if (maxTimestamp && minTimestamp) {\n                  const diff = maxTimestamp - minTimestamp;\n                  maxDiff = Math.max(maxDiff, diff);\n                }\n              }\n            });\n          }\n        });\n\n        if (maxDiff >= LINE_CHART_RELATIVE_TIME_THRESHOLD) {\n          dynamicXAxisKey = RunsChartsLineChartXAxisType.TIME_RELATIVE_HOURS;\n        }\n      }\n      return dynamicXAxisKey;\n    }, [runsData, selectedMetricKeys, metricKey, xAxisKey]);\n\n    const plotData = useMemo(() => {\n      // Generate a data trace for each metric in each run\n      const metricKeys = selectedMetricKeys ?? [metricKey];\n      return runsData\n        .map((runEntry) =>\n          metricKeys\n            // Discard creating traces for metrics that don't have any history for a given run\n            .filter((metricKey) => !isEmpty(runEntry.metricsHistory?.[metricKey]))\n            .map((metricKey, idx) => {\n              return getDataTraceForRun({\n                runEntry,\n                metricKey,\n                xAxisKey: dynamicXAxisKey,\n                selectedXAxisMetricKey,\n                useDefaultHoverBox,\n                lineSmoothness,\n                lineShape,\n                lineDash: lineDashStyles[idx % lineDashStyles.length],\n                displayPoints,\n              });\n            }),\n        )\n        .flat();\n    }, [\n      runsData,\n      lineShape,\n      dynamicXAxisKey,\n      lineSmoothness,\n      metricKey,\n      useDefaultHoverBox,\n      selectedMetricKeys,\n      selectedXAxisMetricKey,\n      displayPoints,\n    ]);\n\n    const bandsData = useMemo(() => {\n      const metricKeys = selectedMetricKeys ?? [metricKey];\n      return runsData\n        .filter(({ groupParentInfo }) => groupParentInfo)\n        .flatMap((runEntry) =>\n          metricKeys.map((metricKey) =>\n            getBandTraceForRun({\n              runEntry,\n              metricKey,\n              lineShape,\n              xAxisKey: dynamicXAxisKey,\n              selectedXAxisMetricKey,\n            }),\n          ),\n        );\n    }, [lineShape, metricKey, runsData, selectedMetricKeys, dynamicXAxisKey, selectedXAxisMetricKey]);\n\n    const plotDataWithBands = useMemo(() => [...bandsData, ...plotData], [plotData, bandsData]);\n\n    const { layoutHeight, layoutWidth, setContainerDiv, containerDiv, isDynamicSizeSupported } = useDynamicPlotSize();\n\n    const { formatMessage } = useIntl();\n\n    const { setHoveredPointIndex } = useRunsChartTraceHighlight(\n      containerDiv,\n      selectedRunUuid,\n      plotDataWithBands,\n      highlightLineTraces,\n      bandsData.length,\n    );\n\n    const xAxisKeyLabel = useMemo(() => {\n      if (dynamicXAxisKey === RunsChartsLineChartXAxisType.METRIC) {\n        return selectedXAxisMetricKey;\n      }\n\n      return formatMessage(getChartAxisLabelDescriptor(dynamicXAxisKey));\n    }, [formatMessage, dynamicXAxisKey, selectedXAxisMetricKey]);\n\n    const yAxisParams: Partial<LayoutAxis> = useMemo(\n      () => ({\n        tickfont: { size: 11, color: theme.colors.textSecondary },\n        type: scaleType === 'log' ? 'log' : 'linear',\n        fixedrange: lockXAxisZoom,\n      }),\n      [scaleType, lockXAxisZoom, theme],\n    );\n\n    const [layout, setLayout] = useState<Partial<Layout>>({\n      width: width || layoutWidth,\n      height: height || layoutHeight,\n      margin,\n      xaxis: {\n        title: xAxisKeyLabel,\n        tickfont: { size: 11, color: theme.colors.textSecondary },\n      },\n      yaxis: yAxisParams,\n      showlegend: false,\n    });\n\n    useEffect(() => {\n      setLayout((current) => {\n        const updatedLayout = {\n          ...current,\n          width: width || layoutWidth,\n          height: height || layoutHeight,\n          margin,\n          yaxis: yAxisParams,\n          showlegend: false,\n        };\n        if (isEqual(updatedLayout, current)) {\n          return current;\n        }\n        return updatedLayout;\n      });\n    }, [layoutWidth, layoutHeight, margin, yAxisParams, width, height, xAxisKeyLabel]);\n\n    const containsMultipleMetricKeys = useMemo(() => (selectedMetricKeys?.length || 0) > 1, [selectedMetricKeys]);\n\n    const hoverCallback = useCallback(\n      ({ points, event }) => {\n        const hoveredPoint = points[0];\n        const hoveredPointData = hoveredPoint?.data;\n        setHoveredPointIndex(hoveredPoint?.curveNumber ?? -1);\n\n        if (!hoveredPointData) {\n          return;\n        }\n        const runUuid = hoveredPointData.uuid;\n\n        // Extract metric entity\n        const metricEntity = hoveredPointData.metricHistory?.[hoveredPoint.pointIndex];\n\n        const data: RunsMetricsSingleTraceTooltipData = {\n          // Value of the \"x\" axis (time, step)\n          xValue: hoveredPoint.x,\n          // Value of the \"y\" axis\n          yValue: hoveredPoint.y,\n          // Metric entity value\n          metricEntity,\n          // The index of the X datum\n          index: hoveredPoint.pointIndex,\n          // Current label (\"Step\", \"Time\" etc.)\n          label: xAxisKeyLabel,\n        };\n        if (runUuid) {\n          onHover?.(runUuid, event, data);\n        }\n      },\n      [onHover, setHoveredPointIndex, xAxisKeyLabel],\n    );\n\n    const unhoverCallback = useCallback(() => {\n      onUnhover?.();\n      setHoveredPointIndex(-1);\n    }, [onUnhover, setHoveredPointIndex]);\n\n    const themedPlotlyLayout = useMemo(() => createThemedPlotlyLayout(theme), [theme]);\n\n    const getXAxisType = (xAxisKey: RunsChartsLineChartXAxisType, xAxisScaleType: 'linear' | 'log') => {\n      if (\n        xAxisKey === RunsChartsLineChartXAxisType.TIME ||\n        (shouldEnableRelativeTimeDateAxis() && dynamicXAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE)\n      ) {\n        return 'date';\n      }\n      if (xAxisKey === RunsChartsLineChartXAxisType.STEP && xAxisScaleType === 'log') {\n        return 'log';\n      }\n      return 'linear';\n    };\n\n    const getXAxisRange = (\n      xAxisKey: RunsChartsLineChartXAxisType,\n      xRange: [number | string, number | string],\n      xAxisScaleType: 'linear' | 'log',\n    ) => {\n      if (\n        xAxisKey === RunsChartsLineChartXAxisType.STEP &&\n        typeof xRange[0] === 'number' &&\n        typeof xRange[1] === 'number'\n      ) {\n        if (xAxisScaleType === 'log') {\n          if (xRange[0] < 0 && xRange[1] < 0) {\n            // If both are negative, autoscale\n            return undefined;\n          } else if (xRange[0] < 0) {\n            // If only the lower bound is negative, set it to 0\n            return [0, xRange[1]];\n          }\n        }\n      }\n      return [...xRange];\n    };\n\n    // When switching axis title, Plotly.js mutates its layout object\n    // internally which leads to desync problems and automatic axis range\n    // ends up with an invalid value. In order to fix it, we are mutating\n    // axis object and injecting metric key as title in\n    // the render phase.\n    // It could be fixed by wrapping plotly.js directly instead of using\n    // react-plotly.js - but the effort does not correspond to the plan of\n    // moving away from plotly soon.\n    const immediateLayout = layout;\n    if (immediateLayout.xaxis) {\n      immediateLayout.xaxis.title = xAxisKeyLabel;\n      immediateLayout.xaxis.type = getXAxisType(xAxisKey, xAxisScaleType);\n      if (xRange) {\n        immediateLayout.xaxis.range = getXAxisRange(xAxisKey, xRange, xAxisScaleType);\n      }\n      immediateLayout.xaxis.tickformat =\n        shouldEnableRelativeTimeDateAxis() && dynamicXAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE\n          ? '%H:%M:%S'\n          : undefined;\n    }\n    immediateLayout.template = { layout: themedPlotlyLayout };\n\n    if (yRange && immediateLayout.yaxis) {\n      immediateLayout.yaxis.range = yRange;\n      immediateLayout.yaxis.automargin = true;\n      immediateLayout.yaxis.tickformat = 'f';\n    }\n\n    const legendLabelData = useMemo(\n      () => getLineChartLegendData(runsData, selectedMetricKeys, metricKey),\n      [runsData, selectedMetricKeys, metricKey],\n    );\n\n    const {\n      scanlineElement,\n      initHandler,\n      updateHandler: updateHandlerMultipleRuns,\n      onPointHover: hoverCallbackMultipleRuns,\n      onPointUnhover: unhoverCallbackMultipleRuns,\n    } = useRunsMultipleTracesTooltipData({\n      legendLabelData,\n      plotData,\n      runsData,\n      containsMultipleMetricKeys,\n      onHover,\n      onUnhover: unhoverCallback,\n      xAxisKeyLabel,\n      xAxisKey: dynamicXAxisKey,\n      xAxisScaleType: xAxisKey === RunsChartsLineChartXAxisType.STEP ? xAxisScaleType : 'linear',\n      setHoveredPointIndex,\n      disabled: !usingMultipleRunsHoverTooltip,\n    });\n\n    /**\n     * Unfortunately plotly.js memorizes first onHover callback given on initial render,\n     * so in order to achieve updated behavior we need to wrap its most recent implementation\n     * in the immutable callback.\n     */\n    const mutableHoverCallback = useMutableChartHoverCallback(\n      usingMultipleRunsHoverTooltip ? hoverCallbackMultipleRuns : hoverCallback,\n    );\n\n    // Prepare data for image download handler\n    useEffect(() => {\n      // Check if we are using multiple metric keys. If so, we also need to append\n      // the metric key to  the trace name in the exported image.\n      const usingMultipleMetricKeys = (selectedMetricKeys?.length || 0) > 1;\n      const dataToExport = usingMultipleMetricKeys\n        ? plotDataWithBands.map((dataTrace) =>\n            dataTrace.metricKey\n              ? {\n                  ...dataTrace,\n                  name: `${dataTrace.name} (${dataTrace.metricKey})`,\n                }\n              : dataTrace,\n          )\n        : plotDataWithBands;\n\n      const layoutToExport: Partial<Layout> = {\n        ...layout,\n        showlegend: true,\n        legend: {\n          orientation: 'h',\n        },\n      };\n      onSetDownloadHandler?.(createChartImageDownloadHandler(dataToExport, layoutToExport));\n    }, [layout, onSetDownloadHandler, plotDataWithBands, selectedMetricKeys?.length]);\n\n    const chart = (\n      <div\n        css={[commonRunsChartStyles.chartWrapper(theme), styles.highlightStyles]}\n        className={className}\n        ref={setContainerDiv}\n      >\n        <LazyPlot\n          data={plotDataWithBands}\n          useResizeHandler={!isDynamicSizeSupported}\n          css={commonRunsChartStyles.chart(theme)}\n          onUpdate={(figure: Readonly<Figure>, graphDiv: Readonly<HTMLElement>) => {\n            if (usingMultipleRunsHoverTooltip) {\n              updateHandlerMultipleRuns(figure, graphDiv);\n            }\n            onUpdate?.(figure, graphDiv);\n          }}\n          layout={immediateLayout}\n          config={PLOT_CONFIG}\n          onHover={mutableHoverCallback}\n          onUnhover={usingMultipleRunsHoverTooltip ? unhoverCallbackMultipleRuns : unhoverCallback}\n          onInitialized={initHandler}\n        />\n        {scanlineElement}\n      </div>\n    );\n\n    return (\n      <RunsMetricsLegendWrapper labelData={legendLabelData} fullScreen={fullScreen}>\n        {chart}\n      </RunsMetricsLegendWrapper>\n    );\n  },\n);\n\nconst styles = {\n  highlightStyles: {\n    '.scatterlayer g.trace': {\n      transition: 'var(--trace-transition)',\n    },\n    '.scatterlayer.is-highlight g.trace:not(.is-band)': {\n      opacity: 'var(--trace-opacity-dimmed-low) !important',\n    },\n    '.scatterlayer g.trace.is-hover-highlight:not(.is-band)': {\n      opacity: 'var(--trace-opacity-highlighted) !important',\n    },\n    '.scatterlayer g.trace.is-selection-highlight:not(.is-band)': {\n      opacity: 'var(--trace-opacity-highlighted) !important',\n    },\n    '.scatterlayer g.trace.is-selection-highlight path.point': {\n      stroke: 'var(--trace-stroke-color)',\n      strokeWidth: 'var(--trace-stroke-width) !important',\n    },\n    '.scatterlayer.is-highlight g.trace.is-band:not(.is-band-highlighted)': {\n      opacity: 'var(--trace-opacity-dimmed) !important',\n    },\n  },\n};\n","import { isUndefined } from 'lodash';\n\nimport { RunsCompareMultipleTracesTooltipData } from './RunsMetricsLinePlot';\nimport React from 'react';\nimport { TraceLabelColorIndicator } from './RunsMetricsLegend';\nimport { FormattedDate, FormattedTime, useIntl } from 'react-intl';\nimport { getChartAxisLabelDescriptor, RunsChartsLineChartXAxisType } from './RunsCharts.common';\nimport { useDesignSystemTheme } from '@databricks/design-system';\nimport { shouldEnableRelativeTimeDateAxis } from 'common/utils/FeatureUtils';\n\n// Sadly when hovering outside data point, we can't get the date-time value from Plotly chart\n// so we have to format it ourselves in a way that resembles Plotly's logic\nconst PlotlyLikeFormattedTime = ({ value }: { value: string | number }) => (\n  <>\n    <FormattedDate value={value} year=\"numeric\" />-\n    <FormattedDate value={value} month=\"2-digit\" />-\n    <FormattedDate value={value} day=\"2-digit\" /> <FormattedTime value={value} hour=\"numeric\" hourCycle=\"h24\" />:\n    <FormattedTime value={value} minute=\"2-digit\" />:\n    {/* @ts-expect-error \"fractionalSecondDigits\" is supported but missing from TS types */}\n    <FormattedTime value={value} second=\"2-digit\" fractionalSecondDigits={3} />\n  </>\n);\n\n// Sadly when hovering outside data point, we can't get the date-time value from Plotly chart\n// so we have to format it ourselves in a way that resembles Plotly's logic\nconst PlotlyLikeFormattedTimestamp = ({ value }: { value: string | number }) => (\n  <>\n    <FormattedTime value={value} hour=\"2-digit\" hourCycle=\"h23\" />:\n    <FormattedTime value={value} minute=\"2-digit\" />:\n    {/* @ts-expect-error \"fractionalSecondDigits\" is supported but missing from TS types */}\n    <FormattedTime value={value} second=\"2-digit\" fractionalSecondDigits={3} />\n  </>\n);\n\n/**\n * Variant of the tooltip body for the line chart that displays multiple traces at once.\n * Used in the compare runs page and run details metrics page.\n */\nexport const RunsMultipleTracesTooltipBody = ({ hoverData }: { hoverData: RunsCompareMultipleTracesTooltipData }) => {\n  const { tooltipLegendItems, hoveredDataPoint: singleTraceHoverData, xValue, xAxisKeyLabel } = hoverData;\n  const { traceUuid: runUuid, metricEntity } = singleTraceHoverData || {};\n\n  const intl = useIntl();\n  const { theme } = useDesignSystemTheme();\n\n  const hoveredTraceUuid = `${runUuid}.${metricEntity?.key}`;\n  const displayedXValueLabel =\n    hoverData.xAxisKey === RunsChartsLineChartXAxisType.METRIC\n      ? xAxisKeyLabel\n      : intl.formatMessage(getChartAxisLabelDescriptor(hoverData.xAxisKey));\n\n  if (tooltipLegendItems) {\n    return (\n      <div>\n        {!isUndefined(xValue) && (\n          <div css={{ marginBottom: theme.spacing.xs }}>\n            <span css={{ fontWeight: 'bold' }}>{displayedXValueLabel}</span>{' '}\n            {hoverData.xAxisKey === RunsChartsLineChartXAxisType.TIME ? (\n              <PlotlyLikeFormattedTime value={xValue} />\n            ) : shouldEnableRelativeTimeDateAxis() &&\n              hoverData.xAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE ? (\n              <PlotlyLikeFormattedTimestamp value={xValue} />\n            ) : (\n              xValue\n            )}\n          </div>\n        )}\n        <div\n          css={{\n            display: 'grid',\n            gridTemplateColumns: `${theme.general.iconSize}px auto auto`,\n            columnGap: theme.spacing.sm,\n            rowGap: theme.spacing.sm / 4,\n            alignItems: 'center',\n          }}\n        >\n          {tooltipLegendItems.map(({ displayName, color, uuid, value, dashStyle }) => (\n            <React.Fragment key={uuid}>\n              <TraceLabelColorIndicator color={color || 'transparent'} dashStyle={dashStyle} />\n\n              <div\n                css={{\n                  marginRight: theme.spacing.md,\n                  fontSize: theme.typography.fontSizeSm,\n                  color: hoveredTraceUuid === uuid ? 'unset' : theme.colors.textPlaceholder,\n                }}\n              >\n                {displayName}\n              </div>\n              <div>\n                {!isUndefined(value) && (\n                  <span\n                    css={{\n                      fontWeight: hoveredTraceUuid === uuid ? 'bold' : 'normal',\n                      color: hoveredTraceUuid === uuid ? 'unset' : theme.colors.textPlaceholder,\n                    }}\n                  >\n                    {value}\n                  </span>\n                )}\n              </div>\n            </React.Fragment>\n          ))}\n        </div>\n      </div>\n    );\n  }\n  return null;\n};\n","import { useDesignSystemTheme } from '@databricks/design-system';\nimport { Data, Datum, Layout, PlotMouseEvent } from 'plotly.js';\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { LazyPlot } from '../../LazyPlot';\nimport { useMutableChartHoverCallback } from '../hooks/useMutableHoverCallback';\nimport { highlightScatterTraces, useRunsChartTraceHighlight } from '../hooks/useRunsChartTraceHighlight';\nimport {\n  commonRunsChartStyles,\n  RunsChartsRunData,\n  RunsChartAxisDef,\n  runsChartDefaultMargin,\n  runsChartHoverlabel,\n  RunsPlotsCommonProps,\n  createThemedPlotlyLayout,\n  useDynamicPlotSize,\n  getLegendDataFromRuns,\n} from './RunsCharts.common';\nimport RunsMetricsLegendWrapper from './RunsMetricsLegendWrapper';\nimport { createChartImageDownloadHandler } from '../hooks/useChartImageDownloadHandler';\n\nexport interface RunsScatterPlotProps extends RunsPlotsCommonProps {\n  /**\n   * Horizontal axis with a metric or a param\n   */\n  xAxis: RunsChartAxisDef;\n\n  /**\n   * Vertical axis with a metric or a param\n   */\n  yAxis: RunsChartAxisDef;\n\n  /**\n   * Array of runs data with corresponding values\n   */\n  runsData: RunsChartsRunData[];\n}\n\nconst PLOT_CONFIG = {\n  displaylogo: false,\n  scrollZoom: false,\n  modeBarButtonsToRemove: ['toImage'],\n};\n\nexport const createTooltipTemplate = () =>\n  '<b>%{customdata[1]}:</b><br>' +\n  '<b>%{xaxis.title.text}:</b> %{x:.2f}<br>' +\n  '<b>%{yaxis.title.text}:</b> %{y:.2f}<br>' +\n  '<extra></extra>';\n\n/**\n * Implementation of plotly.js chart displaying\n * scatter plot comparing values for a given\n * set of experiments runs\n */\nexport const RunsScatterPlot = React.memo(\n  ({\n    runsData,\n    xAxis,\n    yAxis,\n    markerSize = 10,\n    className,\n    margin = runsChartDefaultMargin,\n    onUpdate,\n    onHover,\n    onUnhover,\n    width,\n    height,\n    useDefaultHoverBox = true,\n    selectedRunUuid,\n    onSetDownloadHandler,\n  }: RunsScatterPlotProps) => {\n    const { theme } = useDesignSystemTheme();\n\n    const { layoutHeight, layoutWidth, setContainerDiv, containerDiv, isDynamicSizeSupported } = useDynamicPlotSize();\n\n    const plotData = useMemo(() => {\n      // Prepare empty values\n      const xValues: (number | string)[] = [];\n      const yValues: (number | string)[] = [];\n      const colors: (number | string)[] = [];\n      const tooltipData: Datum[] = [];\n\n      // Iterate through all the runs and aggregate selected metrics/params\n      for (const runData of runsData) {\n        const { runInfo, metrics, params, color, uuid, displayName } = runData;\n        const { runUuid, runName } = runInfo || {};\n        const xAxisData = xAxis.type === 'METRIC' ? metrics : params;\n        const yAxisData = yAxis.type === 'METRIC' ? metrics : params;\n\n        const x = xAxisData?.[xAxis.key]?.value || undefined;\n        const y = yAxisData?.[yAxis.key]?.value || undefined;\n\n        if (x && y) {\n          xValues.push(x);\n          yValues.push(y);\n          colors.push(color || theme.colors.primary);\n          if (runUuid) {\n            tooltipData.push([runUuid, runName || runUuid] as any);\n          } else {\n            tooltipData.push([uuid, displayName] as any);\n          }\n        }\n      }\n\n      return [\n        {\n          x: xValues,\n          y: yValues,\n          customdata: tooltipData,\n          text: runsData.map(({ displayName }) => displayName),\n          hovertemplate: useDefaultHoverBox ? createTooltipTemplate() : undefined,\n          hoverinfo: useDefaultHoverBox ? undefined : 'none',\n          hoverlabel: useDefaultHoverBox ? runsChartHoverlabel : undefined,\n          type: 'scatter',\n          mode: 'markers',\n          textposition: 'bottom center',\n          marker: {\n            size: markerSize,\n            color: colors,\n          },\n        } as Data,\n      ];\n    }, [runsData, xAxis, yAxis, theme, markerSize, useDefaultHoverBox]);\n\n    const plotlyThemedLayout = useMemo(() => createThemedPlotlyLayout(theme), [theme]);\n\n    const [layout, setLayout] = useState<Partial<Layout>>({\n      width: width || layoutWidth,\n      height: height || layoutHeight,\n      margin,\n      xaxis: { title: xAxis.key, tickfont: { size: 11, color: theme.colors.textSecondary } },\n      yaxis: { title: yAxis.key, tickfont: { size: 11, color: theme.colors.textSecondary } },\n      template: { layout: plotlyThemedLayout },\n    });\n\n    useEffect(() => {\n      setLayout((current) => {\n        const newLayout = {\n          ...current,\n          width: width || layoutWidth,\n          height: height || layoutHeight,\n          margin,\n        };\n\n        if (newLayout.xaxis) {\n          newLayout.xaxis.title = xAxis.key;\n        }\n\n        if (newLayout.yaxis) {\n          newLayout.yaxis.title = yAxis.key;\n        }\n\n        return newLayout;\n      });\n    }, [layoutWidth, layoutHeight, margin, xAxis.key, yAxis.key, width, height]);\n\n    const { setHoveredPointIndex } = useRunsChartTraceHighlight(\n      containerDiv,\n      selectedRunUuid,\n      runsData,\n      highlightScatterTraces,\n    );\n\n    const hoverCallback = useCallback(\n      ({ points }: PlotMouseEvent) => {\n        // Find the corresponding run UUID by basing on \"customdata\" field set in the trace data.\n        // Plotly TS typings don't support custom fields so we need to cast to \"any\" first\n        const pointCustomDataRunUuid = (points[0] as any)?.customdata?.[0];\n        setHoveredPointIndex(points[0]?.pointIndex ?? -1);\n\n        if (pointCustomDataRunUuid) {\n          onHover?.(pointCustomDataRunUuid);\n        }\n      },\n      [onHover, setHoveredPointIndex],\n    );\n\n    const unhoverCallback = useCallback(() => {\n      onUnhover?.();\n      setHoveredPointIndex(-1);\n    }, [onUnhover, setHoveredPointIndex]);\n\n    /**\n     * Unfortunately plotly.js memorizes first onHover callback given on initial render,\n     * so in order to achieve updated behavior we need to wrap its most recent implementation\n     * in the immutable callback.\n     */\n    const mutableHoverCallback = useMutableChartHoverCallback(hoverCallback);\n\n    const legendLabelData = useMemo(() => getLegendDataFromRuns(runsData), [runsData]);\n\n    useEffect(() => {\n      const dataToExport: Data[] = plotData.map((trace: Data) => ({\n        ...trace,\n        mode: 'text+markers',\n      }));\n      onSetDownloadHandler?.(createChartImageDownloadHandler(dataToExport, layout));\n    }, [layout, onSetDownloadHandler, plotData]);\n\n    const chart = (\n      <div\n        css={[commonRunsChartStyles.chartWrapper(theme), commonRunsChartStyles.scatterChartHighlightStyles]}\n        className={className}\n        ref={setContainerDiv}\n      >\n        <LazyPlot\n          data={plotData}\n          useResizeHandler={!isDynamicSizeSupported}\n          css={commonRunsChartStyles.chart(theme)}\n          layout={layout}\n          config={PLOT_CONFIG}\n          onUpdate={onUpdate}\n          onHover={mutableHoverCallback}\n          onUnhover={unhoverCallback}\n        />\n      </div>\n    );\n\n    return <RunsMetricsLegendWrapper labelData={legendLabelData}>{chart}</RunsMetricsLegendWrapper>;\n  },\n);\n","import {\n  Button,\n  DragIcon,\n  DropdownMenu,\n  OverflowIcon,\n  Typography,\n  useDesignSystemTheme,\n  InfoTooltip,\n  FullscreenIcon,\n  Switch,\n  Spinner,\n} from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\nimport { PropsWithChildren, ReactNode } from 'react';\nimport { useDragAndDropElement } from '../../../../../common/hooks/useDragAndDropElement';\nimport { shouldUseNewRunRowsVisibilityModel } from '../../../../../common/utils/FeatureUtils';\nimport { FormattedMessage } from 'react-intl';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport type { RunsChartsCardConfig } from '../../runs-charts.types';\nimport type { ExperimentChartImageDownloadFileFormat } from '../../hooks/useChartImageDownloadHandler';\n\nexport enum RunsChartsChartsDragGroup {\n  PARALLEL_CHARTS_AREA = 'PARALLEL_CHARTS_AREA',\n  GENERAL_AREA = 'GENERAL_AREA',\n}\n\nexport interface RunsChartCardReorderProps {\n  onReorderWith: (draggedKey: string, targetDropKey: string) => void;\n  canMoveUp: boolean;\n  canMoveDown: boolean;\n  onMoveUp: () => void;\n  onMoveDown: () => void;\n}\n\nexport type RunsChartCardSetFullscreenFn = (chart: {\n  config: RunsChartsCardConfig;\n  title: string;\n  subtitle: ReactNode;\n}) => void;\n\nexport interface RunsChartCardFullScreenProps {\n  fullScreen?: boolean;\n  setFullScreenChart?: RunsChartCardSetFullscreenFn;\n}\n\nexport interface ChartCardToggleProps {\n  toggleLabel: string;\n  currentToggle: boolean;\n  setToggle: () => void;\n}\n\nexport interface ChartCardWrapperProps extends RunsChartCardReorderProps {\n  title: React.ReactNode;\n  subtitle?: React.ReactNode;\n  onEdit: () => void;\n  onDelete: () => void;\n  tooltip?: string;\n  uuid?: string;\n  dragGroupKey: RunsChartsChartsDragGroup;\n  additionalMenuContent?: React.ReactNode;\n  toggleFullScreenChart?: () => void;\n  toggles?: ChartCardToggleProps[];\n  isRefreshing?: boolean;\n  onClickDownload?: (format: ExperimentChartImageDownloadFileFormat | 'csv' | 'csv-full') => void;\n  supportedDownloadFormats?: (ExperimentChartImageDownloadFileFormat | 'csv' | 'csv-full')[];\n}\n\nexport const ChartRunsCountIndicator = ({ runsOrGroups }: { runsOrGroups: RunsChartsRunData[] }) => {\n  const containsGroups = runsOrGroups.some(({ groupParentInfo }) => groupParentInfo);\n  const containsRuns = runsOrGroups.some(({ runInfo }) => runInfo);\n\n  // After moving to the new run rows visibility model, we don't configure run count per chart\n  if (shouldUseNewRunRowsVisibilityModel()) {\n    return null;\n  }\n\n  return containsRuns && containsGroups ? (\n    <FormattedMessage\n      defaultMessage=\"Comparing first {count} groups and runs\"\n      values={{ count: runsOrGroups.length }}\n      description=\"Experiment page > compare runs > chart header > compared groups and runs count label\"\n    />\n  ) : containsGroups ? (\n    <FormattedMessage\n      defaultMessage=\"Comparing first {count} groups\"\n      values={{ count: runsOrGroups.length }}\n      description=\"Experiment page > compare runs > chart header > compared groups count label\"\n    />\n  ) : (\n    <FormattedMessage\n      defaultMessage=\"Comparing first {count} runs\"\n      values={{ count: runsOrGroups.length }}\n      description=\"Experiment page > compare runs > chart header > compared runs count label\"\n    />\n  );\n};\n\n/**\n * Wrapper components for all chart cards. Provides styles and adds\n * a dropdown menu with actions for configure and delete.\n */\nexport const RunsChartCardWrapper = ({\n  title,\n  subtitle,\n  onDelete,\n  onEdit,\n  children,\n  uuid,\n  dragGroupKey,\n  tooltip = '',\n  onReorderWith = () => {},\n  canMoveDown,\n  canMoveUp,\n  onMoveDown,\n  onMoveUp,\n  additionalMenuContent,\n  toggleFullScreenChart,\n  toggles,\n  supportedDownloadFormats = [],\n  onClickDownload,\n  isRefreshing = false,\n}: PropsWithChildren<ChartCardWrapperProps>) => {\n  const { theme } = useDesignSystemTheme();\n\n  const { dragHandleRef, dragPreviewRef, dropTargetRef, isDraggingOtherGroup, isOver } = useDragAndDropElement({\n    dragGroupKey,\n    dragKey: uuid || '',\n    onDrop: onReorderWith,\n    disabled: false,\n  });\n\n  return (\n    <div\n      css={{\n        height: 360,\n        overflow: 'hidden',\n        display: 'grid',\n        gridTemplateRows: 'auto 1fr',\n        backgroundColor: theme.colors.backgroundPrimary,\n        padding: 12,\n        // have a slightly smaller padding when the enableDeepLearningUI\n        // flag is on to accomodate the legend in the charts\n        paddingBottom: theme.spacing.sm,\n        border: `1px solid ${theme.colors.border}`,\n        borderRadius: theme.general.borderRadiusBase,\n        transition: 'opacity 0.12s',\n        position: 'relative',\n      }}\n      style={{\n        opacity: isDraggingOtherGroup ? 0.1 : isOver ? 0.5 : 1,\n      }}\n      data-testid=\"experiment-view-compare-runs-card\"\n      ref={(element) => {\n        // Use this element for both drag preview and drop target\n        dragPreviewRef?.(element);\n        dropTargetRef?.(element);\n      }}\n    >\n      <div\n        css={{\n          display: 'flex',\n          overflow: 'hidden',\n        }}\n      >\n        <div\n          ref={dragHandleRef}\n          data-testid=\"experiment-view-compare-runs-card-drag-handle\"\n          css={{\n            marginTop: theme.spacing.xs,\n            marginRight: theme.spacing.sm,\n            cursor: 'grab',\n          }}\n        >\n          <DragIcon />\n        </div>\n        <div css={{ overflow: 'hidden', flex: 1, flexShrink: 1 }}>\n          <Typography.Title\n            title={String(title)}\n            level={4}\n            css={{\n              marginBottom: 0,\n              overflow: 'hidden',\n              whiteSpace: 'nowrap',\n              textOverflow: 'ellipsis',\n            }}\n          >\n            {title}\n          </Typography.Title>\n          {subtitle && <span css={styles.subtitle(theme)}>{subtitle}</span>}\n          {tooltip && <InfoTooltip css={{ verticalAlign: 'middle' }} title={tooltip} />}\n        </div>\n        {isRefreshing && (\n          <div\n            css={{\n              width: theme.general.heightSm,\n              height: theme.general.heightSm,\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n            }}\n          >\n            <Spinner />\n          </div>\n        )}\n        {toggles && (\n          <div\n            css={{\n              display: 'flex',\n              padding: `0px ${theme.spacing.lg}px`,\n              gap: theme.spacing.md,\n              alignItems: 'flex-start',\n            }}\n          >\n            {toggles.map((toggle) => {\n              return (\n                <Switch\n                  key={toggle.toggleLabel}\n                  checked={toggle.currentToggle}\n                  onChange={toggle.setToggle}\n                  label={toggle.toggleLabel}\n                />\n              );\n            })}\n          </div>\n        )}\n        <Button\n          componentId=\"fullscreen_button_chartcard\"\n          icon={<FullscreenIcon />}\n          onClick={toggleFullScreenChart}\n          disabled={!toggleFullScreenChart}\n        />\n        <DropdownMenu.Root modal={false}>\n          <DropdownMenu.Trigger asChild>\n            <Button\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_cards_chartcard.common.tsx_158\"\n              type=\"tertiary\"\n              icon={<OverflowIcon />}\n              data-testid=\"experiment-view-compare-runs-card-menu\"\n            />\n          </DropdownMenu.Trigger>\n          <DropdownMenu.Content align=\"end\" minWidth={100}>\n            <DropdownMenu.Item onClick={onEdit} data-testid=\"experiment-view-compare-runs-card-edit\">\n              Configure\n            </DropdownMenu.Item>\n            <DropdownMenu.Item onClick={onDelete} data-testid=\"experiment-view-compare-runs-card-delete\">\n              Delete\n            </DropdownMenu.Item>\n            {supportedDownloadFormats.length > 0 && onClickDownload && (\n              <>\n                <DropdownMenu.Separator />\n                {supportedDownloadFormats.includes('csv') && (\n                  <DropdownMenu.Item onClick={() => onClickDownload('csv')}>\n                    <FormattedMessage\n                      defaultMessage=\"Export as CSV\"\n                      description=\"Experiment page > compare runs tab > chart header > export CSV data option\"\n                    />\n                  </DropdownMenu.Item>\n                )}\n                {supportedDownloadFormats.includes('svg') && (\n                  <DropdownMenu.Item onClick={() => onClickDownload('svg')}>\n                    <FormattedMessage\n                      defaultMessage=\"Download as SVG\"\n                      description=\"Experiment page > compare runs tab > chart header > download as SVG option\"\n                    />\n                  </DropdownMenu.Item>\n                )}\n                {supportedDownloadFormats.includes('png') && (\n                  <DropdownMenu.Item onClick={() => onClickDownload('png')}>\n                    <FormattedMessage\n                      defaultMessage=\"Download as PNG\"\n                      description=\"Experiment page > compare runs tab > chart header > download as PNG option\"\n                    />\n                  </DropdownMenu.Item>\n                )}\n              </>\n            )}\n            <DropdownMenu.Separator />\n            <DropdownMenu.Item\n              disabled={!canMoveUp}\n              onClick={onMoveUp}\n              data-testid=\"experiment-view-compare-runs-move-up\"\n            >\n              <FormattedMessage\n                defaultMessage=\"Move up\"\n                description=\"Experiment page > compare runs tab > chart header > move up option\"\n              />\n            </DropdownMenu.Item>\n            <DropdownMenu.Item\n              disabled={!canMoveDown}\n              onClick={onMoveDown}\n              data-testid=\"experiment-view-compare-runs-move-down\"\n            >\n              <FormattedMessage\n                defaultMessage=\"Move down\"\n                description=\"Experiment page > compare runs tab > chart header > move down option\"\n              />\n            </DropdownMenu.Item>\n            {additionalMenuContent}\n          </DropdownMenu.Content>\n        </DropdownMenu.Root>\n      </div>\n      {children}\n    </div>\n  );\n};\n\nconst styles = {\n  chartEntry: (theme: Theme) => ({\n    height: 360,\n    overflow: 'hidden',\n    display: 'grid',\n    gridTemplateRows: 'auto 1fr',\n    backgroundColor: theme.colors.backgroundPrimary,\n    padding: theme.spacing.md,\n    border: `1px solid ${theme.colors.border}`,\n    borderRadius: theme.general.borderRadiusBase,\n  }),\n  chartComponentWrapper: () => ({\n    overflow: 'hidden',\n  }),\n  subtitle: (theme: Theme) => ({\n    color: theme.colors.textSecondary,\n    fontSize: 11,\n    marginRight: 4,\n    verticalAlign: 'middle',\n  }),\n};\n","import { useMemo } from 'react';\nimport type { RunsChartsRunData } from '../RunsCharts.common';\nimport { RunsMetricsBarPlot } from '../RunsMetricsBarPlot';\nimport { useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport type { RunsChartsBarCardConfig } from '../../runs-charts.types';\nimport { useIsInViewport } from '../../hooks/useIsInViewport';\nimport { shouldUseNewRunRowsVisibilityModel } from '../../../../../common/utils/FeatureUtils';\nimport {\n  RunsChartCardWrapper,\n  type RunsChartCardReorderProps,\n  RunsChartsChartsDragGroup,\n  ChartRunsCountIndicator,\n  RunsChartCardFullScreenProps,\n} from './ChartCard.common';\nimport { useChartImageDownloadHandler } from '../../hooks/useChartImageDownloadHandler';\nimport { downloadChartDataCsv } from '../../../experiment-page/utils/experimentPage.common-utils';\n\nexport interface RunsChartsBarChartCardProps extends RunsChartCardReorderProps, RunsChartCardFullScreenProps {\n  config: RunsChartsBarCardConfig;\n  chartRunData: RunsChartsRunData[];\n\n  onDelete: () => void;\n  onEdit: () => void;\n}\n\nexport const barChartCardDefaultMargin = {\n  t: 24,\n  b: 48,\n  r: 0,\n  l: 4,\n  pad: 0,\n};\n\nexport const RunsChartsBarChartCard = ({\n  config,\n  chartRunData,\n  onDelete,\n  onEdit,\n  onReorderWith,\n  canMoveDown,\n  canMoveUp,\n  onMoveDown,\n  onMoveUp,\n  fullScreen,\n  setFullScreenChart,\n}: RunsChartsBarChartCardProps) => {\n  const toggleFullScreenChart = () => {\n    setFullScreenChart?.({\n      config,\n      title: config.metricKey,\n      subtitle: <ChartRunsCountIndicator runsOrGroups={chartRunData} />,\n    });\n  };\n\n  const slicedRuns = useMemo(() => {\n    if (shouldUseNewRunRowsVisibilityModel()) {\n      return chartRunData.filter(({ hidden }) => !hidden).reverse();\n    }\n    return chartRunData.slice(0, config.runsCountToCompare || 10).reverse();\n  }, [chartRunData, config]);\n\n  const { setTooltip, resetTooltip, selectedRunUuid } = useRunsChartsTooltip(config);\n\n  const { elementRef, isInViewport } = useIsInViewport();\n\n  const [imageDownloadHandler, setImageDownloadHandler] = useChartImageDownloadHandler();\n\n  const chartBody = (\n    <div\n      css={[\n        styles.barChartCardWrapper,\n        {\n          height: fullScreen ? '100%' : undefined,\n        },\n      ]}\n      ref={elementRef}\n    >\n      {isInViewport ? (\n        <RunsMetricsBarPlot\n          runsData={slicedRuns}\n          metricKey={config.metricKey}\n          displayRunNames={false}\n          displayMetricKey={false}\n          useDefaultHoverBox={false}\n          margin={barChartCardDefaultMargin}\n          onHover={setTooltip}\n          onUnhover={resetTooltip}\n          selectedRunUuid={selectedRunUuid}\n          onSetDownloadHandler={setImageDownloadHandler}\n        />\n      ) : null}\n    </div>\n  );\n\n  if (fullScreen) {\n    return chartBody;\n  }\n\n  return (\n    <RunsChartCardWrapper\n      onEdit={onEdit}\n      onDelete={onDelete}\n      title={config.metricKey}\n      subtitle={<ChartRunsCountIndicator runsOrGroups={slicedRuns} />}\n      uuid={config.uuid}\n      dragGroupKey={RunsChartsChartsDragGroup.GENERAL_AREA}\n      onReorderWith={onReorderWith}\n      canMoveDown={canMoveDown}\n      canMoveUp={canMoveUp}\n      onMoveDown={onMoveDown}\n      onMoveUp={onMoveUp}\n      toggleFullScreenChart={toggleFullScreenChart}\n      supportedDownloadFormats={['png', 'svg', 'csv']}\n      onClickDownload={(format) => {\n        if (format === 'csv' || format === 'csv-full') {\n          const runsToExport = [...slicedRuns].reverse();\n          downloadChartDataCsv(runsToExport, [config.metricKey], [], config.metricKey);\n          return;\n        }\n        imageDownloadHandler?.(format, config.metricKey);\n      }}\n    >\n      {chartBody}\n    </RunsChartCardWrapper>\n  );\n};\n\nconst styles = {\n  barChartCardWrapper: {\n    overflow: 'hidden',\n  },\n};\n","import { LegacySkeleton } from '@databricks/design-system';\nimport { ReactNode, useEffect, useMemo, useRef } from 'react';\nimport { RunsChartsRunData, RunsChartsLineChartXAxisType } from '../RunsCharts.common';\nimport { RunsMetricsLinePlot } from '../RunsMetricsLinePlot';\nimport { RunsChartsTooltipMode, useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport type { RunsChartsCardConfig, RunsChartsLineCardConfig } from '../../runs-charts.types';\nimport {\n  type RunsChartCardReorderProps,\n  RunsChartCardWrapper,\n  RunsChartsChartsDragGroup,\n  ChartRunsCountIndicator,\n} from './ChartCard.common';\nimport { useSampledMetricHistory } from '../../hooks/useSampledMetricHistory';\nimport { compact, isEqual, pick, uniq } from 'lodash';\nimport { useIsInViewport } from '../../hooks/useIsInViewport';\nimport {\n  shouldEnableDeepLearningUIPhase3,\n  shouldUseNewRunRowsVisibilityModel,\n  shouldEnableRelativeTimeDateAxis,\n} from '../../../../../common/utils/FeatureUtils';\nimport { findAbsoluteTimestampRangeForRelativeRange } from '../../utils/findChartStepsByTimestamp';\nimport { Figure } from 'react-plotly.js';\nimport { ReduxState } from '../../../../../redux-types';\nimport { shallowEqual, useSelector } from 'react-redux';\nimport { useCompareRunChartSelectedRange } from '../../hooks/useCompareRunChartSelectedRange';\nimport { MetricHistoryByName } from 'experiment-tracking/types';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\nimport { useGroupedChartRunData } from '../../../runs-compare/hooks/useGroupedChartRunData';\nimport { useChartImageDownloadHandler } from '../../hooks/useChartImageDownloadHandler';\nimport { downloadChartMetricHistoryCsv } from '../../../experiment-page/utils/experimentPage.common-utils';\n\nconst getV2ChartTitle = (cardConfig: RunsChartsLineCardConfig): string => {\n  if (!cardConfig.selectedMetricKeys || cardConfig.selectedMetricKeys.length === 0) {\n    return cardConfig.metricKey;\n  }\n\n  return cardConfig.selectedMetricKeys.join(' vs ');\n};\n\nexport interface RunsChartsLineChartCardProps extends RunsChartCardReorderProps {\n  config: RunsChartsLineCardConfig;\n  chartRunData: RunsChartsRunData[];\n\n  groupBy: RunsGroupByConfig | null;\n\n  onDelete: () => void;\n  onEdit: () => void;\n\n  fullScreen?: boolean;\n\n  autoRefreshEnabled?: boolean;\n\n  setFullScreenChart?: (chart: { config: RunsChartsCardConfig; title: string; subtitle: ReactNode }) => void;\n  onDownloadFullMetricHistoryCsv?: (runUuids: string[], metricKeys: string[]) => void;\n}\n\nexport const RunsChartsLineChartCard = ({\n  config,\n  chartRunData,\n  onDelete,\n  onEdit,\n  onReorderWith,\n  onDownloadFullMetricHistoryCsv,\n  canMoveDown,\n  canMoveUp,\n  onMoveDown,\n  onMoveUp,\n  groupBy,\n  fullScreen,\n  setFullScreenChart,\n  autoRefreshEnabled,\n}: RunsChartsLineChartCardProps) => {\n  const usingMultipleRunsHoverTooltip = shouldEnableDeepLearningUIPhase3();\n\n  const toggleFullScreenChart = () => {\n    setFullScreenChart?.({\n      config,\n      title: getV2ChartTitle(config),\n      subtitle: <ChartRunsCountIndicator runsOrGroups={chartRunData} />,\n    });\n  };\n\n  const slicedRuns = useMemo(() => {\n    if (shouldUseNewRunRowsVisibilityModel()) {\n      return chartRunData.filter(({ hidden }) => !hidden).reverse();\n    }\n    return chartRunData.slice(0, config.runsCountToCompare || 10).reverse();\n  }, [chartRunData, config]);\n\n  const isGrouped = useMemo(() => slicedRuns.some((r) => r.groupParentInfo), [slicedRuns]);\n\n  const runUuidsToFetch = useMemo(() => {\n    if (isGrouped) {\n      // First, get all runs inside visible groups\n      const runsInGroups = compact(slicedRuns.map((r) => r.groupParentInfo)).flatMap((g) => g.runUuids);\n\n      // Finally, get \"remaining\" runs that are not grouped\n      const ungroupedRuns = compact(\n        slicedRuns.filter((r) => !r.groupParentInfo && !r.belongsToGroup).map((r) => r.runInfo?.runUuid),\n      );\n      return [...runsInGroups, ...ungroupedRuns];\n    }\n    // If grouping is disabled, just get all run UUIDs from runInfo\n    return compact(slicedRuns.map((r) => r.runInfo?.runUuid));\n  }, [slicedRuns, isGrouped]);\n\n  const metricKeys = useMemo(() => {\n    const fallback = [config.metricKey];\n\n    const yAxisKeys = config.selectedMetricKeys ?? fallback;\n    const xAxisKeys = !config.selectedXAxisMetricKey ? [] : [config.selectedXAxisMetricKey];\n\n    return yAxisKeys.concat(xAxisKeys);\n  }, [config.metricKey, config.selectedMetricKeys, config.selectedXAxisMetricKey]);\n\n  const { setTooltip, resetTooltip, destroyTooltip, selectedRunUuid } = useRunsChartsTooltip(\n    config,\n    usingMultipleRunsHoverTooltip ? RunsChartsTooltipMode.MultipleTracesWithScanline : RunsChartsTooltipMode.Simple,\n  );\n\n  const { elementRef, isInViewport } = useIsInViewport();\n\n  const { aggregateFunction } = groupBy || {};\n\n  const sampledMetricsByRunUuid = useSelector(\n    (state: ReduxState) => pick(state.entities.sampledMetricsByRunUuid, runUuidsToFetch),\n    shallowEqual,\n  );\n\n  const {\n    range: xRange,\n    setRange,\n    setOffsetTimestamp,\n    stepRange,\n  } = useCompareRunChartSelectedRange(\n    config.xAxisKey,\n    config.metricKey,\n    sampledMetricsByRunUuid,\n    runUuidsToFetch,\n    config.xAxisKey === RunsChartsLineChartXAxisType.STEP ? config.xAxisScaleType : 'linear',\n  );\n  // Memoizes last Y-axis range. Does't use stateful value, used only in the last immediate render dowstream.\n  const yRange = useRef<[number, number] | undefined>(undefined);\n\n  const { resultsByRunUuid, isLoading, isRefreshing } = useSampledMetricHistory({\n    runUuids: runUuidsToFetch,\n    metricKeys,\n    enabled: isInViewport,\n    maxResults: 320,\n    range: stepRange,\n    autoRefreshEnabled,\n  });\n\n  const chartLayoutUpdated = ({ layout }: Readonly<Figure>) => {\n    const { range: newYRange } = layout.yaxis || {};\n    const yRangeChanged = !isEqual(newYRange, yRange.current);\n\n    if (yRangeChanged) {\n      // When user zoomed in/out or changed the Y range manually, hide the tooltip\n      destroyTooltip();\n    }\n\n    // Save the last Y range value (copy the values since plotly works on mutable arrays)\n    yRange.current = [...(newYRange as [number, number])];\n\n    // Make sure that the x-axis is initialized\n    if (!layout.xaxis) {\n      return;\n    }\n    const { autorange, range: newXRange } = layout.xaxis;\n    if (autorange) {\n      // Remove saved range if chart is back to default viewport\n      setRange(undefined);\n      return;\n    }\n    if (isEqual(newXRange, xRange)) {\n      // If it's the same as previous, do nothing.\n      // Note: we're doing deep comparison here because the range has\n      // to be cloned due to plotly handling values in mutable way.\n      return;\n    }\n    // If the custom range is used, memoize it\n    if (!autorange && newXRange) {\n      const ungroupedRunUuids = compact(slicedRuns.map(({ runInfo }) => runInfo?.runUuid));\n      const groupedRunUuids = slicedRuns.flatMap(({ groupParentInfo }) => groupParentInfo?.runUuids ?? []);\n\n      if (!shouldEnableRelativeTimeDateAxis() && config.xAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE) {\n        const timestampRange = findAbsoluteTimestampRangeForRelativeRange(\n          resultsByRunUuid,\n          [...ungroupedRunUuids, ...groupedRunUuids],\n          newXRange as [number, number],\n        );\n        setOffsetTimestamp([...(timestampRange as [number, number])]);\n      } else if (config.xAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE_HOURS) {\n        const timestampRange = findAbsoluteTimestampRangeForRelativeRange(\n          resultsByRunUuid,\n          [...ungroupedRunUuids, ...groupedRunUuids],\n          newXRange as [number, number],\n          1000 * 60 * 60, // Convert hours to milliseconds\n        );\n        setOffsetTimestamp([...(timestampRange as [number, number])]);\n      } else {\n        setOffsetTimestamp(undefined);\n      }\n      setRange([...(newXRange as [number, number])]);\n    }\n  };\n\n  useEffect(() => {\n    destroyTooltip();\n  }, [destroyTooltip, isLoading]);\n\n  const sampledData: RunsChartsRunData[] = useMemo(\n    () =>\n      slicedRuns.map((run) => {\n        const metricsHistory = metricKeys.reduce((acc: MetricHistoryByName, key) => {\n          const history = resultsByRunUuid[run.uuid]?.[key]?.metricsHistory;\n          if (history) {\n            acc[key] = history;\n          }\n          return acc;\n        }, {});\n\n        return {\n          ...run,\n          metricsHistory,\n        };\n      }),\n    [metricKeys, resultsByRunUuid, slicedRuns],\n  );\n\n  const sampledGroupData = useGroupedChartRunData({\n    enabled: isGrouped,\n    ungroupedRunsData: sampledData,\n    metricKeys,\n    sampledDataResultsByRunUuid: resultsByRunUuid,\n    aggregateFunction,\n    selectedXAxisMetricKey:\n      config.xAxisKey === RunsChartsLineChartXAxisType.METRIC ? config.selectedXAxisMetricKey : undefined,\n  });\n\n  // Use grouped data traces only if enabled and if there are any groups\n  const chartData = isGrouped ? sampledGroupData : sampledData;\n\n  const [imageDownloadHandler, setImageDownloadHandler] = useChartImageDownloadHandler();\n\n  const chartBody = (\n    <div\n      css={[\n        styles.lineChartCardWrapper,\n        {\n          height: fullScreen ? '100%' : undefined,\n        },\n      ]}\n      ref={elementRef}\n    >\n      {!isInViewport ? null : isLoading ? (\n        <LegacySkeleton />\n      ) : (\n        <RunsMetricsLinePlot\n          runsData={chartData}\n          metricKey={config.metricKey}\n          selectedMetricKeys={config.selectedMetricKeys}\n          scaleType={config.scaleType}\n          xAxisKey={config.xAxisKey}\n          xAxisScaleType={config.xAxisScaleType}\n          selectedXAxisMetricKey={config.selectedXAxisMetricKey}\n          lineSmoothness={config.lineSmoothness}\n          useDefaultHoverBox={false}\n          onHover={setTooltip}\n          onUnhover={resetTooltip}\n          selectedRunUuid={selectedRunUuid}\n          onUpdate={chartLayoutUpdated}\n          // X-axis is stateful since it's used for sampling recalculation. For Y-axis,\n          // the immediate value is sufficient. It will not kick off rerender, but in those\n          // cases the plotly will use last known range.\n          xRange={xRange}\n          yRange={yRange.current}\n          fullScreen={fullScreen}\n          displayPoints={config.displayPoints}\n          onSetDownloadHandler={setImageDownloadHandler}\n        />\n      )}\n    </div>\n  );\n\n  if (fullScreen) {\n    return chartBody;\n  }\n\n  return (\n    <RunsChartCardWrapper\n      onEdit={onEdit}\n      onDelete={onDelete}\n      title={getV2ChartTitle(config)}\n      subtitle={<ChartRunsCountIndicator runsOrGroups={slicedRuns} />}\n      uuid={config.uuid}\n      dragGroupKey={RunsChartsChartsDragGroup.GENERAL_AREA}\n      onReorderWith={onReorderWith}\n      supportedDownloadFormats={['png', 'svg', 'csv', 'csv-full']}\n      onClickDownload={(format) => {\n        const savedChartTitle = config.selectedMetricKeys?.join('-') ?? config.metricKey;\n        if (format === 'csv-full') {\n          const singleRunUuids = compact(chartData.map((d) => d.runInfo?.runUuid));\n          const runUuidsFromGroups = compact(\n            chartData\n              .filter(({ groupParentInfo }) => groupParentInfo)\n              .flatMap((group) => group.groupParentInfo?.runUuids),\n          );\n          const runUuids = [...singleRunUuids, ...runUuidsFromGroups];\n          onDownloadFullMetricHistoryCsv?.(runUuids, config.selectedMetricKeys || [config.metricKey]);\n          return;\n        }\n        if (format === 'csv') {\n          downloadChartMetricHistoryCsv(chartData, config.selectedMetricKeys || [config.metricKey], savedChartTitle);\n          return;\n        }\n        imageDownloadHandler?.(format, savedChartTitle);\n      }}\n      canMoveDown={canMoveDown}\n      canMoveUp={canMoveUp}\n      onMoveDown={onMoveDown}\n      onMoveUp={onMoveUp}\n      toggleFullScreenChart={toggleFullScreenChart}\n      isRefreshing={isRefreshing}\n    >\n      {chartBody}\n    </RunsChartCardWrapper>\n  );\n};\n\nconst styles = {\n  lineChartCardWrapper: {\n    overflow: 'hidden',\n  },\n};\n","import { useMemo, useState } from 'react';\nimport { findChartStepsByTimestampForRuns } from '../utils/findChartStepsByTimestamp';\nimport { SampledMetricsByRunUuidState } from '../../../types';\nimport { isNumber, isString } from 'lodash';\nimport { RunsChartsLineChartXAxisType } from '../components/RunsCharts.common';\n\n/**\n * Hook used in compare run charts. It's responsible for converting selected range\n * (which can be either step or timestamp) to step range, based on chart axis type.\n *\n * @param xAxisKey Can be 'step', 'time' or 'time-relative'\n * @param metricKey\n * @param sampledMetricsByRunUuid Recorded history for metrics for runs in compare chart\n * @param runUuids List of run UUIDs in compare chart\n */\nexport const useCompareRunChartSelectedRange = (\n  xAxisKey: RunsChartsLineChartXAxisType,\n  metricKey: string,\n  sampledMetricsByRunUuid: SampledMetricsByRunUuidState,\n  runUuids: string[],\n  scaleType: 'linear' | 'log' = 'linear',\n) => {\n  const [range, setRange] = useState<[number | string, number | string] | undefined>(undefined);\n  const [offsetTimestamp, setOffsetTimestamp] = useState<[number, number] | undefined>(undefined);\n  const stepRange = useMemo<[number, number] | undefined>(() => {\n    if (!range) {\n      return undefined;\n    }\n    if (xAxisKey === RunsChartsLineChartXAxisType.TIME && isString(range[0]) && isString(range[1])) {\n      // If we're dealing with absolute time-based chart axis, find corresponding steps based on timestamp\n      const bounds = findChartStepsByTimestampForRuns(\n        sampledMetricsByRunUuid,\n        runUuids,\n        metricKey,\n        range as [string, string],\n      );\n      return bounds;\n    }\n\n    if (\n      xAxisKey === RunsChartsLineChartXAxisType.TIME_RELATIVE &&\n      offsetTimestamp &&\n      isNumber(range[0]) &&\n      isNumber(range[1])\n    ) {\n      // If we're dealing with absolute time-based chart axis, find corresponding steps based on timestamp\n      const bounds = findChartStepsByTimestampForRuns(\n        sampledMetricsByRunUuid,\n        runUuids,\n        metricKey,\n        offsetTimestamp as [number, number],\n      );\n      return bounds;\n    }\n\n    if (xAxisKey === RunsChartsLineChartXAxisType.STEP && isNumber(range[0]) && isNumber(range[1])) {\n      // If we're dealing with step-based chart axis, use those steps but incremented/decremented\n      const lowerBound = Math.floor(scaleType === 'log' ? 10 ** range[0] : range[0]);\n      const upperBound = Math.ceil(scaleType === 'log' ? 10 ** range[1] : range[1]);\n      return lowerBound && upperBound ? [lowerBound - 1, upperBound + 1] : undefined;\n    }\n\n    // return undefined for xAxisKey === 'metric' because there isn't\n    // necessarily a mapping between value range and step range\n    return undefined;\n  }, [xAxisKey, metricKey, range, sampledMetricsByRunUuid, runUuids, offsetTimestamp, scaleType]);\n\n  return {\n    /**\n     * Sets actually selected range in chart (can be timestamp, seconds range or step range)\n     */\n    setRange,\n    /**\n     * If there's an offset timestamp calculated from relative runs, set it using this function\n     */\n    setOffsetTimestamp,\n    /**\n     * Resulting step range\n     */\n    stepRange,\n    /**\n     * Actual raw range to be passed down to the chart component\n     */\n    range,\n  };\n};\n","import { useMemo } from 'react';\nimport type { RunsChartsRunData } from '../RunsCharts.common';\nimport type { RunsChartsScatterCardConfig } from '../../runs-charts.types';\nimport {\n  ChartRunsCountIndicator,\n  RunsChartCardFullScreenProps,\n  RunsChartCardReorderProps,\n  RunsChartCardWrapper,\n  RunsChartsChartsDragGroup,\n} from './ChartCard.common';\nimport { RunsScatterPlot } from '../RunsScatterPlot';\nimport { useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport { useIsInViewport } from '../../hooks/useIsInViewport';\nimport { shouldUseNewRunRowsVisibilityModel } from '../../../../../common/utils/FeatureUtils';\nimport { useChartImageDownloadHandler } from '../../hooks/useChartImageDownloadHandler';\nimport { downloadChartDataCsv } from '../../../experiment-page/utils/experimentPage.common-utils';\n\nexport interface RunsChartsScatterChartCardProps extends RunsChartCardReorderProps, RunsChartCardFullScreenProps {\n  config: RunsChartsScatterCardConfig;\n  chartRunData: RunsChartsRunData[];\n\n  onDelete: () => void;\n  onEdit: () => void;\n}\n\nexport const RunsChartsScatterChartCard = ({\n  config,\n  chartRunData,\n  onDelete,\n  onEdit,\n  onReorderWith,\n  canMoveDown,\n  canMoveUp,\n  onMoveDown,\n  onMoveUp,\n  fullScreen,\n  setFullScreenChart,\n}: RunsChartsScatterChartCardProps) => {\n  const title = `${config.xaxis.key} vs. ${config.yaxis.key}`;\n\n  const toggleFullScreenChart = () => {\n    setFullScreenChart?.({\n      config,\n      title,\n      subtitle: <ChartRunsCountIndicator runsOrGroups={chartRunData} />,\n    });\n  };\n\n  const slicedRuns = useMemo(() => {\n    if (shouldUseNewRunRowsVisibilityModel()) {\n      return chartRunData.filter(({ hidden }) => !hidden).reverse();\n    }\n    return chartRunData.slice(0, config.runsCountToCompare || 10).reverse();\n  }, [chartRunData, config]);\n\n  const { setTooltip, resetTooltip, selectedRunUuid } = useRunsChartsTooltip(config);\n\n  const { elementRef, isInViewport } = useIsInViewport();\n\n  const [imageDownloadHandler, setImageDownloadHandler] = useChartImageDownloadHandler();\n\n  const chartBody = (\n    <div\n      css={[\n        styles.scatterChartCardWrapper,\n        {\n          height: fullScreen ? '100%' : undefined,\n        },\n      ]}\n      ref={elementRef}\n    >\n      {isInViewport ? (\n        <RunsScatterPlot\n          runsData={slicedRuns}\n          xAxis={config.xaxis}\n          yAxis={config.yaxis}\n          onHover={setTooltip}\n          onUnhover={resetTooltip}\n          useDefaultHoverBox={false}\n          selectedRunUuid={selectedRunUuid}\n          onSetDownloadHandler={setImageDownloadHandler}\n        />\n      ) : null}\n    </div>\n  );\n\n  if (fullScreen) {\n    return chartBody;\n  }\n\n  return (\n    <RunsChartCardWrapper\n      onEdit={onEdit}\n      onDelete={onDelete}\n      title={title}\n      subtitle={<ChartRunsCountIndicator runsOrGroups={slicedRuns} />}\n      uuid={config.uuid}\n      dragGroupKey={RunsChartsChartsDragGroup.GENERAL_AREA}\n      onReorderWith={onReorderWith}\n      canMoveDown={canMoveDown}\n      canMoveUp={canMoveUp}\n      onMoveDown={onMoveDown}\n      onMoveUp={onMoveUp}\n      toggleFullScreenChart={toggleFullScreenChart}\n      supportedDownloadFormats={['png', 'svg', 'csv']}\n      onClickDownload={(format) => {\n        const savedChartTitle = [config.xaxis.key, config.yaxis.key].join('-');\n        if (format === 'csv' || format === 'csv-full') {\n          const paramsToExport = [];\n          const metricsToExport = [];\n          for (const axis of ['xaxis' as const, 'yaxis' as const]) {\n            if (config[axis].type === 'PARAM') {\n              paramsToExport.push(config[axis].key);\n            } else {\n              metricsToExport.push(config[axis].key);\n            }\n          }\n          downloadChartDataCsv(slicedRuns, metricsToExport, paramsToExport, savedChartTitle);\n          return;\n        }\n        imageDownloadHandler?.(format, savedChartTitle);\n      }}\n    >\n      {chartBody}\n    </RunsChartCardWrapper>\n  );\n};\n\nconst styles = {\n  scatterChartCardWrapper: {\n    overflow: 'hidden',\n  },\n};\n","import { useMemo } from 'react';\nimport type { RunsChartsRunData } from '../RunsCharts.common';\nimport type { RunsChartsContourCardConfig } from '../../runs-charts.types';\nimport {\n  ChartRunsCountIndicator,\n  RunsChartCardFullScreenProps,\n  RunsChartCardReorderProps,\n  RunsChartCardWrapper,\n  RunsChartsChartsDragGroup,\n} from './ChartCard.common';\nimport { RunsContourPlot } from '../RunsContourPlot';\nimport { useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport { shouldUseNewRunRowsVisibilityModel } from '../../../../../common/utils/FeatureUtils';\nimport { useChartImageDownloadHandler } from '../../hooks/useChartImageDownloadHandler';\nimport { downloadChartDataCsv } from '../../../experiment-page/utils/experimentPage.common-utils';\n\nexport interface RunsChartsContourChartCardProps extends RunsChartCardReorderProps, RunsChartCardFullScreenProps {\n  config: RunsChartsContourCardConfig;\n  chartRunData: RunsChartsRunData[];\n\n  onDelete: () => void;\n  onEdit: () => void;\n}\n\nexport const RunsChartsContourChartCard = ({\n  config,\n  chartRunData,\n  onDelete,\n  onEdit,\n  onReorderWith,\n  canMoveDown,\n  canMoveUp,\n  onMoveDown,\n  onMoveUp,\n  fullScreen,\n  setFullScreenChart,\n}: RunsChartsContourChartCardProps) => {\n  const title = `${config.xaxis.key} vs. ${config.yaxis.key} vs. ${config.zaxis.key}`;\n\n  const toggleFullScreenChart = () => {\n    setFullScreenChart?.({\n      config,\n      title,\n      subtitle: <ChartRunsCountIndicator runsOrGroups={chartRunData} />,\n    });\n  };\n\n  const slicedRuns = useMemo(() => {\n    if (shouldUseNewRunRowsVisibilityModel()) {\n      return chartRunData.filter(({ hidden }) => !hidden).reverse();\n    }\n    return chartRunData.slice(0, config.runsCountToCompare || 10).reverse();\n  }, [chartRunData, config]);\n\n  const { setTooltip, resetTooltip, selectedRunUuid } = useRunsChartsTooltip(config);\n\n  const [imageDownloadHandler, setImageDownloadHandler] = useChartImageDownloadHandler();\n\n  const chartBody = (\n    <div\n      css={[\n        styles.contourChartCardWrapper,\n        {\n          height: fullScreen ? '100%' : undefined,\n        },\n      ]}\n    >\n      <RunsContourPlot\n        runsData={slicedRuns}\n        xAxis={config.xaxis}\n        yAxis={config.yaxis}\n        zAxis={config.zaxis}\n        useDefaultHoverBox={false}\n        onHover={setTooltip}\n        onUnhover={resetTooltip}\n        selectedRunUuid={selectedRunUuid}\n        onSetDownloadHandler={setImageDownloadHandler}\n      />\n    </div>\n  );\n\n  if (fullScreen) {\n    return chartBody;\n  }\n\n  return (\n    <RunsChartCardWrapper\n      onEdit={onEdit}\n      onDelete={onDelete}\n      title={title}\n      subtitle={<ChartRunsCountIndicator runsOrGroups={slicedRuns} />}\n      uuid={config.uuid}\n      dragGroupKey={RunsChartsChartsDragGroup.GENERAL_AREA}\n      onReorderWith={onReorderWith}\n      canMoveDown={canMoveDown}\n      canMoveUp={canMoveUp}\n      onMoveDown={onMoveDown}\n      onMoveUp={onMoveUp}\n      toggleFullScreenChart={toggleFullScreenChart}\n      supportedDownloadFormats={['png', 'svg', 'csv']}\n      onClickDownload={(format) => {\n        const savedChartTitle = [config.xaxis.key, config.yaxis.key, config.zaxis.key].join('-');\n        if (format === 'csv' || format === 'csv-full') {\n          const paramsToExport = [];\n          const metricsToExport = [];\n          for (const axis of ['xaxis' as const, 'yaxis' as const, 'zaxis' as const]) {\n            if (config[axis].type === 'PARAM') {\n              paramsToExport.push(config[axis].key);\n            } else {\n              metricsToExport.push(config[axis].key);\n            }\n          }\n          downloadChartDataCsv(slicedRuns, metricsToExport, paramsToExport, savedChartTitle);\n          return;\n        }\n        imageDownloadHandler?.(format, savedChartTitle);\n      }}\n    >\n      {chartBody}\n    </RunsChartCardWrapper>\n  );\n};\n\nconst styles = {\n  contourChartCardWrapper: {\n    overflow: 'hidden',\n  },\n};\n","var _path, _path2, _g, _defs;\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nimport * as React from \"react\";\nfunction SvgParallelChartPlaceholder(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 80,\n    height: 42,\n    viewBox: \"0 0 80 42\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1.28418 2.34094L39.4998 17.0908L76.3746 7.87216\",\n    stroke: \"#CF797B\",\n    strokeLinecap: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1.95459 20.443L40.1702 25.1361L77.045 21.1134M1.95459 36.5338L40.1702 35.1929L77.045 25.1361\",\n    stroke: \"#A88E6F\",\n    strokeLinecap: \"round\"\n  })), _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    opacity: 0.8\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1.28418 1V40.3341\",\n    stroke: \"#338ECC\",\n    strokeLinecap: \"round\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M40.6189 2.07251V39.9763\",\n    stroke: \"#338ECC\",\n    strokeLinecap: \"round\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M77.7156 2.07251V39.9763\",\n    stroke: \"url(#paint0_linear_2781_406689)\",\n    strokeWidth: 4,\n    strokeLinecap: \"square\"\n  }))), _defs || (_defs = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"linearGradient\", {\n    id: \"paint0_linear_2781_406689\",\n    x1: 78.2156,\n    y1: 2.07251,\n    x2: 78.2156,\n    y2: 39.9763,\n    gradientUnits: \"userSpaceOnUse\"\n  }, /*#__PURE__*/React.createElement(\"stop\", {\n    stopColor: \"#D04F5E\"\n  }), /*#__PURE__*/React.createElement(\"stop\", {\n    offset: 1,\n    stopColor: \"#4D9734\"\n  })))));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgParallelChartPlaceholder);\nexport default __webpack_public_path__ + \"static/media/parallel-chart-placeholder.234ef0c5b220ef2a5a6fa5bafff173f7.svg\";\nexport { ForwardRef as ReactComponent };","import { Button, DropdownMenu, Typography } from '@databricks/design-system';\nimport { useCallback, useMemo } from 'react';\nimport { ReactComponent as ParallelChartSvg } from '../../../../../common/static/parallel-chart-placeholder.svg';\nimport type { RunsChartsRunData } from '../RunsCharts.common';\nimport LazyParallelCoordinatesPlot, { processParallelCoordinateData } from '../charts/LazyParallelCoordinatesPlot';\nimport { useRunsChartsTooltip } from '../../hooks/useRunsChartsTooltip';\nimport type { RunsChartsParallelCardConfig } from '../../runs-charts.types';\nimport {\n  type RunsChartCardReorderProps,\n  RunsChartCardWrapper,\n  RunsChartsChartsDragGroup,\n  RunsChartCardFullScreenProps,\n} from './ChartCard.common';\nimport { useIsInViewport } from '../../hooks/useIsInViewport';\nimport { shouldUseNewRunRowsVisibilityModel } from '../../../../../common/utils/FeatureUtils';\nimport { FormattedMessage } from 'react-intl';\nimport { useUpdateExperimentViewUIState } from '../../../experiment-page/contexts/ExperimentPageUIStateContext';\nimport { downloadChartDataCsv } from '../../../experiment-page/utils/experimentPage.common-utils';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\n\nexport interface RunsChartsParallelChartCardProps extends RunsChartCardReorderProps, RunsChartCardFullScreenProps {\n  config: RunsChartsParallelCardConfig;\n  chartRunData: RunsChartsRunData[];\n\n  onDelete: () => void;\n  onEdit: () => void;\n  groupBy: RunsGroupByConfig | null;\n}\n\n/**\n * A placeholder component displayed before parallel coords chart is being configured by user\n */\nconst EmptyParallelCoordsPlaceholder = ({ onEdit }: { onEdit: () => void }) => {\n  return (\n    <div css={{ display: 'flex', flex: 1, justifyContent: 'center', alignItems: 'center' }}>\n      <div css={{ display: 'flex', flexDirection: 'column', alignItems: 'center', maxWidth: 360 }}>\n        <ParallelChartSvg />\n        <Typography.Title css={{ marginTop: 16 }} color=\"secondary\" level={3}>\n          Compare parameter importance\n        </Typography.Title>\n        <Typography.Text css={{ marginBottom: 16 }} color=\"secondary\">\n          Use the parallel coordinates chart to compare how various parameters in model affect your model metrics.\n        </Typography.Text>\n        <Button\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_cards_runscompareparallelchartcard.tsx_51\"\n          type=\"primary\"\n          onClick={onEdit}\n        >\n          Configure chart\n        </Button>\n      </div>\n    </div>\n  );\n};\n\n/**\n * A placeholder component displayed before parallel coords chart is being configured by user\n */\nconst UnsupportedDataPlaceholder = () => (\n  <div css={{ display: 'flex', flex: 1, justifyContent: 'center', alignItems: 'center' }}>\n    <div css={{ display: 'flex', flexDirection: 'column', alignItems: 'center', maxWidth: 360 }}>\n      <ParallelChartSvg />\n      <Typography.Title css={{ marginTop: 16, textAlign: 'center' }} color=\"secondary\" level={3}>\n        <FormattedMessage\n          defaultMessage=\"Parallel coordinates chart does not support aggregated string values.\"\n          description=\"Experiment page > compare runs > parallel coordinates chart > unsupported string values warning > title\"\n        />\n      </Typography.Title>\n      <Typography.Text css={{ marginBottom: 16 }} color=\"secondary\">\n        <FormattedMessage\n          defaultMessage=\"Use other parameters or disable run grouping to continue.\"\n          description=\"Experiment page > compare runs > parallel coordinates chart > unsupported string values warning > description\"\n        />\n      </Typography.Text>\n    </div>\n  </div>\n);\n\nexport const RunsChartsParallelChartCard = ({\n  config,\n  chartRunData,\n  onDelete,\n  onEdit,\n  onReorderWith,\n  canMoveDown,\n  canMoveUp,\n  onMoveDown,\n  onMoveUp,\n  groupBy,\n  fullScreen,\n  setFullScreenChart,\n}: RunsChartsParallelChartCardProps) => {\n  const updateUIState = useUpdateExperimentViewUIState();\n\n  const toggleFullScreenChart = () => {\n    setFullScreenChart?.({\n      config,\n      title: 'Parallel Coordinates',\n      subtitle: displaySubtitle ? subtitle : null,\n    });\n  };\n\n  const configuredChartRunData = useMemo(() => {\n    if (!shouldUseNewRunRowsVisibilityModel() || config?.showAllRuns) {\n      return chartRunData;\n    }\n    return chartRunData?.filter(({ hidden }) => !hidden);\n  }, [chartRunData, config?.showAllRuns]);\n\n  const containsStringValues = useMemo(\n    () =>\n      config.selectedParams?.some(\n        (paramKey) => configuredChartRunData?.some((dataTrace) => isNaN(Number(dataTrace.params[paramKey]?.value))),\n        [config.selectedParams, configuredChartRunData],\n      ),\n    [config.selectedParams, configuredChartRunData],\n  );\n\n  const updateVisibleOnlySetting = useCallback(\n    (showAllRuns: boolean) => {\n      updateUIState((state) => {\n        const newCompareRunCharts = state.compareRunCharts?.map((existingChartConfig) => {\n          if (existingChartConfig.uuid === config.uuid) {\n            const parallelChartConfig = existingChartConfig as RunsChartsParallelCardConfig;\n            return { ...parallelChartConfig, showAllRuns };\n          }\n          return existingChartConfig;\n        });\n\n        return { ...state, compareRunCharts: newCompareRunCharts };\n      });\n    },\n    [config.uuid, updateUIState],\n  );\n\n  const [isConfigured, parallelCoordsData] = useMemo(() => {\n    const selectedParamsCount = config.selectedParams?.length || 0;\n    const selectedMetricsCount = config.selectedMetrics?.length || 0;\n\n    const configured = selectedParamsCount + selectedMetricsCount >= 2;\n\n    // Prepare the data in the parcoord-es format\n    const data = configured\n      ? processParallelCoordinateData(configuredChartRunData, config.selectedParams, config.selectedMetrics)\n      : [];\n\n    return [configured, data];\n  }, [config, configuredChartRunData]);\n\n  const { elementRef, isInViewport } = useIsInViewport();\n\n  const { setTooltip, resetTooltip, selectedRunUuid, closeContextMenu } = useRunsChartsTooltip(config);\n\n  const containsUnsupportedValues = containsStringValues && groupBy;\n  const displaySubtitle = isConfigured && !containsUnsupportedValues;\n\n  const subtitle = shouldUseNewRunRowsVisibilityModel() ? (\n    <>\n      {config.showAllRuns ? (\n        <FormattedMessage\n          defaultMessage=\"Showing all runs\"\n          description=\"Experiment page > compare runs > parallel chart > header > indicator for all runs shown\"\n        />\n      ) : (\n        <FormattedMessage\n          defaultMessage=\"Showing only visible runs\"\n          description=\"Experiment page > compare runs > parallel chart > header > indicator for only visible runs shown\"\n        />\n      )}\n    </>\n  ) : (\n    <>Comparing {parallelCoordsData.length} runs</>\n  );\n\n  const chartBody = (\n    <>\n      {!isConfigured ? (\n        <EmptyParallelCoordsPlaceholder onEdit={onEdit} />\n      ) : containsUnsupportedValues ? (\n        <UnsupportedDataPlaceholder />\n      ) : parallelCoordsData.length ? (\n        // Avoid displaying empty set, otherwise parcoord-es goes crazy\n        <div\n          css={[\n            styles.parallelChartCardWrapper,\n            {\n              height: fullScreen ? '100%' : undefined,\n            },\n          ]}\n          ref={elementRef}\n        >\n          {isInViewport ? (\n            <LazyParallelCoordinatesPlot\n              data={parallelCoordsData}\n              selectedParams={config.selectedParams}\n              selectedMetrics={config.selectedMetrics}\n              onHover={setTooltip}\n              onUnhover={resetTooltip}\n              axesRotateThreshold={8}\n              selectedRunUuid={selectedRunUuid}\n              closeContextMenu={closeContextMenu}\n            />\n          ) : null}\n        </div>\n      ) : null}\n    </>\n  );\n\n  if (fullScreen) {\n    return chartBody;\n  }\n\n  return (\n    <RunsChartCardWrapper\n      onEdit={onEdit}\n      onDelete={onDelete}\n      title=\"Parallel Coordinates\"\n      subtitle={displaySubtitle ? subtitle : null}\n      uuid={config.uuid}\n      tooltip=\"The Parallel Coordinates Chart now only shows runs with columns that are either numbers or strings. If a column has string entries, the runs corresponding to the 30 most recent unique values will be shown.\"\n      dragGroupKey={RunsChartsChartsDragGroup.PARALLEL_CHARTS_AREA}\n      onReorderWith={onReorderWith}\n      canMoveDown={canMoveDown}\n      canMoveUp={canMoveUp}\n      onMoveDown={onMoveDown}\n      onMoveUp={onMoveUp}\n      toggleFullScreenChart={isConfigured && !containsUnsupportedValues ? toggleFullScreenChart : undefined}\n      additionalMenuContent={\n        shouldUseNewRunRowsVisibilityModel() ? (\n          <>\n            <DropdownMenu.Separator />\n            <DropdownMenu.CheckboxItem checked={!config.showAllRuns} onClick={() => updateVisibleOnlySetting(false)}>\n              <DropdownMenu.ItemIndicator />\n              <FormattedMessage\n                defaultMessage=\"Show only visible\"\n                description=\"Experiment page > compare runs tab > chart header > move down option\"\n              />\n            </DropdownMenu.CheckboxItem>\n            <DropdownMenu.CheckboxItem checked={config.showAllRuns} onClick={() => updateVisibleOnlySetting(true)}>\n              <DropdownMenu.ItemIndicator />\n              <FormattedMessage\n                defaultMessage=\"Show all runs\"\n                description=\"Experiment page > compare runs tab > chart header > move down option\"\n              />\n            </DropdownMenu.CheckboxItem>\n          </>\n        ) : null\n      }\n      supportedDownloadFormats={['csv']}\n      onClickDownload={(format) => {\n        const savedChartTitle = [...config.selectedMetrics, ...config.selectedParams].join('-');\n\n        if (format === 'csv') {\n          downloadChartDataCsv(configuredChartRunData, config.selectedMetrics, config.selectedParams, savedChartTitle);\n        }\n      }}\n    >\n      {chartBody}\n    </RunsChartCardWrapper>\n  );\n};\n\nconst styles = {\n  parallelChartCardWrapper: {\n    // Set \"display: flex\" here (and \"flex: 1\" in the child element)\n    // so the chart will grow in width and height\n    display: 'flex',\n    overflow: 'hidden',\n    cursor: 'pointer',\n  },\n};\n","import { useCallback, useMemo } from 'react';\nimport type { RunsChartsRunData } from '../RunsCharts.common';\nimport {\n  DISABLED_GROUP_WHEN_GROUPBY,\n  DifferenceCardConfigCompareGroup,\n  type RunsChartsCardConfig,\n  type RunsChartsDifferenceCardConfig,\n} from '../../runs-charts.types';\nimport {\n  type RunsChartCardReorderProps,\n  RunsChartCardWrapper,\n  RunsChartsChartsDragGroup,\n  RunsChartCardFullScreenProps,\n  ChartRunsCountIndicator,\n} from './ChartCard.common';\nimport { shouldUseNewRunRowsVisibilityModel } from '../../../../../common/utils/FeatureUtils';\nimport { DifferenceViewPlot } from '../charts/DifferenceViewPlot';\nimport { useConfirmChartCardConfigurationFn } from '../../hooks/useRunsChartsUIConfiguration';\nimport { useIntl, FormattedMessage } from 'react-intl';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\n\nexport interface RunsChartsDifferenceChartCardProps extends RunsChartCardReorderProps, RunsChartCardFullScreenProps {\n  config: RunsChartsDifferenceCardConfig;\n  chartRunData: RunsChartsRunData[];\n\n  onDelete: () => void;\n  onEdit: () => void;\n  groupBy: RunsGroupByConfig | null;\n}\n\nexport const RunsChartsDifferenceChartCard = ({\n  config,\n  chartRunData,\n  onDelete,\n  onEdit,\n  onReorderWith,\n  canMoveDown,\n  canMoveUp,\n  onMoveDown,\n  onMoveUp,\n  groupBy,\n  fullScreen,\n  setFullScreenChart,\n}: RunsChartsDifferenceChartCardProps) => {\n  const toggleFullScreenChart = () => {\n    setFullScreenChart?.({\n      config,\n      title: config.chartName,\n      subtitle: <ChartRunsCountIndicator runsOrGroups={chartRunData} />,\n    });\n  };\n\n  const slicedRuns = useMemo(() => {\n    if (shouldUseNewRunRowsVisibilityModel()) {\n      return chartRunData.filter(({ hidden }) => !hidden).reverse();\n    }\n    return chartRunData.slice(0, config.runsCountToCompare || 10).reverse();\n  }, [chartRunData, config]);\n\n  const confirmChartCardConfiguration = useConfirmChartCardConfigurationFn();\n\n  const setCardConfig = (setter: (current: RunsChartsCardConfig) => RunsChartsDifferenceCardConfig) => {\n    confirmChartCardConfiguration(setter(config));\n  };\n\n  const showChangeFromBaselineToggle = useCallback(() => {\n    confirmChartCardConfiguration({\n      ...config,\n      showChangeFromBaseline: !config.showChangeFromBaseline,\n    } as RunsChartsCardConfig);\n  }, [config, confirmChartCardConfiguration]);\n\n  const showDifferencesOnlyToggle = useCallback(() => {\n    confirmChartCardConfiguration({\n      ...config,\n      showDifferencesOnly: !config.showDifferencesOnly,\n    } as RunsChartsCardConfig);\n  }, [config, confirmChartCardConfiguration]);\n\n  const { formatMessage } = useIntl();\n\n  const chartBody = (\n    <div\n      css={{\n        display: 'flex',\n        overflow: 'auto hidden',\n        cursor: 'pointer',\n        height: fullScreen ? '100%' : undefined,\n        width: '100%',\n      }}\n    >\n      <div css={{ width: '100%' }}>\n        <DifferenceViewPlot\n          previewData={slicedRuns}\n          groupBy={groupBy}\n          cardConfig={config}\n          setCardConfig={setCardConfig}\n        />\n      </div>\n    </div>\n  );\n\n  let showTooltip = undefined;\n  if (groupBy && DISABLED_GROUP_WHEN_GROUPBY.some((group) => config.compareGroups.includes(group))) {\n    showTooltip = formatMessage({\n      defaultMessage: 'Disable grouped runs to compare parameters, tag, or attributes',\n      description:\n        'Experiment tracking > runs charts > cards > RunsChartsDifferenceChartCard > disable group runs tooltip message',\n    });\n  }\n  if (fullScreen) {\n    return chartBody;\n  }\n\n  return (\n    <RunsChartCardWrapper\n      onEdit={onEdit}\n      onDelete={onDelete}\n      title={config.chartName}\n      subtitle={<ChartRunsCountIndicator runsOrGroups={slicedRuns} />}\n      uuid={config.uuid}\n      dragGroupKey={RunsChartsChartsDragGroup.GENERAL_AREA}\n      onReorderWith={onReorderWith}\n      canMoveDown={canMoveDown}\n      canMoveUp={canMoveUp}\n      onMoveDown={onMoveDown}\n      onMoveUp={onMoveUp}\n      toggleFullScreenChart={toggleFullScreenChart}\n      toggles={[\n        {\n          toggleLabel: formatMessage({\n            defaultMessage: 'Show change from baseline',\n            description:\n              'Runs charts > components > cards > RunsChartsDifferenceChartCard > Show change from baseline toggle label',\n          }),\n          currentToggle: config.showChangeFromBaseline,\n          setToggle: showChangeFromBaselineToggle,\n        },\n        {\n          toggleLabel: formatMessage({\n            defaultMessage: 'Show differences only',\n            description:\n              'Runs charts > components > cards > RunsChartsDifferenceChartCard > Show differences only toggle label',\n          }),\n          currentToggle: config.showDifferencesOnly,\n          setToggle: showDifferencesOnlyToggle,\n        },\n      ]}\n      tooltip={showTooltip}\n    >\n      {chartBody}\n    </RunsChartCardWrapper>\n  );\n};\n","import { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport type { RunsChartsRunData } from '../RunsCharts.common';\nimport {\n  type RunsChartCardReorderProps,\n  RunsChartCardWrapper,\n  RunsChartsChartsDragGroup,\n  RunsChartCardFullScreenProps,\n  ChartRunsCountIndicator,\n} from './ChartCard.common';\nimport { shouldUseNewRunRowsVisibilityModel } from '../../../../../common/utils/FeatureUtils';\nimport { DifferenceViewPlot } from '../charts/DifferenceViewPlot';\nimport { useConfirmChartCardConfigurationFn } from '../../hooks/useRunsChartsUIConfiguration';\nimport { useIntl, FormattedMessage } from 'react-intl';\nimport { RunsChartsCardConfig, RunsChartsImageCardConfig } from '../../runs-charts.types';\nimport { ImageGridPlot } from '../charts/ImageGridPlot';\nimport { useDesignSystemTheme } from '@databricks/design-system';\nimport { useImageSliderStepMarks } from '../../hooks/useImageSliderStepMarks';\nimport {\n  DEFAULT_IMAGE_GRID_CHART_NAME,\n  LOG_IMAGE_TAG_INDICATOR,\n  NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE,\n} from 'experiment-tracking/constants';\nimport { LineSmoothSlider } from 'experiment-tracking/components/LineSmoothSlider';\nimport { RunsGroupByConfig } from 'experiment-tracking/components/experiment-page/utils/experimentPage.group-row-utils';\n\nexport interface RunsChartsImageChartCardProps extends RunsChartCardReorderProps, RunsChartCardFullScreenProps {\n  config: RunsChartsImageCardConfig;\n  chartRunData: RunsChartsRunData[];\n\n  onDelete: () => void;\n  onEdit: () => void;\n  groupBy: RunsGroupByConfig | null;\n}\n\nexport const RunsChartsImageChartCard = ({\n  config,\n  chartRunData,\n  onDelete,\n  onEdit,\n  onReorderWith,\n  canMoveDown,\n  canMoveUp,\n  onMoveDown,\n  onMoveUp,\n  groupBy,\n  fullScreen,\n  setFullScreenChart,\n}: RunsChartsImageChartCardProps) => {\n  const { theme } = useDesignSystemTheme();\n  const containerRef = useRef(null);\n  const [containerWidth, setContainerWidth] = useState(0);\n\n  useEffect(() => {\n    const resizeObserver = new ResizeObserver((entries) => {\n      setContainerWidth(entries[0].contentRect.width);\n    });\n    if (containerRef.current) {\n      resizeObserver.observe(containerRef.current);\n    }\n    return () => {\n      resizeObserver.disconnect();\n    };\n  }, [containerRef]);\n\n  // Optimizations for smoother slider experience. Maintain a local copy of config, and update\n  // the global state only after the user has finished dragging the slider.\n  const [tmpConfig, setTmpConfig] = useState(config);\n  const confirmChartCardConfiguration = useConfirmChartCardConfigurationFn();\n  const updateStep = useCallback(\n    (step: number) => {\n      confirmChartCardConfiguration({ ...config, step } as RunsChartsImageCardConfig);\n    },\n    [config, confirmChartCardConfiguration],\n  );\n  const tmpStepChange = (step: number) => {\n    setTmpConfig((conf) => ({ ...conf, step }));\n  };\n\n  const chartName = config.imageKeys.length === 1 ? config.imageKeys[0] : DEFAULT_IMAGE_GRID_CHART_NAME;\n\n  const toggleFullScreenChart = () => {\n    setFullScreenChart?.({\n      config,\n      title: chartName,\n      subtitle: <ChartRunsCountIndicator runsOrGroups={chartRunData} />,\n    });\n  };\n\n  const slicedRuns = useMemo(() => {\n    if (shouldUseNewRunRowsVisibilityModel()) {\n      return chartRunData.filter(({ hidden }) => !hidden).reverse();\n    }\n    return chartRunData.slice(0, config.runsCountToCompare || 10).reverse();\n  }, [chartRunData, config]);\n\n  const setCardConfig = (setter: (current: RunsChartsCardConfig) => RunsChartsImageCardConfig) => {\n    confirmChartCardConfiguration(setter(config));\n  };\n\n  const { stepMarks, maxMark, minMark } = useImageSliderStepMarks({\n    data: slicedRuns,\n    selectedImageKeys: config.imageKeys || [],\n  });\n\n  const stepMarkLength = Object.keys(stepMarks).length;\n\n  useEffect(() => {\n    // If there is only one step mark, set the step to the min mark\n    if (stepMarkLength === 1 && tmpConfig.step !== minMark) {\n      updateStep(minMark);\n    }\n  }, [minMark, stepMarkLength, tmpConfig.step, updateStep]);\n\n  const shouldDisplayImageLimitIndicator =\n    slicedRuns.filter((run) => {\n      return run.tags[LOG_IMAGE_TAG_INDICATOR];\n    }).length > NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE;\n\n  const chartBody = (\n    <div\n      css={{\n        display: 'flex',\n        flexDirection: 'column',\n        height: fullScreen ? '100%' : undefined,\n        width: '100%',\n        overflow: 'auto',\n      }}\n    >\n      <div\n        ref={containerRef}\n        css={{\n          cursor: 'pointer',\n          height: `calc(100% - ${theme.spacing.md * 2}px)`,\n          overflow: 'auto',\n        }}\n      >\n        <ImageGridPlot\n          previewData={slicedRuns}\n          groupBy={groupBy}\n          cardConfig={tmpConfig}\n          setCardConfig={setCardConfig}\n          containerWidth={containerWidth}\n        />\n      </div>\n      <div\n        css={{\n          justifyContent: 'center',\n          alignItems: 'center',\n          display: 'inline-flex',\n          gap: theme.spacing.md,\n        }}\n      >\n        <div css={{ width: '350px' }}>\n          <LineSmoothSlider\n            defaultValue={tmpConfig.step}\n            onChange={tmpStepChange}\n            max={maxMark}\n            min={minMark}\n            marks={stepMarks}\n            step={null}\n            disabled={Object.keys(stepMarks).length <= 1}\n            onAfterChange={updateStep}\n          />\n        </div>\n      </div>\n    </div>\n  );\n\n  if (fullScreen) {\n    return chartBody;\n  }\n\n  return (\n    <RunsChartCardWrapper\n      onEdit={onEdit}\n      onDelete={onDelete}\n      title={chartName}\n      subtitle={\n        shouldDisplayImageLimitIndicator && `Displaying images from first ${NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE} runs`\n      }\n      uuid={config.uuid}\n      dragGroupKey={RunsChartsChartsDragGroup.GENERAL_AREA}\n      onReorderWith={onReorderWith}\n      canMoveDown={canMoveDown}\n      canMoveUp={canMoveUp}\n      onMoveDown={onMoveDown}\n      onMoveUp={onMoveUp}\n      toggleFullScreenChart={toggleFullScreenChart}\n    >\n      {chartBody}\n    </RunsChartCardWrapper>\n  );\n};\n","import { useMemo } from 'react';\nimport { RunsChartType } from '../../runs-charts.types';\nimport type {\n  RunsChartsBarCardConfig,\n  RunsChartsCardConfig,\n  RunsChartsContourCardConfig,\n  RunsChartsDifferenceCardConfig,\n  RunsChartsImageCardConfig,\n  RunsChartsLineCardConfig,\n  RunsChartsParallelCardConfig,\n  RunsChartsScatterCardConfig,\n} from '../../runs-charts.types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport {\n  shouldEnableDifferenceViewCharts,\n  shouldEnableImageGridCharts,\n  shouldUseNewRunRowsVisibilityModel,\n} from '../../../../../common/utils/FeatureUtils';\nimport { RunsChartsBarChartCard } from './RunsChartsBarChartCard';\nimport { RunsChartsLineChartCard } from './RunsChartsLineChartCard';\nimport { RunsChartsScatterChartCard } from './RunsChartsScatterChartCard';\nimport { RunsChartsContourChartCard } from './RunsChartsContourChartCard';\nimport { RunsChartsParallelChartCard } from './RunsChartsParallelChartCard';\nimport { RunsChartCardFullScreenProps, RunsChartCardReorderProps } from './ChartCard.common';\nimport { RunsChartsDifferenceChartCard } from './RunsChartsDifferenceChartCard';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\nimport { RunsChartsImageChartCard } from './RunsChartsImageChartCard';\n\nexport interface RunsChartsCardProps extends RunsChartCardReorderProps, RunsChartCardFullScreenProps {\n  cardConfig: RunsChartsCardConfig;\n  chartRunData: RunsChartsRunData[];\n  onStartEditChart: (chart: RunsChartsCardConfig) => void;\n  onRemoveChart: (chart: RunsChartsCardConfig) => void;\n  onReorderCharts: (sourceChartUuid: string, targetChartUuid: string) => void;\n  onDownloadFullMetricHistoryCsv?: (runUuids: string[], metricKeys: string[]) => void;\n  index: number;\n  sectionIndex: number;\n  autoRefreshEnabled?: boolean;\n  groupBy: RunsGroupByConfig | null;\n}\n\nexport const RunsChartsCard = ({\n  cardConfig,\n  chartRunData,\n  index,\n  sectionIndex,\n  onStartEditChart,\n  onRemoveChart,\n  setFullScreenChart,\n  groupBy,\n  fullScreen,\n  canMoveDown,\n  canMoveUp,\n  onMoveDown,\n  onMoveUp,\n  onReorderWith,\n  autoRefreshEnabled,\n  onDownloadFullMetricHistoryCsv,\n}: RunsChartsCardProps) => {\n  const chartElementKey = `${cardConfig.uuid}-${index}-${sectionIndex}`;\n\n  const reorderProps = {\n    onReorderWith,\n    canMoveDown,\n    canMoveUp,\n    onMoveDown,\n    onMoveUp,\n  };\n\n  const editProps = {\n    onEdit: () => onStartEditChart(cardConfig),\n    onDelete: () => onRemoveChart(cardConfig),\n    setFullScreenChart,\n  };\n\n  const commonChartProps = {\n    fullScreen,\n    key: chartElementKey,\n    autoRefreshEnabled,\n    groupBy,\n    ...editProps,\n    ...reorderProps,\n  };\n\n  const slicedRuns = useMemo(() => {\n    if (shouldUseNewRunRowsVisibilityModel()) {\n      return chartRunData.filter(({ hidden }) => !hidden).reverse();\n    }\n    return chartRunData.slice(0, cardConfig.runsCountToCompare || 10).reverse();\n  }, [chartRunData, cardConfig]);\n\n  if (cardConfig.type === RunsChartType.PARALLEL) {\n    return (\n      <RunsChartsParallelChartCard\n        config={cardConfig as RunsChartsParallelCardConfig}\n        chartRunData={chartRunData}\n        {...commonChartProps}\n      />\n    );\n  }\n\n  if (shouldEnableDifferenceViewCharts() && cardConfig.type === RunsChartType.DIFFERENCE) {\n    return (\n      <RunsChartsDifferenceChartCard\n        config={cardConfig as RunsChartsDifferenceCardConfig}\n        chartRunData={chartRunData}\n        {...commonChartProps}\n      />\n    );\n  }\n\n  if (shouldEnableImageGridCharts() && cardConfig.type === RunsChartType.IMAGE) {\n    return (\n      <RunsChartsImageChartCard\n        config={cardConfig as RunsChartsImageCardConfig}\n        chartRunData={chartRunData}\n        {...commonChartProps}\n      />\n    );\n  }\n\n  if (cardConfig.type === RunsChartType.BAR) {\n    return (\n      <RunsChartsBarChartCard\n        config={cardConfig as RunsChartsBarCardConfig}\n        chartRunData={slicedRuns}\n        {...commonChartProps}\n      />\n    );\n  } else if (cardConfig.type === RunsChartType.LINE) {\n    return (\n      <RunsChartsLineChartCard\n        config={cardConfig as RunsChartsLineCardConfig}\n        chartRunData={slicedRuns}\n        onDownloadFullMetricHistoryCsv={onDownloadFullMetricHistoryCsv}\n        {...commonChartProps}\n      />\n    );\n  } else if (cardConfig.type === RunsChartType.SCATTER) {\n    return (\n      <RunsChartsScatterChartCard\n        config={cardConfig as RunsChartsScatterCardConfig}\n        chartRunData={slicedRuns}\n        {...commonChartProps}\n      />\n    );\n  } else if (cardConfig.type === RunsChartType.CONTOUR) {\n    return (\n      <RunsChartsContourChartCard\n        config={cardConfig as RunsChartsContourCardConfig}\n        chartRunData={slicedRuns}\n        {...commonChartProps}\n      />\n    );\n  }\n  return null;\n};\n","import { MLFLOW_SYSTEM_METRIC_PREFIX } from 'experiment-tracking/constants';\nimport { KeyValueEntity, MetricEntitiesByName } from 'experiment-tracking/types';\nimport { useCallback, useMemo } from 'react';\nimport { RunsChartsRunData } from '../components/RunsCharts.common';\nimport { DifferenceCardAttributes, RunsChartsDifferenceCardConfig } from '../runs-charts.types';\nimport Utils from 'common/utils/Utils';\nimport { Run } from 'experiment-tracking/sdk/MlflowMessages';\nimport type { RunsGroupByConfig } from '../../experiment-page/utils/experimentPage.group-row-utils';\n\nconst DEFAULT_EMPTY_VALUE = '-';\nconst DIFFERENCE_EPSILON = 1e-6;\nexport const getFixedPointValue = (val: string | number, places = 2) =>\n  typeof val === 'number' ? val.toFixed(places) : val;\n\nexport const differenceView = (a: string | number, b: string | number) => {\n  if (typeof a === 'string' || typeof b === 'string') {\n    return undefined;\n  } else {\n    const diff = a - b;\n    if (diff >= 0) {\n      return `+${getFixedPointValue(diff)}`;\n    } else {\n      return getFixedPointValue(diff).toString();\n    }\n  }\n};\n\nexport const isDifferent = (a: string | number, b: string | number) => {\n  if (a === DEFAULT_EMPTY_VALUE || b === DEFAULT_EMPTY_VALUE) {\n    return false;\n  }\n  // Check if type a and b are the same\n  if (typeof a !== typeof b) {\n    return true;\n  } else if (typeof a === 'number' && typeof b === 'number') {\n    return Math.abs(a - b) > DIFFERENCE_EPSILON;\n  } else if (typeof a === 'string' && typeof b === 'string') {\n    return a !== b;\n  }\n  return false;\n};\n\nexport const getDifferenceViewDataGroups = (\n  previewData: RunsChartsRunData[],\n  cardConfig: RunsChartsDifferenceCardConfig,\n  headingColumnId: string,\n  groupBy: RunsGroupByConfig | null,\n) => {\n  const getMetrics = (\n    filterCondition: (metric: string) => boolean,\n    runDataKeys: (data: RunsChartsRunData) => string[],\n    runDataAttribute: (\n      data: RunsChartsRunData,\n    ) =>\n      | MetricEntitiesByName\n      | Record<string, KeyValueEntity>\n      | Record<string, { key: string; value: string | number }>,\n  ) => {\n    // Get array of sorted keys\n    const keys = Array.from(new Set(previewData.flatMap((runData) => runDataKeys(runData))))\n      .filter((key) => filterCondition(key))\n      .sort();\n    const values = keys.flatMap((key: string) => {\n      const data: Record<string, string | number> = {};\n      let hasDifference = false;\n\n      previewData.forEach((runData, index) => {\n        // Set the key as runData.uuid and the value as the metric's value or DEFAULT_EMPTY_VALUE\n        data[runData.uuid] = runDataAttribute(runData)[key]\n          ? runDataAttribute(runData)[key].value\n          : DEFAULT_EMPTY_VALUE;\n        if (index > 0) {\n          const prev = previewData[index - 1];\n          if (isDifferent(data[prev.uuid], data[runData.uuid])) {\n            hasDifference = true;\n          }\n        }\n      });\n      if (cardConfig.showDifferencesOnly && !hasDifference) {\n        return [];\n      }\n      return [\n        {\n          [headingColumnId]: key,\n          ...data,\n        },\n      ];\n    });\n    return values;\n  };\n\n  const modelMetrics = getMetrics(\n    (metric: string) => !metric.startsWith(MLFLOW_SYSTEM_METRIC_PREFIX),\n    (runData: RunsChartsRunData) => Object.keys(runData.metrics),\n    (runData: RunsChartsRunData) => runData.metrics,\n  );\n\n  const systemMetrics = getMetrics(\n    (metric: string) => metric.startsWith(MLFLOW_SYSTEM_METRIC_PREFIX),\n    (runData: RunsChartsRunData) => Object.keys(runData.metrics),\n    (runData: RunsChartsRunData) => runData.metrics,\n  );\n\n  if (groupBy) {\n    return { modelMetrics, systemMetrics, parameters: [], tags: [], attributes: [] };\n  }\n\n  const parameters = getMetrics(\n    () => true,\n    (runData: RunsChartsRunData) => Object.keys(runData.params),\n    (runData: RunsChartsRunData) => runData.params,\n  );\n\n  const tags = getMetrics(\n    () => true,\n    (runData: RunsChartsRunData) => Utils.getVisibleTagValues(runData.tags).map(([key]) => key),\n    (runData: RunsChartsRunData) => runData.tags,\n  );\n\n  // Get attributes\n  const attributeGroups = [\n    DifferenceCardAttributes.USER,\n    DifferenceCardAttributes.SOURCE,\n    DifferenceCardAttributes.VERSION,\n    DifferenceCardAttributes.MODELS,\n  ];\n  const attributes = attributeGroups.flatMap((attribute) => {\n    const attributeData: Record<string, string | number> = {};\n    let hasDifference = false;\n    previewData.forEach((runData, index) => {\n      if (attribute === DifferenceCardAttributes.USER) {\n        const user = Utils.getUser(runData.runInfo, runData.tags);\n        attributeData[runData.uuid] = user;\n      } else if (attribute === DifferenceCardAttributes.SOURCE) {\n        const source = Utils.getSourceName(runData.tags);\n        attributeData[runData.uuid] = source;\n      } else if (attribute === DifferenceCardAttributes.VERSION) {\n        const version = Utils.getSourceVersion(runData.tags);\n        attributeData[runData.uuid] = version;\n      } else {\n        const models = Utils.getLoggedModelsFromTags(runData.tags);\n        attributeData[runData.uuid] = models.join(',');\n      }\n      if (index > 0) {\n        const prev = previewData[index - 1];\n        if (isDifferent(attributeData[prev.uuid], attributeData[runData.uuid])) {\n          hasDifference = true;\n        }\n      }\n    });\n    if (cardConfig.showDifferencesOnly && !hasDifference) {\n      return [];\n    }\n    return [\n      {\n        [headingColumnId]: attribute,\n        ...attributeData,\n      },\n    ];\n  });\n  return { modelMetrics, systemMetrics, parameters, tags, attributes };\n};\n","import { ExperimentRunsSelectorResult } from 'experiment-tracking/components/experiment-page/utils/experimentRuns.selector';\nimport {\n  DifferenceCardAttributes,\n  DifferenceCardConfigCompareGroup,\n  RunsChartsCardConfig,\n  RunsChartsDifferenceCardConfig,\n} from '../../runs-charts.types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { ReactChild, ReactFragment, ReactPortal, useCallback, useMemo, useState } from 'react';\nimport { MLFLOW_SYSTEM_METRIC_PREFIX } from 'experiment-tracking/constants';\nimport { ColumnDef, flexRender, getCoreRowModel, useReactTable } from '@tanstack/react-table';\nimport {\n  Table,\n  TableCell,\n  TableHeader,\n  TableRow,\n  useDesignSystemTheme,\n  Typography,\n  Tag,\n  Tooltip,\n} from '@databricks/design-system';\nimport { RunColorPill } from 'experiment-tracking/components/experiment-page/components/RunColorPill';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { MetricEntitiesByName } from 'experiment-tracking/types';\nimport { differenceView, getDifferenceViewDataGroups, getFixedPointValue } from '../../utils/differenceView';\nimport { OverflowIcon, Button, DropdownMenu } from '@databricks/design-system';\nimport Utils from 'common/utils/Utils';\nimport { TableSkeletonRows } from '@databricks/design-system';\nimport { ArrowUpIcon } from '@databricks/design-system';\nimport { ArrowDownIcon } from '@databricks/design-system';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\n\nconst HEADING_COLUMN_ID = 'headingColumn';\nconst COLUMN_WIDTH = 200;\n\nexport const DifferenceViewPlot = ({\n  previewData,\n  cardConfig,\n  groupBy,\n  setCardConfig,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsDifferenceCardConfig;\n  groupBy: RunsGroupByConfig | null;\n  setCardConfig?: (setter: (current: RunsChartsCardConfig) => RunsChartsDifferenceCardConfig) => void;\n}) => {\n  const { formatMessage } = useIntl();\n  const { theme } = useDesignSystemTheme();\n\n  const { modelMetrics, systemMetrics, parameters, tags, attributes } = useMemo(\n    () => getDifferenceViewDataGroups(previewData, cardConfig, HEADING_COLUMN_ID, groupBy),\n    [previewData, cardConfig, groupBy],\n  );\n  // Each metric/param is a row in the table\n  const getData = [\n    ...(cardConfig.compareGroups.includes(DifferenceCardConfigCompareGroup.MODEL_METRICS) ? modelMetrics : []),\n    ...(cardConfig.compareGroups.includes(DifferenceCardConfigCompareGroup.SYSTEM_METRICS) ? systemMetrics : []),\n    ...(cardConfig.compareGroups.includes(DifferenceCardConfigCompareGroup.PARAMETERS) ? parameters : []),\n    ...(cardConfig.compareGroups.includes(DifferenceCardConfigCompareGroup.ATTRIBUTES) ? attributes : []),\n    ...(cardConfig.compareGroups.includes(DifferenceCardConfigCompareGroup.TAGS) ? tags : []),\n  ];\n\n  const { baselineColumn, nonBaselineColumns } = useMemo(() => {\n    // baseline column (can be undefined if no baseline selected)\n    let baselineColumn = previewData.find((runData) => runData.uuid === cardConfig.baselineColumnUuid);\n    if (baselineColumn === undefined && previewData.length > 0) {\n      // Set the first column as baseline column\n      baselineColumn = previewData[0];\n    }\n    // non-baseline columns\n    const nonBaselineColumns = previewData.filter(\n      (runData) => baselineColumn === undefined || runData.uuid !== baselineColumn.uuid,\n    );\n\n    return { baselineColumn, nonBaselineColumns };\n  }, [previewData, cardConfig.baselineColumnUuid]);\n\n  // Split columns into baseline/non-baseline\n  const getColumns = useMemo(() => {\n    const convertRunToColumnInfo = (runData: RunsChartsRunData, isBaseline: boolean) => {\n      const accessorFn = (row: Record<string, string | number>) => {\n        return {\n          text: row[runData.uuid],\n          difference: baselineColumn ? differenceView(row[runData.uuid], row[baselineColumn.uuid]) : null,\n        };\n      };\n\n      const baselineAccessorFn = (row: Record<string, string | number>) => {\n        return row[runData.uuid];\n      };\n      if (isBaseline) {\n        return {\n          id: runData.uuid,\n          header: () => {\n            return (\n              <span css={{ display: 'flex', flexDirection: 'row', justifyContent: 'space-between' }}>\n                <span css={{ display: 'inline-flex', gap: theme.spacing.sm, alignItems: 'center' }}>\n                  <RunColorPill color={runData.color} />\n                  {runData.displayName}\n                  <Tag css={{ margin: 0 }}>\n                    <FormattedMessage\n                      defaultMessage=\"baseline\"\n                      description=\"Runs charts > components > charts > DifferenceViewPlot > baseline tag\"\n                    />\n                  </Tag>\n                </span>\n              </span>\n            );\n          },\n          size: COLUMN_WIDTH,\n          accessorFn: baselineAccessorFn,\n          cell: (row: any) => <span>{getFixedPointValue(row.getValue())}</span>,\n        };\n      }\n      return {\n        id: runData.uuid,\n        header: () => {\n          return (\n            <span css={{ display: 'flex', flexDirection: 'row', justifyContent: 'space-between' }}>\n              <span css={{ display: 'inline-flex', gap: theme.spacing.sm, alignItems: 'center' }}>\n                <RunColorPill color={runData.color} />\n                {runData.displayName}\n              </span>\n            </span>\n          );\n        },\n        size: COLUMN_WIDTH,\n        accessorFn: accessorFn,\n        cell: (row: any) => (\n          <span css={{ display: 'inline-flex', gap: theme.spacing.md, verticalAlign: 'middle' }}>\n            <Typography.Text>{getFixedPointValue(row.getValue().text)}</Typography.Text>\n            {baselineColumn &&\n              cardConfig.showChangeFromBaseline &&\n              row.getValue().difference &&\n              (row.getValue().difference[0] === '-' ? (\n                <div css={{ display: 'inline-flex', gap: theme.spacing.xs }}>\n                  <Typography.Paragraph color=\"error\">{row.getValue().difference}</Typography.Paragraph>\n                  <ArrowDownIcon color=\"danger\" />\n                </div>\n              ) : (\n                <div css={{ display: 'inline-flex', gap: theme.spacing.xs }}>\n                  <Typography.Paragraph color=\"success\">{row.getValue().difference}</Typography.Paragraph>\n                  <ArrowUpIcon color=\"success\" />\n                </div>\n              ))}\n          </span>\n        ),\n      };\n    };\n\n    return [\n      {\n        id: HEADING_COLUMN_ID,\n        header: formatMessage({\n          defaultMessage: 'Compare by',\n          description: 'Runs charts > components > charts > DifferenceViewPlot > Compare by column heading',\n        }),\n        accessorKey: HEADING_COLUMN_ID,\n        size: COLUMN_WIDTH,\n      },\n      ...(baselineColumn ? [convertRunToColumnInfo(baselineColumn, true)] : []),\n      ...nonBaselineColumns.map((runData) => convertRunToColumnInfo(runData, false)),\n    ];\n  }, [theme.spacing, formatMessage, baselineColumn, nonBaselineColumns, cardConfig.showChangeFromBaseline]);\n\n  const table = useReactTable({\n    data: getData,\n    columns: getColumns,\n    enableColumnResizing: true,\n    columnResizeMode: 'onChange',\n    getCoreRowModel: getCoreRowModel(),\n  });\n\n  const updateBaselineColumnUuid = useCallback(\n    (baselineColumnUuid: string) => {\n      if (setCardConfig) {\n        setCardConfig((current) => ({\n          ...(current as RunsChartsDifferenceCardConfig),\n          baselineColumnUuid,\n        }));\n      }\n    },\n    [setCardConfig],\n  );\n\n  if (previewData.length === 0) {\n    return null;\n  }\n\n  return (\n    <Table style={{ width: table.getTotalSize() }} scrollable>\n      {table.getHeaderGroups().map((headerGroup) => (\n        <TableRow key={headerGroup.id} isHeader>\n          {headerGroup.headers.map((header, index) => {\n            return (\n              <TableHeader\n                key={header.id}\n                style={{\n                  maxWidth: header.column.getSize(),\n                }}\n                resizable={header.column.getCanResize()}\n                resizeHandler={header.getResizeHandler()}\n              >\n                <div\n                  css={{\n                    display: 'flex',\n                    flexDirection: 'row',\n                    gap: theme.spacing.xs,\n                    alignItems: 'center',\n                  }}\n                >\n                  <div css={{ flexShrink: 1, flexGrow: 1, overflow: 'hidden' }}>\n                    {flexRender(header.column.columnDef.header, header.getContext())}\n                  </div>\n                  {index !== 0 && setCardConfig && (\n                    <div>\n                      <DropdownMenu.Root>\n                        <DropdownMenu.Trigger asChild>\n                          <Button componentId=\"set_as_baseline_button\" icon={<OverflowIcon />} />\n                        </DropdownMenu.Trigger>\n                        <DropdownMenu.Content>\n                          <DropdownMenu.Item onClick={() => updateBaselineColumnUuid(header.id)}>\n                            <FormattedMessage\n                              defaultMessage=\"Set as baseline\"\n                              description=\"Runs charts > components > charts > DifferenceViewPlot > Set as baseline dropdown option\"\n                            />\n                          </DropdownMenu.Item>\n                        </DropdownMenu.Content>\n                      </DropdownMenu.Root>\n                    </div>\n                  )}\n                </div>\n              </TableHeader>\n            );\n          })}\n        </TableRow>\n      ))}\n      {table.getRowModel().rows.map((row) => (\n        <TableRow key={row.id}>\n          {row.getAllCells().map((cell) => (\n            <TableCell key={cell.id} style={{ maxWidth: cell.column.getSize() }} multiline>\n              {flexRender(cell.column.columnDef.cell, cell.getContext())}\n            </TableCell>\n          ))}\n        </TableRow>\n      ))}\n    </Table>\n  );\n};\n","import { ImageIcon } from '@databricks/design-system';\nimport { GenericSkeleton, useDesignSystemTheme } from '@databricks/design-system';\nimport { FormattedMessage } from 'react-intl';\nimport { getArtifactLocationUrl } from 'common/utils/ArtifactUtils';\nimport { ImageEntity } from 'experiment-tracking/types';\nimport { useState } from 'react';\nimport { Typography } from '@databricks/design-system';\nimport { ImagePreviewGroup, Image } from '../../../../../shared/building_blocks/Image';\n\nexport const MAX_IMAGE_SIZE = 225;\nexport const MIN_IMAGE_SIZE = 120;\nexport const IMAGE_GAP_SIZE = 10;\n\nexport const getImageSize = (numImages: number, width: number) => {\n  // Scale image size based on number of images\n  const maxImagesPerRow = Math.floor(width / MIN_IMAGE_SIZE);\n  if (numImages < maxImagesPerRow) {\n    return Math.min(width / numImages - IMAGE_GAP_SIZE, MAX_IMAGE_SIZE);\n  }\n  return width / maxImagesPerRow - IMAGE_GAP_SIZE;\n};\n\ntype ImagePlotProps = {\n  imageUrl: string;\n  compressedImageUrl: string;\n  imageSize?: number;\n  maxImageSize?: number;\n};\n\nexport const ImagePlot = ({ imageUrl, compressedImageUrl, imageSize, maxImageSize }: ImagePlotProps) => {\n  const [previewVisible, setPreviewVisible] = useState(false);\n  const { theme } = useDesignSystemTheme();\n\n  return (\n    <div css={{ width: imageSize, height: imageSize || '100%' }}>\n      <div css={{ height: imageSize || '100%' }}>\n        {compressedImageUrl === undefined ? (\n          <GenericSkeleton label=\"Loading...\" css={{ height: imageSize, width: imageSize }} />\n        ) : (\n          <div\n            css={{\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              width: imageSize || '100%',\n              height: imageSize || '100%',\n              maxWidth: maxImageSize,\n              maxHeight: maxImageSize,\n              backgroundColor: theme.colors.backgroundSecondary,\n              '& .ant-image': {\n                height: '100%',\n                display: 'flex',\n                alignItems: 'center',\n              },\n            }}\n          >\n            <ImagePreviewGroup visible={previewVisible} onVisibleChange={setPreviewVisible}>\n              <Image\n                src={compressedImageUrl}\n                preview={{ src: imageUrl }}\n                style={{ maxWidth: maxImageSize || '100%', maxHeight: maxImageSize || '100%' }}\n              />\n            </ImagePreviewGroup>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport const ImagePlotWithHistory = ({\n  metadataByStep,\n  imageSize,\n  step,\n  runUuid,\n}: {\n  metadataByStep: Record<number, ImageEntity>;\n  imageSize?: number;\n  step: number;\n  runUuid: string;\n}) => {\n  const { theme } = useDesignSystemTheme();\n\n  if (metadataByStep[step] === undefined) {\n    return (\n      <div\n        css={{\n          display: 'flex',\n          flexDirection: 'column',\n          alignItems: 'center',\n          justifyContent: 'center',\n          textAlign: 'center',\n          width: imageSize,\n          height: imageSize,\n          backgroundColor: theme.colors.backgroundSecondary,\n          padding: theme.spacing.md,\n        }}\n      >\n        <ImageIcon />\n        <FormattedMessage\n          defaultMessage=\"No image logged at this step\"\n          description=\"Experiment tracking > runs charts > charts > image plot with history > no image text\"\n        />\n      </div>\n    );\n  }\n  return (\n    <ImagePlot\n      imageUrl={getArtifactLocationUrl(metadataByStep[step].filepath, runUuid)}\n      compressedImageUrl={getArtifactLocationUrl(metadataByStep[step].compressed_filepath, runUuid)}\n      imageSize={imageSize}\n    />\n  );\n};\n\nexport const EmptyImageGridPlot = () => {\n  return (\n    <div\n      css={{\n        display: 'flex',\n        flexDirection: 'column',\n        justifyContent: 'center',\n        alignItems: 'center',\n        height: '100%',\n        width: '100%',\n        fontSize: 16,\n      }}\n    >\n      <Typography.Title css={{ marginTop: 16 }} color=\"secondary\" level={3}>\n        Compare logged images\n      </Typography.Title>\n      <Typography.Text css={{ marginBottom: 16 }} color=\"secondary\">\n        Use the image grid chart to compare logged images across runs.\n      </Typography.Text>\n    </div>\n  );\n};\n","import { Tooltip, useDesignSystemTheme } from '@databricks/design-system';\nimport { RunColorPill } from 'experiment-tracking/components/experiment-page/components/RunColorPill';\nimport { useMemo } from 'react';\nimport { RunsChartsImageCardConfig, RunsChartsCardConfig } from '../../runs-charts.types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { EmptyImageGridPlot, IMAGE_GAP_SIZE, ImagePlotWithHistory, getImageSize } from './ImageGridPlot.common';\nimport { ImageEntity } from 'experiment-tracking/types';\n\nexport const ImageGridSingleKeyPlot = ({\n  previewData,\n  cardConfig,\n  width,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsImageCardConfig;\n  groupBy?: string;\n  setCardConfig?: (setter: (current: RunsChartsCardConfig) => RunsChartsImageCardConfig) => void;\n  width: number;\n}) => {\n  const { theme } = useDesignSystemTheme();\n\n  const displayRuns = previewData.filter((run: RunsChartsRunData) => {\n    const imageMetadata = run.images[cardConfig.imageKeys[0]];\n    return imageMetadata && Object.keys(imageMetadata).length > 0;\n  });\n\n  const imageSize = useMemo(() => {\n    return getImageSize(displayRuns.length, width);\n  }, [displayRuns, width]);\n\n  if (displayRuns.length === 0) {\n    return <EmptyImageGridPlot />;\n  }\n  return (\n    <div css={{ display: 'flex', justifyContent: 'flex-start', flexWrap: 'wrap' }}>\n      {displayRuns.map((run: RunsChartsRunData) => {\n        // There is exactly one key in this plot\n        const imageMetadataByStep = Object.values(run.images[cardConfig.imageKeys[0]]).reduce(\n          (acc, metadata: ImageEntity) => {\n            if (metadata.step !== undefined) {\n              acc[metadata.step] = metadata;\n            }\n            return acc;\n          },\n          {} as Record<number, ImageEntity>,\n        );\n        return (\n          <div key={run.uuid} css={{ padding: `${IMAGE_GAP_SIZE / 2}px` }}>\n            <Tooltip title={run.displayName}>\n              <div\n                css={{\n                  width: imageSize,\n                  height: theme.typography.lineHeightMd,\n                  overflow: 'hidden',\n                  whiteSpace: 'nowrap',\n                  display: 'inline-flex',\n                  alignItems: 'center',\n                  gap: theme.spacing.sm,\n                }}\n              >\n                <RunColorPill color={run.color} />\n                {run.displayName}\n              </div>\n            </Tooltip>\n            <ImagePlotWithHistory\n              key={run.uuid}\n              step={cardConfig.step}\n              metadataByStep={imageMetadataByStep}\n              imageSize={imageSize}\n              runUuid={run.uuid}\n            />\n          </div>\n        );\n      })}\n    </div>\n  );\n};\n","import {\n  useDesignSystemTheme,\n  TableRow,\n  TableHeader,\n  TableCell,\n  Table,\n  Tooltip,\n  Typography,\n} from '@databricks/design-system';\nimport { RunColorPill } from 'experiment-tracking/components/experiment-page/components/RunColorPill';\nimport { useMemo } from 'react';\nimport { RunsChartsImageCardConfig, RunsChartsCardConfig } from '../../runs-charts.types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { EmptyImageGridPlot, getImageSize, ImagePlotWithHistory } from './ImageGridPlot.common';\nimport { ImageEntity } from 'experiment-tracking/types';\nimport { FormattedMessage } from 'react-intl';\n\nexport const ImageGridMultipleKeyPlot = ({\n  previewData,\n  cardConfig,\n  width,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsImageCardConfig;\n  groupBy?: string;\n  setCardConfig?: (setter: (current: RunsChartsCardConfig) => RunsChartsImageCardConfig) => void;\n  width: number;\n}) => {\n  const { theme } = useDesignSystemTheme();\n\n  const displayRuns = previewData.filter((run: RunsChartsRunData) => Object.keys(run.images).length !== 0);\n\n  const imageSize = useMemo(() => {\n    return getImageSize(displayRuns.length, width);\n  }, [displayRuns, width]);\n\n  if (displayRuns.length === 0) {\n    return <EmptyImageGridPlot />;\n  }\n  return (\n    <div css={{ height: '100%', width: '100%' }}>\n      <Table grid scrollable>\n        <TableRow isHeader>\n          <TableHeader css={{ minWidth: imageSize + theme.spacing.md }}>\n            <FormattedMessage\n              defaultMessage=\"images\"\n              description=\"Experiment tracking > runs charts > charts > image grid multiple key > table header text\"\n            />\n          </TableHeader>\n          {displayRuns.map((run: RunsChartsRunData) => {\n            return (\n              <TableHeader key={run.uuid} css={{ minWidth: imageSize + theme.spacing.md }}>\n                <Tooltip title={run.displayName}>\n                  <div\n                    css={{\n                      height: theme.typography.lineHeightMd,\n                      whiteSpace: 'nowrap',\n                      display: 'inline-flex',\n                      alignItems: 'center',\n                      margin: 'auto',\n                      gap: theme.spacing.sm,\n                    }}\n                  >\n                    <RunColorPill color={run.color} />\n                    {run.displayName}\n                  </div>\n                </Tooltip>\n              </TableHeader>\n            );\n          })}\n        </TableRow>\n        {cardConfig.imageKeys.map((imageKey) => {\n          return (\n            <TableRow key={imageKey}>\n              <TableCell css={{ minWidth: imageSize + theme.spacing.md }}>\n                <div style={{ whiteSpace: 'normal' }}>{imageKey}</div>\n              </TableCell>\n              {displayRuns.map((run: RunsChartsRunData) => {\n                if (run.images[imageKey] && Object.keys(run.images[imageKey]).length > 0) {\n                  const metadataByStep = Object.values(run.images[imageKey]).reduce((acc, metadata) => {\n                    if (metadata.step !== undefined) {\n                      acc[metadata.step] = metadata;\n                    }\n                    return acc;\n                  }, {} as Record<number, ImageEntity>);\n                  return (\n                    <TableCell key={run.uuid} css={{ minWidth: imageSize + theme.spacing.md }}>\n                      <ImagePlotWithHistory\n                        metadataByStep={metadataByStep}\n                        imageSize={imageSize}\n                        step={cardConfig.step}\n                        runUuid={run.uuid}\n                      />\n                    </TableCell>\n                  );\n                }\n                return <TableCell key={run.uuid} css={{ minWidth: imageSize + theme.spacing.md }} />;\n              })}\n            </TableRow>\n          );\n        })}\n      </Table>\n    </div>\n  );\n};\n","import { useDispatch } from 'react-redux';\nimport { RunsChartsImageCardConfig, RunsChartsCardConfig } from '../../runs-charts.types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { ThunkDispatch } from 'redux-types';\nimport { useEffect } from 'react';\nimport { shouldEnableImageGridCharts } from 'common/utils/FeatureUtils';\nimport { ImageGridSingleKeyPlot } from './ImageGridSingleKeyPlot';\nimport { ImageGridMultipleKeyPlot } from './ImageGridMultipleKeyPlot';\nimport {\n  DEFAULT_IMAGE_GRID_CHART_NAME,\n  LOG_IMAGE_TAG_INDICATOR,\n  NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE,\n} from 'experiment-tracking/constants';\nimport { RunsGroupByConfig } from 'experiment-tracking/components/experiment-page/utils/experimentPage.group-row-utils';\n\nexport const ImageGridPlot = ({\n  previewData,\n  cardConfig,\n  groupBy,\n  setCardConfig,\n  containerWidth,\n}: {\n  previewData: RunsChartsRunData[];\n  cardConfig: RunsChartsImageCardConfig;\n  groupBy: RunsGroupByConfig | null;\n  setCardConfig?: (setter: (current: RunsChartsCardConfig) => RunsChartsImageCardConfig) => void;\n  containerWidth: number;\n}) => {\n  const filteredPreviewData = previewData\n    .filter((run: RunsChartsRunData) => {\n      return run.tags[LOG_IMAGE_TAG_INDICATOR];\n    })\n    .slice(-NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE);\n\n  if (cardConfig.imageKeys.length === 1) {\n    return <ImageGridSingleKeyPlot previewData={filteredPreviewData} cardConfig={cardConfig} width={containerWidth} />;\n  } else if (cardConfig.imageKeys.length > 1) {\n    return (\n      <ImageGridMultipleKeyPlot previewData={filteredPreviewData} cardConfig={cardConfig} width={containerWidth} />\n    );\n  }\n  return null;\n};\n","import { LegacySkeleton } from '@databricks/design-system';\nimport React, { Suspense } from 'react';\nimport { RunsChartsRunData } from '../RunsCharts.common';\n\nconst ParallelCoordinatesPlot = React.lazy(() => import('./ParallelCoordinatesPlot'));\n\nexport const MAX_NUMBER_STRINGS = 30;\nexport type ParallelCoordinateDataEntry = Record<string, string | number | null>;\n\nconst LazyParallelCoordinatesPlot = (props: any) => {\n  return (\n    <Suspense fallback={<LegacySkeleton />}>\n      <ParallelCoordinatesPlot {...props}></ParallelCoordinatesPlot>\n    </Suspense>\n  );\n};\n\n// Map all metrics, params and run uuid\n// Filter data to only keep the selected params and metrics from each run\nexport function processParallelCoordinateData(\n  chartRunData: RunsChartsRunData[],\n  selectedParams: string[],\n  selectedMetrics: string[],\n): ParallelCoordinateDataEntry[] {\n  const allRuns = chartRunData.map((run) => {\n    const result: ParallelCoordinateDataEntry = {\n      uuid: run.uuid,\n    };\n    function computeSelectedAttrs(attrs: string[], runvalue: Record<string, any>) {\n      if (Array.isArray(attrs)) {\n        for (const attr of attrs) {\n          if (attr in runvalue) {\n            result[attr] = runvalue[attr].value;\n          } else {\n            result[attr] = null;\n          }\n        }\n      }\n    }\n    computeSelectedAttrs(selectedParams, run.params);\n    computeSelectedAttrs(selectedMetrics, run.metrics);\n    return result;\n  });\n\n  return filterParallelCoordinateData(allRuns);\n}\n\n// filter data so each column only shows #s or strs, whichever allows more to be displayed\nexport function filterParallelCoordinateData(allRuns: ParallelCoordinateDataEntry[]): ParallelCoordinateDataEntry[] {\n  if (allRuns.length === 0) {\n    return allRuns;\n  }\n\n  const keys = Object.keys(allRuns[0]);\n  keys.shift(); // remove uuid as a key\n  let stringRuns: ParallelCoordinateDataEntry[] = allRuns;\n\n  // add runs with any string values until 30 unique values in any column\n  keys.forEach((key) => {\n    const numberRuns = stringRuns.filter((x) => {\n      return !isNaN(Number(x[key])) && x[key] !== null;\n    }); // this logic should remain the same as in getAxesTypes() for casting\n\n    if (numberRuns.length >= stringRuns.length / 2) {\n      stringRuns = numberRuns;\n      return;\n    }\n\n    const seenVals: Set<string> = new Set();\n    const tempRuns = [];\n    for (const run of stringRuns) {\n      const value = run[key];\n      if (seenVals.size === MAX_NUMBER_STRINGS && seenVals.has(String(value))) {\n        tempRuns.push(run);\n      } else if (seenVals.size < MAX_NUMBER_STRINGS && isNaN(Number(value))) {\n        seenVals.add(String(value));\n        tempRuns.push(run);\n      }\n    }\n    stringRuns = tempRuns;\n  });\n\n  return stringRuns;\n}\n\nexport default LazyParallelCoordinatesPlot;\n","import { Accordion, useDesignSystemTheme } from '@databricks/design-system';\nimport { CSSObject, css } from '@emotion/react';\nimport { useMemo } from 'react';\n\nexport const METRIC_CHART_SECTION_HEADER_SIZE = 55;\n\ninterface MetricChartsAccordionProps {\n  activeKey?: string | string[];\n  onActiveKeyChange?: (key: string | string[]) => void;\n  children: React.ReactNode;\n  disableCollapse?: boolean;\n}\n\nconst MetricChartsAccordion = ({\n  activeKey,\n  onActiveKeyChange,\n  children,\n  disableCollapse = false,\n}: MetricChartsAccordionProps) => {\n  const { theme, getPrefixedClassName } = useDesignSystemTheme();\n  const clsPrefix = getPrefixedClassName('collapse');\n\n  const styles = useMemo(() => {\n    const classItem = `.${clsPrefix}-item`;\n    const classItemActive = `${classItem}-active`;\n    const classHeader = `.${clsPrefix}-header`;\n    const classContent = `.${clsPrefix}-content`;\n    const classContentBox = `.${clsPrefix}-content-box`;\n    const classArrow = `.${clsPrefix}-arrow`;\n\n    const styles: CSSObject = {\n      [classContent]: {\n        padding: '0px !important',\n        backgroundColor: 'transparent !important',\n      },\n\n      [classContentBox]: {\n        padding: '0 0 12px 0px !important',\n        backgroundColor: 'transparent !important',\n      },\n\n      [`& > ${classItem} > ${classHeader} > ${classArrow}`]: {\n        fontSize: theme.general.iconSize,\n        left: 12,\n        // TODO: This is needed currently because the rotated icon isn't centered, remove when accordion is fixed\n        verticalAlign: '-7px',\n        transform: 'rotate(-90deg)',\n        display: disableCollapse ? 'none' : undefined,\n      },\n\n      [`& > ${classItemActive} > ${classHeader} > ${classArrow}`]: {\n        transform: 'rotate(0deg)',\n      },\n\n      [classHeader]: {\n        display: 'flex',\n        color: theme.colors.textPrimary,\n        fontWeight: 600,\n        alignItems: 'center',\n\n        '&:focus-visible': {\n          outlineColor: `${theme.colors.primary} !important`,\n          outlineStyle: 'auto !important',\n        },\n      },\n\n      [`& > ${classItem}`]: {\n        borderBottom: `1px solid ${theme.colors.border}`,\n        borderRadius: 0,\n      },\n\n      [`& > ${classItem} > ${classHeader}`]: {\n        padding: 0,\n        lineHeight: '20px',\n        height: METRIC_CHART_SECTION_HEADER_SIZE,\n      },\n    };\n    return styles;\n  }, [theme, clsPrefix, disableCollapse]);\n\n  return (\n    <Accordion\n      {...(activeKey ? { activeKey } : {})}\n      {...(onActiveKeyChange ? { onChange: onActiveKeyChange } : {})}\n      dangerouslyAppendEmotionCSS={css(styles)}\n      dangerouslySetAntdProps={{ expandIconPosition: 'left' }}\n    >\n      {children}\n    </Accordion>\n  );\n};\n\nexport default MetricChartsAccordion;\n","import { Button, DropdownMenu, PlusIcon } from '@databricks/design-system';\nimport { Theme } from '@emotion/react';\n\nimport { ReactComponent as ChartBarIcon } from '../../../../common/static/chart-bar.svg';\nimport { ReactComponent as ChartContourIcon } from '../../../../common/static/chart-contour.svg';\nimport { ReactComponent as ChartLineIcon } from '../../../../common/static/chart-line.svg';\nimport { ReactComponent as ChartParallelIcon } from '../../../../common/static/chart-parallel.svg';\nimport { ReactComponent as ChartScatterIcon } from '../../../../common/static/chart-scatter.svg';\nimport { ReactComponent as ChartDifferenceIcon } from '../../../../common/static/chart-difference.svg';\nimport { ReactComponent as ChartImageIcon } from '../../../../common/static/chart-image.svg';\nimport { RunsChartType } from '../runs-charts.types';\nimport { shouldEnableDifferenceViewCharts, shouldEnableImageGridCharts } from 'common/utils/FeatureUtils';\nimport { FormattedMessage } from 'react-intl';\n\nexport interface RunsChartsAddChartMenuProps {\n  onAddChart: (type: RunsChartType) => void;\n  supportedChartTypes?: RunsChartType[];\n}\n\nexport const RunsChartsAddChartMenu = ({ onAddChart, supportedChartTypes }: RunsChartsAddChartMenuProps) => {\n  const isChartTypeSupported = (type: RunsChartType) => !supportedChartTypes || supportedChartTypes.includes(type);\n  return (\n    <DropdownMenu.Root modal={false}>\n      <DropdownMenu.Trigger asChild>\n        <Button\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_runscompareaddchartmenu.tsx_19\"\n          css={styles.addChartButton}\n          icon={<PlusIcon />}\n          data-testid=\"experiment-view-compare-runs-add-chart\"\n        >\n          <FormattedMessage\n            defaultMessage=\"Add chart\"\n            description=\"Experiment tracking > runs charts > add chart menu\"\n          />\n        </Button>\n      </DropdownMenu.Trigger>\n      <DropdownMenu.Content align=\"end\">\n        {isChartTypeSupported(RunsChartType.BAR) && (\n          <DropdownMenu.Item\n            onClick={() => onAddChart(RunsChartType.BAR)}\n            data-testid=\"experiment-view-compare-runs-chart-type-bar\"\n          >\n            <DropdownMenu.IconWrapper css={styles.iconWrapper}>\n              <ChartBarIcon />\n            </DropdownMenu.IconWrapper>\n            <FormattedMessage\n              defaultMessage=\"Bar chart\"\n              description=\"Experiment tracking > runs charts > add chart menu > bar chart\"\n            />\n          </DropdownMenu.Item>\n        )}\n        {isChartTypeSupported(RunsChartType.LINE) && (\n          <DropdownMenu.Item\n            onClick={() => onAddChart(RunsChartType.LINE)}\n            data-testid=\"experiment-view-compare-runs-chart-type-line\"\n          >\n            <DropdownMenu.IconWrapper css={styles.iconWrapper}>\n              <ChartLineIcon />\n            </DropdownMenu.IconWrapper>\n            <FormattedMessage\n              defaultMessage=\"Line chart\"\n              description=\"Experiment tracking > runs charts > add chart menu > line chart\"\n            />\n          </DropdownMenu.Item>\n        )}\n        {isChartTypeSupported(RunsChartType.PARALLEL) && (\n          <DropdownMenu.Item\n            onClick={() => onAddChart(RunsChartType.PARALLEL)}\n            data-testid=\"experiment-view-compare-runs-chart-type-parallel\"\n          >\n            <DropdownMenu.IconWrapper css={styles.iconWrapper}>\n              <ChartParallelIcon />\n            </DropdownMenu.IconWrapper>\n            <FormattedMessage\n              defaultMessage=\"Parallel coordinates\"\n              description=\"Experiment tracking > runs charts > add chart menu > parallel coordinates\"\n            />\n          </DropdownMenu.Item>\n        )}\n        {isChartTypeSupported(RunsChartType.SCATTER) && (\n          <DropdownMenu.Item\n            onClick={() => onAddChart(RunsChartType.SCATTER)}\n            data-testid=\"experiment-view-compare-runs-chart-type-scatter\"\n          >\n            <DropdownMenu.IconWrapper css={styles.iconWrapper}>\n              <ChartScatterIcon />\n            </DropdownMenu.IconWrapper>\n            <FormattedMessage\n              defaultMessage=\"Scatter chart\"\n              description=\"Experiment tracking > runs charts > add chart menu > scatter plot\"\n            />\n          </DropdownMenu.Item>\n        )}\n        {isChartTypeSupported(RunsChartType.CONTOUR) && (\n          <DropdownMenu.Item\n            onClick={() => onAddChart(RunsChartType.CONTOUR)}\n            data-testid=\"experiment-view-compare-runs-chart-type-contour\"\n          >\n            <DropdownMenu.IconWrapper css={styles.iconWrapper}>\n              <ChartContourIcon />\n            </DropdownMenu.IconWrapper>\n            <FormattedMessage\n              defaultMessage=\"Contour chart\"\n              description=\"Experiment tracking > runs charts > add chart menu > contour chart\"\n            />\n          </DropdownMenu.Item>\n        )}\n        {shouldEnableDifferenceViewCharts() && isChartTypeSupported(RunsChartType.DIFFERENCE) && (\n          <DropdownMenu.Item\n            onClick={() => onAddChart(RunsChartType.DIFFERENCE)}\n            data-testid=\"experiment-view-compare-runs-chart-type-difference\"\n          >\n            <DropdownMenu.IconWrapper css={styles.iconWrapper}>\n              <ChartDifferenceIcon />\n            </DropdownMenu.IconWrapper>\n            <FormattedMessage\n              defaultMessage=\"Difference view\"\n              description=\"Experiment tracking > runs charts > add chart menu > difference view\"\n            />\n          </DropdownMenu.Item>\n        )}\n        {shouldEnableImageGridCharts() && isChartTypeSupported(RunsChartType.IMAGE) && (\n          <DropdownMenu.Item\n            onClick={() => onAddChart(RunsChartType.IMAGE)}\n            data-testid=\"experiment-view-compare-runs-chart-type-image\"\n          >\n            <DropdownMenu.IconWrapper css={styles.iconWrapper}>\n              <ChartImageIcon />\n            </DropdownMenu.IconWrapper>\n            <FormattedMessage\n              defaultMessage=\"Image grid\"\n              description=\"Experiment tracking > runs charts > add chart menu > image grid\"\n            />\n          </DropdownMenu.Item>\n        )}\n      </DropdownMenu.Content>\n    </DropdownMenu.Root>\n  );\n};\n\nconst styles = {\n  addChartButton: (theme: Theme) => ({\n    // Overriden while waiting for design decision in DuBois (FEINF-1711)\n    backgroundColor: `${theme.colors.backgroundPrimary} !important`,\n  }),\n  iconWrapper: (theme: Theme) => ({\n    width: theme.general.iconSize + theme.spacing.xs,\n  }),\n};\n","import {\n  Button,\n  DangerModal,\n  DragIcon,\n  DropdownMenu,\n  Input,\n  Modal,\n  OverflowIcon,\n  PencilIcon,\n  useDesignSystemTheme,\n} from '@databricks/design-system';\nimport { ChartSectionConfig } from '../../../../types';\nimport { RunsChartsAddChartMenu } from '../RunsChartsAddChartMenu';\nimport { RunsChartType } from '../../runs-charts.types';\nimport { useEffect, useRef, useState } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { useDragAndDropElement } from 'common/hooks/useDragAndDropElement';\nimport { CheckIcon } from '@databricks/design-system';\nimport { METRIC_CHART_SECTION_HEADER_SIZE } from '../../../MetricChartsAccordion';\nimport cx from 'classnames';\n\nexport interface RunsChartsSectionHeaderProps {\n  index: number;\n  section: ChartSectionConfig;\n  sectionChartsLength: number;\n  addNewChartCard: (metricSectionId: string) => (type: RunsChartType) => void;\n  onDeleteSection: (sectionId: string) => void;\n  onAddSection: (sectionId: string, above: boolean) => void;\n  editSection: number;\n  onSetEditSection: React.Dispatch<React.SetStateAction<number>>;\n  onSetSectionName: (sectionId: string, name: string) => void;\n  onSectionReorder: (sourceSectionId: string, targetSectionId: string) => void;\n  isExpanded: boolean;\n  supportedChartTypes?: RunsChartType[] | undefined;\n}\n\nexport const RunsChartsSectionHeader = ({\n  index,\n  section,\n  sectionChartsLength,\n  addNewChartCard,\n  onDeleteSection,\n  onAddSection,\n  editSection,\n  onSetEditSection,\n  onSetSectionName,\n  onSectionReorder,\n  isExpanded,\n  supportedChartTypes,\n}: RunsChartsSectionHeaderProps) => {\n  const { theme } = useDesignSystemTheme();\n  // Change name locally for better performance\n  const [tmpSectionName, setTmpSectionName] = useState(section.name);\n  // State to check if element is being dragged\n  const [isDraggingHandle, setIsDraggingHandle] = useState(false);\n\n  // Ref and state to measure the width of the section name\n  const sectionNameRef = useRef<HTMLDivElement>(null);\n  const confirmButtonRef = useRef<HTMLButtonElement>(null);\n  const [sectionNameWidth, setSectionNameWidth] = useState(0.0);\n\n  // Delete section modal\n  const [isDeleteSectionModalOpen, setIsDeleteSectionModalOpen] = useState(false);\n\n  const stopPropagation = (e: any) => {\n    e.stopPropagation();\n  };\n\n  const deleteModalConfirm = () => {\n    onDeleteSection(section.uuid);\n  };\n\n  const deleteModalCancel = () => {\n    setIsDeleteSectionModalOpen(false);\n  };\n\n  const deleteSection = () => {\n    setIsDeleteSectionModalOpen(true);\n  };\n\n  const addSectionAbove = () => {\n    onAddSection(section.uuid, true);\n  };\n\n  const addSectionBelow = () => {\n    onAddSection(section.uuid, false);\n  };\n\n  const onEdit = (e: React.MouseEvent<HTMLElement>) => {\n    e.stopPropagation();\n    onSetEditSection(index);\n  };\n\n  const onChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setTmpSectionName(e.target.value);\n  };\n\n  const onSubmit = (e: React.KeyboardEvent<HTMLInputElement> | React.MouseEvent<HTMLElement>) => {\n    e.stopPropagation();\n    if (!tmpSectionName.trim()) {\n      e.preventDefault();\n      return;\n    }\n    onSetEditSection(-1);\n    onSetSectionName(section.uuid, tmpSectionName);\n  };\n\n  const onEsc = (e: React.KeyboardEvent<HTMLInputElement>) => {\n    if (e.key === 'Escape') {\n      e.stopPropagation();\n      onSetEditSection(-1);\n      setTmpSectionName(section.name);\n    }\n  };\n\n  const onBlur = (e: React.FocusEvent) => {\n    if (e.relatedTarget === confirmButtonRef.current) {\n      return;\n    }\n    onSetEditSection(-1);\n    onSetSectionName(section.uuid, tmpSectionName);\n  };\n\n  useEffect(() => {\n    if (!sectionNameRef.current) {\n      return;\n    }\n\n    const resizeObserver = new ResizeObserver(([entry]) => {\n      setSectionNameWidth(entry.contentRect.width);\n    });\n\n    resizeObserver.observe(sectionNameRef.current);\n\n    return () => resizeObserver.disconnect();\n  }, []);\n\n  // For explicitness:\n  const EDITABLE_LABEL_PADDING_WIDTH = 6;\n  const EDITABLE_LABEL_BORDER_WIDTH = 1;\n  const EDITABLE_LABEL_OFFSET = EDITABLE_LABEL_PADDING_WIDTH + EDITABLE_LABEL_BORDER_WIDTH;\n\n  const isCurrentlyEdited = editSection === index;\n  const [isCurrentlyHovered, setIsCurrentlyHovered] = useState(false);\n\n  const { dragHandleRef, dragPreviewRef, dropTargetRef, isOver, isDragging } = useDragAndDropElement({\n    dragGroupKey: 'sections',\n    dragKey: section.uuid,\n    onDrop: onSectionReorder,\n  });\n\n  return (\n    <>\n      <div\n        role=\"figure\"\n        css={{\n          display: 'flex',\n          alignItems: 'center',\n          width: '100%',\n          padding: `${theme.spacing.xs}px 0px`,\n          height: `${METRIC_CHART_SECTION_HEADER_SIZE}px`,\n          '.section-element-visibility-on-hover': {\n            visibility: isCurrentlyHovered ? 'visible' : 'hidden',\n            opacity: isCurrentlyHovered ? 1 : 0,\n          },\n          '.section-element-visibility-on-hover-and-not-drag': {\n            visibility: isCurrentlyHovered ? 'visible' : 'hidden',\n            opacity: isCurrentlyHovered ? (isDraggingHandle ? 0 : 1) : 0,\n          },\n          '.section-element-hidden-on-edit': { display: isCurrentlyEdited ? 'none' : 'inherit' },\n        }}\n        onMouseMove={() => setIsCurrentlyHovered(true)}\n        onMouseLeave={() => setIsCurrentlyHovered(false)}\n        ref={(element) => {\n          // Use this element for both drag preview and drop target\n          dropTargetRef?.(element);\n          dragPreviewRef?.(element);\n        }}\n        data-testid=\"experiment-view-compare-runs-section-header\"\n      >\n        {isOver && (\n          // Visual overlay for target drop element\n          <div\n            css={{\n              position: 'absolute',\n              inset: 0,\n              backgroundColor: theme.isDarkMode ? theme.colors.blue800 : theme.colors.blue100,\n              border: `2px dashed ${theme.colors.blue400}`,\n              opacity: 0.75,\n            }}\n          />\n        )}\n        <div\n          style={{\n            maxWidth: '40%',\n            display: 'flex',\n            alignItems: 'center',\n          }}\n        >\n          <div\n            ref={sectionNameRef}\n            style={{\n              position: !isCurrentlyEdited ? 'relative' : 'absolute',\n              visibility: !isCurrentlyEdited ? 'visible' : 'hidden',\n              textOverflow: isCurrentlyEdited ? undefined : 'ellipsis',\n              maxWidth: '100%',\n              overflow: 'clip',\n              paddingLeft: EDITABLE_LABEL_OFFSET,\n              whiteSpace: 'pre',\n            }}\n          >\n            {tmpSectionName}\n          </div>\n          {editSection === index && (\n            <Input\n              autoFocus\n              onClick={stopPropagation}\n              onMouseDown={stopPropagation}\n              onMouseUp={stopPropagation}\n              onDoubleClick={stopPropagation}\n              onChange={onChange}\n              value={tmpSectionName}\n              css={{\n                color: theme.colors.textPrimary,\n                fontWeight: 600,\n                padding: `1px ${EDITABLE_LABEL_PADDING_WIDTH}px 1px ${EDITABLE_LABEL_PADDING_WIDTH}px`,\n                background: theme.colors.backgroundSecondary,\n                minWidth: '50px',\n                width: sectionNameWidth + 2 * EDITABLE_LABEL_OFFSET,\n                position: 'relative',\n                lineHeight: theme.typography.lineHeightBase,\n                maxWidth: '100%',\n              }}\n              onKeyDown={onEsc}\n              onPressEnter={onSubmit}\n              dangerouslyAppendEmotionCSS={{ '&&': { minHeight: '20px !important' } }}\n              onBlur={onBlur}\n            />\n          )}\n          <div\n            css={{\n              padding: theme.spacing.xs,\n              position: 'relative',\n            }}\n            style={{\n              visibility: !isCurrentlyEdited ? 'visible' : 'hidden',\n              display: isCurrentlyEdited ? 'none' : 'inherit',\n            }}\n          >\n            {`(${sectionChartsLength})`}\n          </div>\n          <div className=\"section-element-visibility-on-hover-and-not-drag section-element-hidden-on-edit\">\n            <Button\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_sections_runscomparesectionheader.tsx_246\"\n              onClick={onEdit}\n              aria-label=\"Icon label\"\n              icon={<PencilIcon />}\n            />\n          </div>\n        </div>\n        {editSection === index && (\n          <div style={{ padding: `0 ${theme.spacing.xs}px` }}>\n            <Button\n              componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_sections_runscomparesectionheader.tsx_251\"\n              onClick={onSubmit}\n              icon={<CheckIcon />}\n              ref={confirmButtonRef}\n            />\n          </div>\n        )}\n        <div\n          className=\"section-element-visibility-on-hover section-element-hidden-on-edit\"\n          css={{ position: 'absolute', top: '50%', left: '50%', transform: 'translate(-50%, -50%)', cursor: 'grab' }}\n        >\n          <DragIcon\n            rotate={90}\n            style={{ color: theme.colors.textSecondary }}\n            ref={dragHandleRef}\n            onMouseDown={() => setIsDraggingHandle(true)}\n            onMouseLeave={() => {\n              setIsDraggingHandle(false);\n            }}\n            data-testid=\"experiment-view-compare-runs-section-header-drag-handle\"\n          />\n        </div>\n        <div\n          style={{\n            position: 'absolute',\n            top: '50%',\n            right: '0',\n            transform: 'translate(0, -50%)',\n            display: 'flex',\n            alignItems: 'center',\n          }}\n        >\n          <div\n            onClick={stopPropagation}\n            onMouseDown={stopPropagation}\n            onMouseUp={stopPropagation}\n            onDoubleClick={stopPropagation}\n            className=\"section-element-visibility-on-hover-and-not-drag section-element-hidden-on-edit\"\n          >\n            <DropdownMenu.Root modal={false}>\n              <DropdownMenu.Trigger asChild>\n                <Button\n                  componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_sections_runscomparesectionheader.tsx_288\"\n                  icon={<OverflowIcon />}\n                />\n              </DropdownMenu.Trigger>\n              <DropdownMenu.Content>\n                <DropdownMenu.Item onClick={addSectionAbove}>\n                  <FormattedMessage\n                    defaultMessage=\"Add section above\"\n                    description=\"Experiment page > compare runs > chart section > add section above label\"\n                  />\n                </DropdownMenu.Item>\n                <DropdownMenu.Item onClick={addSectionBelow}>\n                  <FormattedMessage\n                    defaultMessage=\"Add section below\"\n                    description=\"Experiment page > compare runs > chart section > add section below label\"\n                  />\n                </DropdownMenu.Item>\n                <DropdownMenu.Item onClick={deleteSection}>\n                  <FormattedMessage\n                    defaultMessage=\"Delete section\"\n                    description=\"Experiment page > compare runs > chart section > delete section label\"\n                  />\n                </DropdownMenu.Item>\n              </DropdownMenu.Content>\n            </DropdownMenu.Root>\n            <DangerModal\n              visible={isDeleteSectionModalOpen}\n              onOk={deleteModalConfirm}\n              onCancel={deleteModalCancel}\n              title=\"Delete section\"\n            >\n              <FormattedMessage\n                defaultMessage=\"Deleting the section will permanently remove it and the charts it contains. This cannot be undone.\"\n                description=\"Experiment page > compare runs > chart section > delete section warning message\"\n              />\n            </DangerModal>\n          </div>\n          <div\n            onClick={stopPropagation}\n            onMouseDown={stopPropagation}\n            onMouseUp={stopPropagation}\n            onDoubleClick={stopPropagation}\n            className={cx(\n              {\n                'section-element-visibility-on-hover-and-not-drag': !isExpanded,\n              },\n              'section-element-hidden-on-edit',\n            )}\n            css={{\n              alignSelf: 'flex-end',\n              marginLeft: theme.spacing.xs,\n            }}\n          >\n            <RunsChartsAddChartMenu\n              onAddChart={addNewChartCard(section.uuid)}\n              supportedChartTypes={supportedChartTypes}\n            />\n          </div>\n        </div>\n      </div>\n    </>\n  );\n};\n","import { useMemo, useState } from 'react';\nimport type { RunsChartsRunData } from './RunsCharts.common';\nimport type { RunsChartsCardConfig } from '../runs-charts.types';\nimport { RunsChartType } from '../runs-charts.types';\nimport { useDesignSystemTheme } from '@databricks/design-system';\nimport { getGridColumnSetup } from '../../../../common/utils/CssGrid.utils';\nimport { RunsChartCardSetFullscreenFn, RunsChartsChartsDragGroup } from './cards/ChartCard.common';\nimport { useDragAndDropElement } from 'common/hooks/useDragAndDropElement';\nimport { FormattedMessage } from 'react-intl';\nimport { Empty } from '@databricks/design-system';\nimport { RunsChartsCard } from './cards/RunsChartsCard';\nimport type { RunsGroupByConfig } from '../../experiment-page/utils/experimentPage.group-row-utils';\n\nexport interface RunsChartsProps {\n  sectionId: string;\n  chartRunData: RunsChartsRunData[];\n  cardsConfig: RunsChartsCardConfig[];\n  isMetricHistoryLoading?: boolean;\n  onRemoveChart: (chart: RunsChartsCardConfig) => void;\n  onStartEditChart: (chart: RunsChartsCardConfig) => void;\n  onReorderCharts: (sourceChartUuid: string, targetChartUuid: string) => void;\n  onInsertCharts: (sourceChartUuid: string, targetSectionId: string) => void;\n  groupBy: RunsGroupByConfig | null;\n  sectionIndex: number;\n  setFullScreenChart: RunsChartCardSetFullscreenFn;\n  autoRefreshEnabled?: boolean;\n}\n\nexport const RunsCharts = ({\n  sectionId,\n  chartRunData,\n  cardsConfig,\n  isMetricHistoryLoading,\n  onRemoveChart,\n  onStartEditChart,\n  onReorderCharts,\n  onInsertCharts,\n  groupBy,\n  sectionIndex,\n  setFullScreenChart,\n  autoRefreshEnabled,\n}: RunsChartsProps) => {\n  const { theme } = useDesignSystemTheme();\n\n  const [parallelChartCards, differenceChartCards, imageChartCards, remainingChartCards] = useMemo(() => {\n    // Play it safe in case that cards config somehow failed to load\n    if (!Array.isArray(cardsConfig)) {\n      return [[], [], [], []];\n    }\n    return [\n      cardsConfig.filter((c) => c.type === RunsChartType.PARALLEL),\n      cardsConfig.filter((c) => c.type === RunsChartType.DIFFERENCE),\n      cardsConfig.filter((c) => c.type === RunsChartType.IMAGE),\n      cardsConfig.filter(\n        (c) =>\n          c.type !== RunsChartType.PARALLEL && c.type !== RunsChartType.DIFFERENCE && c.type !== RunsChartType.IMAGE,\n      ),\n    ];\n  }, [cardsConfig]);\n\n  const gridSetup = useMemo(\n    () =>\n      getGridColumnSetup({\n        maxColumns: 3,\n        gap: theme.spacing.md,\n        additionalBreakpoints: [{ breakpointWidth: 3 * 720, minColumnWidthForBreakpoint: 600 }],\n      }),\n    [theme],\n  );\n\n  const { dropTargetRef: dropTargetGeneralRef, isOver: isOverGeneral } = useDragAndDropElement({\n    dragGroupKey: RunsChartsChartsDragGroup.GENERAL_AREA,\n    dragKey: sectionId,\n    onDrop: onInsertCharts,\n  });\n\n  const { dropTargetRef: dropTargetParallelRef, isOver: isOverParallel } = useDragAndDropElement({\n    dragGroupKey: RunsChartsChartsDragGroup.PARALLEL_CHARTS_AREA,\n    dragKey: sectionId,\n    onDrop: onInsertCharts,\n  });\n\n  const isChartsEmpty =\n    !parallelChartCards.length &&\n    !differenceChartCards.length &&\n    !imageChartCards.length &&\n    !remainingChartCards.length;\n\n  return (\n    <div\n      role=\"figure\"\n      ref={(element) => {\n        // Use this element for drop target\n        dropTargetGeneralRef?.(element);\n        dropTargetParallelRef?.(element);\n      }}\n      css={{\n        padding: cardsConfig.length === 0 ? theme.spacing.lg : 0,\n        position: 'relative',\n        overflow: 'hidden',\n      }}\n    >\n      {(isOverGeneral || isOverParallel) && cardsConfig.length === 0 && (\n        // Visual overlay for target drop element\n        <div\n          css={{\n            position: 'absolute',\n            inset: 0,\n            backgroundColor: theme.isDarkMode ? theme.colors.blue800 : theme.colors.blue100,\n            border: `2px dashed ${theme.colors.blue400}`,\n            opacity: 0.75,\n          }}\n        />\n      )}\n      {isChartsEmpty && (\n        <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center' }}>\n          <Empty\n            title={\n              <FormattedMessage\n                defaultMessage=\"No charts in this section\"\n                description=\"Runs compare page > Charts tab > No charts placeholder title\"\n              />\n            }\n            description={\n              <FormattedMessage\n                defaultMessage=\"Click 'Add chart' or drag and drop to add charts here.\"\n                description=\"Runs compare page > Charts tab > No charts placeholder description\"\n              />\n            }\n          />\n        </div>\n      )}\n      {[differenceChartCards, parallelChartCards, imageChartCards].map((chartCards, index) => {\n        if (chartCards.length) {\n          return (\n            <div\n              key={`chart-cards-${index}`}\n              css={{\n                display: 'flex',\n                flexDirection: 'column',\n                gap: theme.spacing.md,\n                marginBottom: theme.spacing.md,\n              }}\n            >\n              {chartCards.map((cardConfig, index) => {\n                const reorderProps = {\n                  onReorderWith: onReorderCharts,\n                  canMoveDown: index < chartCards.length - 1,\n                  canMoveUp: index > 0,\n                  onMoveDown: () => onReorderCharts(cardConfig.uuid || '', chartCards[index + 1]?.uuid || ''),\n                  onMoveUp: () => onReorderCharts(cardConfig.uuid || '', chartCards[index - 1]?.uuid || ''),\n                };\n                return (\n                  <RunsChartsCard\n                    cardConfig={cardConfig}\n                    chartRunData={chartRunData}\n                    onStartEditChart={onStartEditChart}\n                    onRemoveChart={onRemoveChart}\n                    setFullScreenChart={setFullScreenChart}\n                    onReorderCharts={onReorderCharts}\n                    index={index}\n                    sectionIndex={sectionIndex}\n                    groupBy={groupBy}\n                    autoRefreshEnabled={autoRefreshEnabled}\n                    key={`${cardConfig.uuid}-${index}-${sectionIndex}`}\n                    {...reorderProps}\n                  />\n                );\n              })}\n            </div>\n          );\n        }\n        return null;\n      })}\n      <div css={gridSetup}>\n        {remainingChartCards.map((cardConfig, index) => {\n          const reorderProps = {\n            onReorderWith: onReorderCharts,\n            canMoveDown: index < remainingChartCards.length - 1,\n            canMoveUp: index > 0,\n            onMoveDown: () => onReorderCharts(cardConfig.uuid || '', remainingChartCards[index + 1]?.uuid || ''),\n            onMoveUp: () => onReorderCharts(cardConfig.uuid || '', remainingChartCards[index - 1]?.uuid || ''),\n          };\n\n          return (\n            <RunsChartsCard\n              cardConfig={cardConfig}\n              chartRunData={chartRunData}\n              onStartEditChart={onStartEditChart}\n              onRemoveChart={onRemoveChart}\n              setFullScreenChart={setFullScreenChart}\n              onReorderCharts={onReorderCharts}\n              index={index}\n              sectionIndex={sectionIndex}\n              groupBy={groupBy}\n              autoRefreshEnabled={autoRefreshEnabled}\n              key={`${cardConfig.uuid}-${index}-${sectionIndex}`}\n              {...reorderProps}\n            />\n          );\n        })}\n      </div>\n    </div>\n  );\n};\n","import type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\nimport { RunsChartsCardConfig } from '../../runs-charts.types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport { RunsCharts } from '../RunsCharts';\nimport type { RunsChartCardSetFullscreenFn } from '../cards/ChartCard.common';\n\nexport interface RunsChartsSectionProps {\n  sectionId: string;\n  sectionCharts: RunsChartsCardConfig[];\n  reorderCharts: (sourceChartUuid: string, targetChartUuid: string) => void;\n  insertCharts: (sourceChartUuid: string, targetSectionId: string) => void;\n  isMetricHistoryLoading: boolean;\n  chartData: RunsChartsRunData[];\n  startEditChart: (chartCard: RunsChartsCardConfig) => void;\n  removeChart: (configToDelete: RunsChartsCardConfig) => void;\n  groupBy: RunsGroupByConfig | null;\n  sectionIndex: number;\n  setFullScreenChart: RunsChartCardSetFullscreenFn;\n  autoRefreshEnabled?: boolean;\n}\n\nexport const RunsChartsSection = ({\n  sectionId,\n  sectionCharts,\n  reorderCharts,\n  insertCharts,\n  isMetricHistoryLoading,\n  chartData,\n  startEditChart,\n  removeChart,\n  groupBy,\n  sectionIndex,\n  setFullScreenChart,\n  autoRefreshEnabled,\n}: RunsChartsSectionProps) => {\n  return (\n    <RunsCharts\n      sectionId={sectionId}\n      chartRunData={chartData}\n      cardsConfig={sectionCharts}\n      isMetricHistoryLoading={isMetricHistoryLoading}\n      onRemoveChart={removeChart}\n      onStartEditChart={startEditChart}\n      onReorderCharts={reorderCharts}\n      onInsertCharts={insertCharts}\n      groupBy={groupBy}\n      sectionIndex={sectionIndex}\n      setFullScreenChart={setFullScreenChart}\n      autoRefreshEnabled={autoRefreshEnabled}\n    />\n  );\n};\n","import { Accordion } from '@databricks/design-system';\nimport { ChartSectionConfig } from '../../../../types';\nimport { RunsChartsRunData } from '../RunsCharts.common';\nimport {\n  RunsChartsBarCardConfig,\n  RunsChartsCardConfig,\n  RunsChartType,\n  RunsChartsLineCardConfig,\n  RunsChartsScatterCardConfig,\n  RunsChartsContourCardConfig,\n  SerializedRunsChartsCardConfigCard,\n} from '../../runs-charts.types';\nimport MetricChartsAccordion, { METRIC_CHART_SECTION_HEADER_SIZE } from '../../../MetricChartsAccordion';\nimport { RunsChartsSectionHeader } from './RunsChartsSectionHeader';\nimport { RunsChartsSection } from './RunsChartsSection';\nimport { useEffect, useMemo } from 'react';\nimport { getUUID } from 'common/utils/ActionUtils';\nimport { useState } from 'react';\nimport { Button, PlusIcon } from '@databricks/design-system';\nimport { FormattedMessage } from 'react-intl';\nimport { Empty } from '@databricks/design-system';\nimport { useDesignSystemTheme } from '@databricks/design-system';\nimport { Spacer } from '@databricks/design-system';\nimport { useUpdateRunsChartsUIConfiguration } from '../../hooks/useRunsChartsUIConfiguration';\nimport { isArray } from 'lodash';\nimport { RunsChartCardSetFullscreenFn } from '../cards/ChartCard.common';\nimport type { RunsGroupByConfig } from '../../../experiment-page/utils/experimentPage.group-row-utils';\n\nconst chartMatchesFilter = (filter: string, config: RunsChartsCardConfig) => {\n  const filterLowerCase = filter.toLowerCase();\n\n  if (config.type === RunsChartType.BAR) {\n    const barConfig = config as RunsChartsBarCardConfig;\n    return barConfig.metricKey.toLowerCase().includes(filterLowerCase);\n  } else if (config.type === RunsChartType.LINE) {\n    const lineConfig = config as RunsChartsLineCardConfig;\n    if (isArray(lineConfig.selectedMetricKeys)) {\n      return lineConfig.selectedMetricKeys.some((metricKey) => metricKey.toLowerCase().includes(filterLowerCase));\n    }\n    return lineConfig.metricKey.toLowerCase().includes(filterLowerCase);\n  } else if (config.type === RunsChartType.SCATTER) {\n    const scatterConfig = config as RunsChartsScatterCardConfig;\n    return (\n      scatterConfig.xaxis.key.toLowerCase().includes(filterLowerCase) ||\n      scatterConfig.yaxis.key.toLowerCase().includes(filterLowerCase)\n    );\n  } else if (config.type === RunsChartType.PARALLEL) {\n    return 'Parallel Coordinates'.toLowerCase().includes(filterLowerCase);\n  } else {\n    // Must be contour\n    const contourConfig = config as RunsChartsContourCardConfig;\n    return (\n      contourConfig.xaxis.key.toLowerCase().includes(filterLowerCase) ||\n      contourConfig.yaxis.key.toLowerCase().includes(filterLowerCase) ||\n      contourConfig.zaxis.key.toLowerCase().includes(filterLowerCase)\n    );\n  }\n};\n\nexport interface RunsChartsSectionAccordionProps {\n  compareRunSections?: ChartSectionConfig[];\n  compareRunCharts?: SerializedRunsChartsCardConfigCard[];\n  reorderCharts: (sourceChartUuid: string, targetChartUuid: string) => void;\n  insertCharts: (sourceChartUuid: string, targetSectionId: string) => void;\n  chartData: RunsChartsRunData[];\n  isMetricHistoryLoading?: boolean;\n  startEditChart: (chartCard: RunsChartsCardConfig) => void;\n  removeChart: (configToDelete: RunsChartsCardConfig) => void;\n  addNewChartCard: (metricSectionId: string) => (type: RunsChartType) => void;\n  search: string;\n  groupBy: RunsGroupByConfig | null;\n  autoRefreshEnabled?: boolean;\n  supportedChartTypes?: RunsChartType[] | undefined;\n  setFullScreenChart: RunsChartCardSetFullscreenFn;\n}\n\nexport const RunsChartsSectionAccordion = ({\n  compareRunSections,\n  compareRunCharts,\n  reorderCharts,\n  insertCharts,\n  chartData,\n  isMetricHistoryLoading = false,\n  autoRefreshEnabled = false,\n  startEditChart,\n  removeChart,\n  addNewChartCard,\n  search,\n  groupBy,\n  supportedChartTypes,\n  setFullScreenChart = () => {},\n}: RunsChartsSectionAccordionProps) => {\n  const updateUIState = useUpdateRunsChartsUIConfiguration();\n  const [editSection, setEditSection] = useState(-1);\n  const { theme } = useDesignSystemTheme();\n\n  /**\n   * Get the active (expanded) panels for the accordion\n   */\n  const activeKey = useMemo(() => {\n    const activeSections = (compareRunSections || []).flatMap((sectionConfig: ChartSectionConfig) => {\n      if (sectionConfig.display) {\n        return [sectionConfig.uuid];\n      } else {\n        return [];\n      }\n    });\n    return activeSections;\n  }, [compareRunSections]);\n\n  /**\n   * Updates the active (expanded) panels for the accordion\n   */\n  const onActivePanelChange = (key: string | string[]) => {\n    updateUIState((current) => {\n      const newCompareRunPanels = (current.compareRunSections || []).map((sectionConfig: ChartSectionConfig) => {\n        const sectionId = sectionConfig.uuid;\n        const shouldDisplaySection =\n          (typeof key === 'string' && sectionId === key) || (Array.isArray(key) && key.includes(sectionId));\n        return {\n          ...sectionConfig,\n          display: shouldDisplaySection,\n        };\n      });\n      return {\n        ...current,\n        compareRunSections: newCompareRunPanels,\n      };\n    });\n  };\n\n  /**\n   * Deletes a section from the accordion\n   */\n  const deleteSection = (sectionId: string) => {\n    updateUIState((current) => {\n      const newCompareRunCharts = (current.compareRunCharts || [])\n        // Keep charts that are generated or not in section\n        .filter((chartConfig: RunsChartsCardConfig) => {\n          return chartConfig.isGenerated || chartConfig.metricSectionId !== sectionId;\n        })\n        // For charts that are generated and in section, set deleted to true\n        .map((chartConfig: RunsChartsCardConfig) => {\n          if (chartConfig.isGenerated && chartConfig.metricSectionId === sectionId) {\n            return { ...chartConfig, deleted: true };\n          } else {\n            return chartConfig;\n          }\n        });\n\n      // Delete section\n      const newCompareRunSections = (current.compareRunSections || [])\n        .slice()\n        .filter((sectionConfig: ChartSectionConfig) => {\n          return sectionConfig.uuid !== sectionId;\n        });\n\n      return {\n        ...current,\n        compareRunCharts: newCompareRunCharts,\n        compareRunSections: newCompareRunSections,\n        isAccordionReordered: true,\n      };\n    });\n  };\n\n  /**\n   * Adds a section to the accordion\n   * @param sectionId indicates the section selected to anchor at\n   * @param above is a boolean value indicating whether to add the section above or below the anchor\n   */\n  const addSection = (sectionId: string, above: boolean) => {\n    let idx = -1;\n    updateUIState((current) => {\n      // Look for index\n      const newCompareRunSections = [...(current.compareRunSections || [])];\n      idx = newCompareRunSections.findIndex((sectionConfig: ChartSectionConfig) => sectionConfig.uuid === sectionId);\n      const newSection = { name: '', uuid: getUUID(), display: false, isReordered: false };\n      if (idx < 0) {\n        // Index not found, add to end\n        newCompareRunSections.push(newSection);\n      } else if (above) {\n        newCompareRunSections.splice(idx, 0, newSection);\n      } else {\n        idx += 1;\n        newCompareRunSections.splice(idx, 0, newSection);\n      }\n      return {\n        ...current,\n        compareRunSections: newCompareRunSections,\n        isAccordionReordered: true,\n      };\n    });\n    return idx;\n  };\n\n  /**\n   * Appends a section to the end of the accordion\n   */\n  const appendSection = () => {\n    updateUIState((current) => {\n      const newCompareRunSections = [\n        ...(current.compareRunSections || []),\n        { name: '', uuid: getUUID(), display: false, isReordered: false },\n      ];\n      return {\n        ...current,\n        compareRunSections: newCompareRunSections,\n        isAccordionReordered: true,\n      };\n    });\n    setEditSection(compareRunSections?.length || -1);\n  };\n\n  /**\n   * Updates the name of a section\n   * @param sectionId the section to update the name of\n   * @param name the new name of the section\n   */\n  const setSectionName = (sectionId: string, name: string) => {\n    updateUIState((current) => {\n      const newCompareRunSections = (current.compareRunSections || []).map((sectionConfig: ChartSectionConfig) => {\n        if (sectionConfig.uuid === sectionId) {\n          return { ...sectionConfig, name: name };\n        } else {\n          return sectionConfig;\n        }\n      });\n      return {\n        ...current,\n        compareRunSections: newCompareRunSections,\n        isAccordionReordered: true,\n      };\n    });\n  };\n\n  /**\n   * Reorders the sections in the accordion\n   * @param sourceSectionId the section you are dragging\n   * @param targetSectionId the section to drop\n   */\n  const sectionReorder = (sourceSectionId: string, targetSectionId: string) => {\n    updateUIState((current) => {\n      const newCompareRunSections = (current.compareRunSections || []).slice();\n      const sourceSectionIdx = newCompareRunSections.findIndex(\n        (sectionConfig: ChartSectionConfig) => sectionConfig.uuid === sourceSectionId,\n      );\n      const targetSectionIdx = newCompareRunSections.findIndex(\n        (sectionConfig: ChartSectionConfig) => sectionConfig.uuid === targetSectionId,\n      );\n      const sourceSection = newCompareRunSections.splice(sourceSectionIdx, 1)[0];\n      // If the source section is above the target section, the target section index will be shifted down by 1\n      newCompareRunSections.splice(targetSectionIdx, 0, sourceSection);\n      return {\n        ...current,\n        compareRunSections: newCompareRunSections,\n        isAccordionReordered: true,\n      };\n    });\n  };\n\n  if (!compareRunSections || !compareRunCharts) {\n    return null;\n  }\n\n  // If search is not empty, render the filtered charts\n  if (search !== '') {\n    const compareRunChartsFiltered = compareRunCharts.filter((config: RunsChartsCardConfig) => {\n      return !config.deleted && chartMatchesFilter(search, config);\n    });\n    // Get the sections that have these charts\n    const sectionsWithCharts = new Set<string>();\n    compareRunChartsFiltered.forEach((config: RunsChartsCardConfig) => {\n      if (config.metricSectionId) {\n        sectionsWithCharts.add(config.metricSectionId);\n      }\n    });\n    // Filter the sections\n    const compareRunSectionsFiltered = compareRunSections.filter((sectionConfig: ChartSectionConfig) => {\n      return sectionsWithCharts.has(sectionConfig.uuid);\n    });\n\n    if (compareRunChartsFiltered.length === 0) {\n      // Render empty in the center of the page\n      return (\n        <>\n          <Spacer size=\"lg\" />\n          <Empty\n            title={\n              <FormattedMessage\n                defaultMessage=\"No metric charts\"\n                description=\"Experiment page > compare runs > no metric charts\"\n              />\n            }\n            description={\n              <FormattedMessage\n                defaultMessage=\"All charts are filtered. Clear the search filter to see hidden metric charts.\"\n                description=\"Experiment page > compare runs > no metric charts > description\"\n              />\n            }\n          />\n        </>\n      );\n    }\n\n    return (\n      <>\n        <MetricChartsAccordion activeKey={compareRunSectionsFiltered.map(({ uuid }) => uuid)} disableCollapse>\n          {compareRunSectionsFiltered.map((sectionConfig: ChartSectionConfig, index: number) => {\n            const HEADING_PADDING_HEIGHT = 4;\n            const EDITABLE_LABEL_PADDING_WIDTH = 6;\n            const EDITABLE_LABEL_BORDER_WIDTH = 1;\n            const EDITABLE_LABEL_OFFSET = EDITABLE_LABEL_PADDING_WIDTH + EDITABLE_LABEL_BORDER_WIDTH;\n            // Get the charts in the section that are not deleted\n            const filteredSectionCharts = compareRunChartsFiltered.filter((config: RunsChartsCardConfig) => {\n              const section = (config as RunsChartsBarCardConfig).metricSectionId;\n              return section === sectionConfig.uuid;\n            });\n\n            const runsCompareSearchHeader = (\n              <div\n                role=\"figure\"\n                css={{\n                  display: 'flex',\n                  alignItems: 'center',\n                  width: '100%',\n                  padding: `${HEADING_PADDING_HEIGHT}px 0px`,\n                  height: `${METRIC_CHART_SECTION_HEADER_SIZE}px`,\n                }}\n              >\n                <div\n                  css={{\n                    paddingLeft: EDITABLE_LABEL_OFFSET,\n                    whiteSpace: 'pre-wrap',\n                  }}\n                  data-testid=\"on-search-runs-compare-section-header\"\n                >\n                  {sectionConfig.name}\n                </div>\n                <div\n                  css={{\n                    padding: theme.spacing.xs,\n                    position: 'relative',\n                  }}\n                >\n                  {`(${filteredSectionCharts.length})`}\n                </div>\n              </div>\n            );\n\n            return (\n              <Accordion.Panel header={runsCompareSearchHeader} key={sectionConfig.uuid} collapsible=\"disabled\">\n                <RunsChartsSection\n                  sectionId={sectionConfig.uuid}\n                  sectionCharts={filteredSectionCharts}\n                  reorderCharts={reorderCharts}\n                  insertCharts={insertCharts}\n                  isMetricHistoryLoading={isMetricHistoryLoading}\n                  chartData={chartData}\n                  startEditChart={startEditChart}\n                  removeChart={removeChart}\n                  groupBy={groupBy}\n                  sectionIndex={index}\n                  setFullScreenChart={setFullScreenChart}\n                  autoRefreshEnabled={autoRefreshEnabled}\n                />\n              </Accordion.Panel>\n            );\n          })}\n        </MetricChartsAccordion>\n      </>\n    );\n  }\n  return (\n    <div>\n      <MetricChartsAccordion activeKey={activeKey} onActiveKeyChange={onActivePanelChange}>\n        {(compareRunSections || []).map((sectionConfig: ChartSectionConfig, index: number) => {\n          const sectionCharts = (compareRunCharts || []).filter((config: RunsChartsCardConfig) => {\n            const section = (config as RunsChartsBarCardConfig).metricSectionId;\n            return !config.deleted && section === sectionConfig.uuid;\n          });\n\n          return (\n            <Accordion.Panel\n              header={\n                <RunsChartsSectionHeader\n                  index={index}\n                  section={sectionConfig}\n                  onDeleteSection={deleteSection}\n                  onAddSection={addSection}\n                  editSection={editSection}\n                  onSetEditSection={setEditSection}\n                  onSetSectionName={setSectionName}\n                  sectionChartsLength={sectionCharts.length}\n                  addNewChartCard={addNewChartCard}\n                  onSectionReorder={sectionReorder}\n                  isExpanded={activeKey.includes(sectionConfig.uuid)}\n                  supportedChartTypes={supportedChartTypes}\n                />\n              }\n              key={sectionConfig.uuid}\n            >\n              <RunsChartsSection\n                sectionId={sectionConfig.uuid}\n                sectionCharts={sectionCharts}\n                reorderCharts={reorderCharts}\n                insertCharts={insertCharts}\n                isMetricHistoryLoading={isMetricHistoryLoading}\n                chartData={chartData}\n                startEditChart={startEditChart}\n                removeChart={removeChart}\n                groupBy={groupBy}\n                sectionIndex={index}\n                setFullScreenChart={setFullScreenChart}\n                autoRefreshEnabled={autoRefreshEnabled}\n              />\n            </Accordion.Panel>\n          );\n        })}\n      </MetricChartsAccordion>\n      <div>\n        <Button\n          componentId=\"codegen_mlflow_app_src_experiment-tracking_components_runs-compare_sections_runscomparesectionaccordion.tsx_405\"\n          block\n          onClick={appendSection}\n          icon={<PlusIcon />}\n          style={{ border: 'none', marginTop: '6px' }}\n        >\n          <FormattedMessage\n            defaultMessage=\"Add section\"\n            description=\"Experiment page > compare runs > chart section > add section bar\"\n          />\n        </Button>\n      </div>\n    </div>\n  );\n};\n","import { useCallback, useRef, useState } from 'react';\nimport { type Data, type Layout, type Config, downloadImage } from 'plotly.js';\n\nexport type ExperimentChartImageDownloadFileFormat = 'svg' | 'png';\nexport type ExperimentChartImageDownloadHandler = (\n  format: ExperimentChartImageDownloadFileFormat,\n  chartTitle: string,\n) => void;\n\nconst experimentChartImageDefaultDownloadLayout: Partial<Layout> = {\n  paper_bgcolor: 'white',\n  plot_bgcolor: 'white',\n};\n\nconst experimentChartImageDefaultDownloadSettings = {\n  width: 1200,\n  height: 600,\n};\n\nconst experimentChartImageDefaultDownloadPlotConfig: Partial<Config> = {\n  displaylogo: false,\n  modeBarButtonsToRemove: ['toImage'],\n};\n\nexport const createChartImageDownloadHandler =\n  (data: Data[], layout: Partial<Layout>) => (format: 'svg' | 'png', title: string) =>\n    downloadImage(\n      {\n        data,\n        layout: { ...layout, ...experimentChartImageDefaultDownloadLayout },\n        config: experimentChartImageDefaultDownloadPlotConfig,\n      },\n      { ...experimentChartImageDefaultDownloadSettings, format, filename: title },\n    );\n\n/**\n * Returns a memoized download handler for chart images.\n * Uses ref-based caching to ensure that the download handler is not recreated on every render.\n */\nexport const useChartImageDownloadHandler = () => {\n  const downloadHandlerRef = useRef<ExperimentChartImageDownloadHandler | null>(null);\n  const [downloadHandler, setDownloadHandler] = useState<ExperimentChartImageDownloadHandler | null>(null);\n\n  const setDownloadHandlerCached = useCallback((downloadHandler: ExperimentChartImageDownloadHandler) => {\n    downloadHandlerRef.current = downloadHandler;\n    setDownloadHandler((existingHandler: ExperimentChartImageDownloadHandler | null) => {\n      if (existingHandler) {\n        return existingHandler;\n      }\n\n      return (format: ExperimentChartImageDownloadFileFormat, chartTitle: string) =>\n        downloadHandlerRef.current?.(format, chartTitle);\n    });\n  }, []);\n\n  return [downloadHandler, setDownloadHandlerCached] as const;\n};\n","import { ImageEntity } from 'experiment-tracking/types';\nimport { RunsChartsRunData } from '../components/RunsCharts.common';\n\nexport const useImageSliderStepMarks = ({\n  data,\n  selectedImageKeys,\n}: {\n  data: RunsChartsRunData[];\n  selectedImageKeys: string[];\n}) => {\n  const stepMarks = data.reduce((acc, run: RunsChartsRunData) => {\n    for (const imageKey of Object.keys(run.images)) {\n      if (selectedImageKeys?.includes(imageKey)) {\n        const metadata = run.images[imageKey];\n        for (const meta of Object.values(metadata)) {\n          if (meta.step !== undefined) {\n            acc[meta.step] = {\n              style: { display: 'none' },\n              label: '',\n            };\n          }\n        }\n      }\n    }\n    return acc;\n  }, {} as Record<number, any>);\n\n  return {\n    stepMarks,\n    maxMark: Math.max(...Object.keys(stepMarks).map(Number)),\n    minMark: Math.min(...Object.keys(stepMarks).map(Number)),\n  };\n};\n","import { useEffect, useRef, useState } from 'react';\n\n/**\n * Checks if the element is currently visible within the viewport using IntersectionObserver.\n * If \"enabled\" is set to false, the returned value will always be true.\n */\nexport const useIsInViewport = ({ enabled = true }: { enabled?: boolean } = {}) => {\n  const internalElementRef = useRef<Element | null>();\n  const saveElementRef = (ref: Element | null) => {\n    internalElementRef.current = ref;\n  };\n  const [isInViewport, setIsInViewport] = useState(!enabled);\n  // Let's use IntersectionObserver to determine if the element is displayed within the viewport\n  useEffect(() => {\n    // If \"enabled\" is set to false or IntersectionObserver is not available, assume that the element is visible\n    if (!enabled || !internalElementRef.current || !window.IntersectionObserver) {\n      setIsInViewport(true);\n      return () => {};\n    }\n\n    // Set the state flag only if element is in viewport\n    const intersectionObserver = new IntersectionObserver(([entry]) => {\n      setIsInViewport(entry.isIntersecting);\n    });\n\n    // Run intersection observer as a macrotask, makes it wait for the next tick\n    // before start observing the element to make sure the observer will register the element\n    setTimeout(() => {\n      if (internalElementRef.current) {\n        intersectionObserver.observe(internalElementRef.current);\n      }\n    });\n\n    return () => intersectionObserver.disconnect();\n  }, [enabled]);\n\n  return { isInViewport, elementRef: saveElementRef };\n};\n","import type { PlotMouseEvent } from 'plotly.js';\nimport { useEffect, useRef } from 'react';\n\n/**\n * Unfortunately plotly.js memorizes first onHover callback given on initial render,\n * so in order to achieve updated behavior we need to wrap each onHover callback with an\n * immutable callback that will call mutable implementation.\n */\nexport const useMutableChartHoverCallback = <T extends (event: Readonly<PlotMouseEvent>) => void>(callback: T) => {\n  const mutableRef = useRef<T>(callback);\n\n  useEffect(() => {\n    mutableRef.current = callback;\n  }, [callback]);\n\n  return (event: Readonly<PlotMouseEvent>) => {\n    mutableRef.current(event);\n  };\n};\n","import { useEffect, useMemo, useState } from 'react';\nimport { RunsChartsRunData } from '../components/RunsCharts.common';\n\n/**\n * Function used to highlight particular trace in the experiment runs chart,\n * for both hover and select scenarios.\n * Since implementation varies across chart types, the function is curryable where\n * two first-level parameters determine the target SVG selector paths to the trace within\n * target chart type.\n *\n * @param traceSelector selector path to the trace for a particular chart type\n * @param parentSelector selector path to the traces container for a particular chart type\n */\nconst highlightChartTracesFn =\n  (traceSelector: string, parentSelector: string) =>\n  /**\n   * @param parent a HTML element containing the chart\n   * @param hoverIndex index of a trace that should be hover-higlighted, set -1 to remove highlight\n   * @param selectIndex index of a trace that should be select-higlighted, set -1 to remove highlight\n   */\n  (parent: HTMLElement, hoverIndex: number, selectIndex: number, numberOfBands = 0) => {\n    const deselected = hoverIndex === -1 && selectIndex === -1;\n\n    parent.querySelector('.is-hover-highlight')?.classList.remove('is-hover-highlight');\n    if (hoverIndex > -1) {\n      parent.querySelectorAll(traceSelector)[hoverIndex]?.classList.add('is-hover-highlight');\n    }\n\n    parent.querySelector('.is-selection-highlight')?.classList.remove('is-selection-highlight');\n    if (selectIndex > -1) {\n      parent.querySelectorAll(traceSelector)[selectIndex]?.classList.add('is-selection-highlight');\n    }\n\n    if (numberOfBands > 0) {\n      const bandTraceIndex =\n        selectIndex > -1 ? selectIndex - numberOfBands : hoverIndex > -1 ? hoverIndex - numberOfBands : -1;\n      parent.querySelectorAll(traceSelector).forEach((e, index) => {\n        e.classList.toggle('is-band', index >= 0 && index < numberOfBands);\n        e.classList.toggle('is-band-highlighted', index === bandTraceIndex);\n      });\n    } else {\n      parent.querySelectorAll(traceSelector).forEach((e) => e.classList.remove('is-band'));\n    }\n\n    if (deselected) {\n      parent.querySelector(parentSelector)?.classList.remove('is-highlight');\n    } else {\n      parent.querySelector(parentSelector)?.classList.add('is-highlight');\n    }\n  };\n\n/**\n * Type-specific implementation of highlightChartTracesFn for bar charts\n */\nexport const highlightBarTraces = highlightChartTracesFn('svg .trace.bars g.point', '.trace.bars');\n\n/**\n * Type-specific implementation of highlightChartTracesFn for line charts\n */\nexport const highlightLineTraces = highlightChartTracesFn('svg .scatterlayer g.trace', '.scatterlayer');\n\n/**\n * Type-specific implementation of highlightChartTracesFn for scatter and contour charts\n */\nexport const highlightScatterTraces = highlightChartTracesFn('svg .scatterlayer path.point', '.trace.scatter');\n\n/**\n * This hook houses and exports various mechanisms necessary for highlighting traces\n * in experiment runs charts.\n *\n * @param containerDiv HTML element containing the chart\n * @param selectedRunUuid currently selected run UUID (set to -1 if none)\n * @param runsData array containing run informations, should be the same order as provided to the chart\n * @param highlightFn a styling function that will be called when the trace should be (un)highlighted, please refer to `highlightCallbackFn()`\n */\nexport const useRunsChartTraceHighlight = (\n  containerDiv: HTMLElement | null,\n  selectedRunUuid: string | null | undefined,\n  runsData: { uuid?: string }[],\n  highlightFn: ReturnType<typeof highlightChartTracesFn>,\n  numberOfBands = 0,\n) => {\n  const selectedTraceIndex = useMemo(() => {\n    if (!containerDiv || !selectedRunUuid) {\n      return -1;\n    }\n    return runsData.findIndex(({ uuid }) => uuid === selectedRunUuid);\n  }, [runsData, containerDiv, selectedRunUuid]);\n\n  const [hoveredPointIndex, setHoveredPointIndex] = useState(-1);\n\n  useEffect(() => {\n    if (!containerDiv) {\n      return;\n    }\n    highlightFn(containerDiv, hoveredPointIndex, selectedTraceIndex, numberOfBands);\n  }, [highlightFn, containerDiv, selectedTraceIndex, hoveredPointIndex, numberOfBands]);\n\n  return { selectedTraceIndex, hoveredPointIndex, setHoveredPointIndex };\n};\n","import { Interpolation, Theme } from '@emotion/react';\nimport React, { useCallback, useContext, useEffect, useLayoutEffect, useMemo, useRef, useState } from 'react';\nimport type {\n  RunsCompareMultipleTracesTooltipData,\n  RunsMetricsSingleTraceTooltipData,\n} from '../components/RunsMetricsLinePlot';\nimport { RunsMetricsBarPlotHoverData } from '../components/RunsMetricsBarPlot';\nimport { shouldEnableDeepLearningUIPhase3 } from '../../../../common/utils/FeatureUtils';\n\nexport interface RunsChartsTooltipBodyProps<TContext = any, TChartData = any, THoverData = any> {\n  runUuid: string;\n  hoverData: THoverData;\n  chartData: TChartData;\n  contextData: TContext;\n  closeContextMenu: () => void;\n  isHovering?: boolean;\n  mode: RunsChartsTooltipMode;\n}\n\nexport interface RunsChartsChartMouseEvent {\n  x: number;\n  y: number;\n  originalEvent?: MouseEvent;\n}\n\nexport enum RunsChartsTooltipMode {\n  Simple = 1,\n  MultipleTracesWithScanline = 2,\n}\n\nexport type RunsChartsTooltipBodyComponent<C = any, T = any> = React.ComponentType<RunsChartsTooltipBodyProps<C, T>>;\n\nconst RunsChartsTooltipContext = React.createContext<{\n  selectedRunUuid: string | null;\n  closeContextMenu: () => void;\n  resetTooltip: () => void;\n  destroyTooltip: () => void;\n  updateTooltip: (\n    runUuid: string,\n    mode: RunsChartsTooltipMode,\n    chartData?: any,\n    event?: RunsChartsChartMouseEvent,\n    additionalData?: any,\n  ) => void;\n} | null>(null);\n\nexport enum ContextMenuVisibility {\n  HIDDEN,\n  HOVER,\n  VISIBLE,\n}\n\nexport const containsMultipleRunsTooltipData = (\n  hoverData: RunsMetricsBarPlotHoverData | RunsMetricsSingleTraceTooltipData | RunsCompareMultipleTracesTooltipData,\n): hoverData is RunsCompareMultipleTracesTooltipData => hoverData && 'tooltipLegendItems' in hoverData;\n\n/**\n * Extract first ancestor HTML element in the hierarchy, even if the target is an SVG element.\n * Necessary for proper behavior of '.contains()'\n */\nconst extractHTMLAncestorElement = (element: Element | EventTarget | null) => {\n  if (element === null || !(element instanceof Element)) {\n    return null;\n  }\n  if (element instanceof HTMLElement) {\n    return element;\n  }\n\n  let currentElement: Element | null = element;\n  while (currentElement && !(currentElement instanceof HTMLElement)) {\n    currentElement = currentElement.parentElement;\n  }\n\n  return currentElement;\n};\n\n/**\n * Context and DOM container necessary for chart context menu to work.\n * Can wrap multiple charts.\n */\nexport const RunsChartsTooltipWrapper = <\n  // Type for the context data passed to the tooltip, e.g. list of all runs\n  TContext = any,\n  // Type for local hover data passed to the tooltip, e.g. configuration of particular chart\n  THover = any,\n>({\n  className,\n  children,\n  contextData,\n  component: Component,\n  hoverOnly = false,\n}: React.PropsWithChildren<{\n  className?: string;\n  contextData: TContext;\n  component: React.ComponentType<RunsChartsTooltipBodyProps<TContext, THover>>;\n  hoverOnly?: boolean;\n}>) => {\n  // A reference to the viewport-wide element containing the context menu\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  // A reference to the tooltip/context-menu element\n  const ctxMenuRef = useRef<HTMLDivElement>(null);\n\n  // Mutable value containing current mouse position\n  const currentPos = useRef<{ x: number; y: number }>({ x: 0, y: 0 });\n\n  const usingImprovedClickMechanism = shouldEnableDeepLearningUIPhase3();\n\n  // Mutable value containing current snapped mouse position, provided externally by the tooltip data providers\n  // Used instead of `currentPos` when the tooltip is in the \"multiple runs\" mode\n  const currentSnappedCoordinates = useRef<{ x: number; y: number }>({ x: 0, y: 0 });\n\n  const [mode, setMode] = useState<RunsChartsTooltipMode>(RunsChartsTooltipMode.Simple);\n\n  // Current visibility of the tooltip/context-menu\n  const [contextMenuShown, setContextMenuShown] = useState<ContextMenuVisibility>(ContextMenuVisibility.HIDDEN);\n\n  const [tooltipDisplayParams, setTooltipDisplayParams] = useState<any | null>(null);\n  const [hoveredRunUuid, setHoveredRunUuid] = useState<string>('');\n\n  // Apart from run uuid, It's also possible to set bonus axis data (helpful for line charts with data lineage)\n  const [additionalAxisData, setAdditionalAxisData] = useState<any>(null);\n\n  // Stores data about the run that has been clicked, but mouse has not been released.\n  const focusedRunData = useRef<{ x: number; y: number; runUuid: string } | null>(null);\n\n  // Mutable version of certain state values, used in processes outside the React event lifecycle\n  const mutableContextMenuShownRef = useRef<ContextMenuVisibility>(contextMenuShown);\n  const mutableHoveredRunUuid = useRef(hoveredRunUuid);\n  const mutableTooltipDisplayParams = useRef(tooltipDisplayParams);\n  const mutableAdditionalAxisData = useRef(additionalAxisData);\n\n  // This method applies the tooltip position basing on the mouse position\n  const applyPositioning = useCallback(\n    (isChangingVisibilityMode = false) => {\n      if (!ctxMenuRef.current || !containerRef.current) {\n        return;\n      }\n\n      // For the X coordinate, If the tooltip is in the \"multiple runs\" mode, use the snapped coordinates.\n      // Otherwise, use the current mouse position.\n      let targetX =\n        mode === RunsChartsTooltipMode.MultipleTracesWithScanline\n          ? currentSnappedCoordinates.current.x\n          : currentPos.current.x;\n\n      let targetY = currentPos.current.y;\n\n      const currentCtxMenu = ctxMenuRef.current;\n      const containerRect = containerRef.current.getBoundingClientRect();\n\n      if (mode === RunsChartsTooltipMode.MultipleTracesWithScanline) {\n        // In particular cases, the tooltip container can not take entire viewport size\n        // so we need to adjust the position of the tooltip\n        targetX -= containerRect.x;\n        targetY -= containerRect.y;\n      }\n\n      ctxMenuRef.current.style.left = '0px';\n      ctxMenuRef.current.style.top = '0px';\n      ctxMenuRef.current.style.transform = `translate3d(${targetX + 1}px, ${targetY + 1}px, 0)`;\n\n      // This function is used to reposition the tooltip if it's out of the viewport\n      const reposition = () => {\n        const menuRect = currentCtxMenu.getBoundingClientRect();\n\n        if (targetX + menuRect.width >= containerRect.width) {\n          targetX -= menuRect.width;\n        }\n\n        if (targetY + menuRect.height >= containerRect.height) {\n          targetY -= menuRect.height;\n        }\n\n        currentCtxMenu.style.transform = `translate3d(${targetX + 1}px, ${targetY + 1}px, 0)`;\n      };\n\n      // If the tooltip changes it's visibility mode during the process, defer repositioning to the next frame\n      // to make sure that the position is correct after possible change of the tooltip size.\n      // Otherwise, reposition immediately to save computation cycles.\n      if (isChangingVisibilityMode) {\n        requestAnimationFrame(reposition);\n      } else {\n        reposition();\n      }\n    },\n    [mode],\n  );\n\n  // Save mutable visibility each time a stateful one changes\n  useEffect(() => {\n    mutableContextMenuShownRef.current = contextMenuShown;\n  }, [contextMenuShown]);\n\n  // This function returns X and Y of the target element relative to the container\n  const getCoordinatesForTargetElement = useCallback((targetElement: HTMLElement, event: MouseEvent) => {\n    const targetRect = targetElement.getBoundingClientRect();\n    const containerRect = containerRef.current?.getBoundingClientRect() || { left: 0, top: 0 };\n    const x = event.offsetX + (targetRect.left - containerRect.left);\n    const y = event.offsetY + (targetRect.top - containerRect.top);\n    return { x, y };\n  }, []);\n\n  const mouseMove: React.MouseEventHandler<HTMLDivElement> = useCallback(\n    (event) => {\n      // Apply only if the tooltip is in the hover mode\n      if (\n        mutableContextMenuShownRef.current === ContextMenuVisibility.HOVER &&\n        ctxMenuRef.current &&\n        containerRef.current\n      ) {\n        focusedRunData.current = null;\n        const targetElement = extractHTMLAncestorElement(event.target);\n        if (targetElement) {\n          currentPos.current = getCoordinatesForTargetElement(targetElement, event.nativeEvent);\n          applyPositioning();\n        }\n      }\n    },\n    [applyPositioning, getCoordinatesForTargetElement],\n  );\n\n  // This callback is being fired on every new run being hovered\n  const updateTooltip = useCallback(\n    (\n      runUuid: string,\n      mode: RunsChartsTooltipMode,\n      chartData?: any,\n      event?: RunsChartsChartMouseEvent,\n      additionalRunData?: any,\n    ) => {\n      mutableHoveredRunUuid.current = runUuid;\n      mutableTooltipDisplayParams.current = chartData;\n      mutableAdditionalAxisData.current = additionalRunData;\n\n      // If the tooltip is visible and hardwired to the position, don't change it\n      if (mutableContextMenuShownRef.current === ContextMenuVisibility.VISIBLE) {\n        return;\n      }\n\n      // Update the event-specific data in the state\n      setTooltipDisplayParams(chartData);\n\n      // If the mouse button has been clicked on a run but hover\n      // has been lost, do nothing\n      if (!runUuid && focusedRunData.current?.runUuid) {\n        return;\n      }\n\n      if (mode === RunsChartsTooltipMode.MultipleTracesWithScanline) {\n        currentSnappedCoordinates.current.x = event?.x || 0;\n      }\n\n      // Set the mode - single run or multiple runs\n      setMode(mode);\n\n      // Update the currently hovered run\n      setHoveredRunUuid((currentRunUuid) => {\n        if (additionalRunData) {\n          setAdditionalAxisData(additionalRunData);\n        }\n        // If the tooltip was hidden or it's shown but it's another run,\n        // make sure that the state is updated\n        if (\n          mutableContextMenuShownRef.current === ContextMenuVisibility.HIDDEN ||\n          (mutableContextMenuShownRef.current === ContextMenuVisibility.HOVER && runUuid !== currentRunUuid)\n        ) {\n          setContextMenuShown(ContextMenuVisibility.HOVER);\n          return runUuid;\n        }\n        return currentRunUuid;\n      });\n    },\n    [],\n  );\n\n  const mouseDownCapture: React.MouseEventHandler<HTMLDivElement> = useCallback(\n    (event) => {\n      if (hoverOnly) {\n        return;\n      }\n      // Saves the current position and hovered run ID after lowering the mouse button,\n      // we use it afterwards to confirm that user has clicked on the same run and scrubbing/zooming\n      // didn't occur in the meanwhile\n      if (event.button === 0 && mutableHoveredRunUuid.current) {\n        focusedRunData.current = {\n          x: event.pageX,\n          y: event.pageY,\n          runUuid: mutableHoveredRunUuid.current,\n        };\n      }\n    },\n    [hoverOnly],\n  );\n\n  // Callback for the click event for the tooltip area, checks if context menu needs to be shown.\n  // We're not using `mouseup` because plotly.js hijacks the event by appending drag cover to the document on `mousedown`.\n  const tooltipAreaClicked: React.MouseEventHandler<HTMLDivElement> = useCallback(\n    (event) => {\n      if (hoverOnly) {\n        return;\n      }\n\n      const clickedInTheSamePlace = () => {\n        if (!usingImprovedClickMechanism) {\n          return (\n            focusedRunData.current?.runUuid &&\n            event.pageX === focusedRunData.current.x &&\n            event.pageY === focusedRunData.current.y\n          );\n        }\n        const epsilonPixels = 5;\n\n        return (\n          focusedRunData.current?.runUuid &&\n          Math.abs(event.pageX - focusedRunData.current.x) < epsilonPixels &&\n          Math.abs(event.pageY - focusedRunData.current.y) < epsilonPixels\n        );\n      };\n\n      // We're interested in displaying the context menu only if\n      // mouse is in the same position as when lowering the button,\n      // this way we won't display it when zooming on the chart.\n      if (focusedRunData.current && clickedInTheSamePlace()) {\n        // If the context menu is already visible, we need to reposition it and provide\n        // the updated run UUID\n        if (mutableContextMenuShownRef.current === ContextMenuVisibility.VISIBLE) {\n          setHoveredRunUuid(focusedRunData.current.runUuid);\n          setAdditionalAxisData(mutableAdditionalAxisData.current);\n          const targetElement = extractHTMLAncestorElement(event.nativeEvent.target);\n          if (targetElement) {\n            currentPos.current = getCoordinatesForTargetElement(targetElement, event.nativeEvent);\n            applyPositioning(true);\n          }\n        } else {\n          // If the context menu was not visible before (it was a tooltip), just enable it.\n          setContextMenuShown(ContextMenuVisibility.VISIBLE);\n          applyPositioning(true);\n        }\n        event.stopPropagation();\n      }\n      // Since the mouse button is up, reset the currently focused run\n      focusedRunData.current = null;\n    },\n    [applyPositioning, hoverOnly, getCoordinatesForTargetElement, usingImprovedClickMechanism],\n  );\n\n  // Exposed function used to hide the context menu\n  const closeContextMenu = useCallback(() => setContextMenuShown(ContextMenuVisibility.HIDDEN), []);\n\n  // Set up main listeners in the useLayoutEffect hook\n  useLayoutEffect(() => {\n    if (!containerRef.current) {\n      return undefined;\n    }\n\n    // Find the DOM root - it can be either document or a shadow root\n    const domRoot = containerRef.current.getRootNode() as Document;\n\n    // This function is being called on every click in the document,\n    // it's used to dismiss the shown context menu\n    const rootClickListener = (e: MouseEvent) => {\n      // We're interested only in dismissing context menu mode, tooltip is fine\n      if (mutableContextMenuShownRef.current !== ContextMenuVisibility.VISIBLE) {\n        return;\n      }\n\n      const targetElement = extractHTMLAncestorElement(e.target);\n\n      if (!targetElement) {\n        return;\n      }\n\n      // Check if the click event occurred within the\n      // context menu\n      const contextMenuClicked =\n        targetElement instanceof HTMLElement &&\n        ctxMenuRef?.current instanceof HTMLElement &&\n        ctxMenuRef.current.contains(targetElement);\n\n      // Dismiss the context menu only if click didn't occur on\n      // the context menu content or on another run\n      if (!contextMenuClicked && !focusedRunData.current?.runUuid) {\n        setContextMenuShown(ContextMenuVisibility.HIDDEN);\n      }\n    };\n    domRoot.addEventListener('click', rootClickListener, { capture: true });\n\n    return () => {\n      domRoot.removeEventListener('click', rootClickListener, { capture: true });\n    };\n  }, [getCoordinatesForTargetElement, applyPositioning]);\n\n  // Callback used to reset the tooltip, fired when the mouse leaves the run\n  const resetTooltip = useCallback(() => {\n    mutableHoveredRunUuid.current = '';\n    if (focusedRunData.current?.runUuid || mutableContextMenuShownRef.current === ContextMenuVisibility.VISIBLE) {\n      return;\n    }\n    setHoveredRunUuid('');\n    setContextMenuShown(ContextMenuVisibility.HIDDEN);\n  }, []);\n\n  // Callback used to remove the tooltip,\n  const destroyTooltip = useCallback((force = false) => {\n    mutableHoveredRunUuid.current = '';\n    setHoveredRunUuid('');\n    setContextMenuShown(ContextMenuVisibility.HIDDEN);\n  }, []);\n\n  // Export the currently selected run ID. Set to \"null\" if there is nothing selected.\n  const selectedRunUuid = useMemo(() => {\n    if (contextMenuShown !== ContextMenuVisibility.VISIBLE) {\n      return null;\n    }\n    return hoveredRunUuid;\n  }, [contextMenuShown, hoveredRunUuid]);\n\n  const contextValue = useMemo(\n    () => ({ updateTooltip, resetTooltip, destroyTooltip, selectedRunUuid, closeContextMenu }),\n    [updateTooltip, resetTooltip, destroyTooltip, selectedRunUuid, closeContextMenu],\n  );\n\n  // We're displaying tooltip if:\n  // - it's not in the hidden mode\n  // - it's in the single run tooltip mode and hovered run is not empty\n  // - it's in the multiple runs tooltip mode\n  const displayTooltip =\n    contextMenuShown !== ContextMenuVisibility.HIDDEN &&\n    (mode === RunsChartsTooltipMode.MultipleTracesWithScanline || hoveredRunUuid !== '');\n\n  return (\n    <RunsChartsTooltipContext.Provider value={contextValue}>\n      {/* The element below wraps all the children (where charts are expected to be mounted)\n      and tracks mouse movement inside */}\n      <div\n        onMouseMove={mouseMove}\n        onMouseDownCapture={mouseDownCapture}\n        onClickCapture={tooltipAreaClicked}\n        css={{ height: '100%' }}\n      >\n        {children}\n      </div>\n      {/* The element below houses the tooltip/context menu */}\n      <div css={styles.contextMenuContainer} className={className} ref={containerRef}>\n        {displayTooltip && (\n          <div\n            ref={ctxMenuRef}\n            css={styles.contextMenuWrapper}\n            data-testid=\"tooltip-container\"\n            style={{\n              userSelect: contextMenuShown === ContextMenuVisibility.HOVER ? 'none' : 'unset',\n              pointerEvents: contextMenuShown === ContextMenuVisibility.HOVER ? 'none' : 'all',\n            }}\n          >\n            {/* A tooltip body component passed from the props */}\n            <Component\n              runUuid={hoveredRunUuid}\n              hoverData={additionalAxisData}\n              chartData={tooltipDisplayParams}\n              contextData={contextData}\n              isHovering={contextMenuShown === ContextMenuVisibility.HOVER}\n              closeContextMenu={closeContextMenu}\n              mode={mode}\n            />\n          </div>\n        )}\n      </div>\n    </RunsChartsTooltipContext.Provider>\n  );\n};\n\n/**\n * This hook is used to wire up tooltip to particular experiment runs chart.\n * Returns \"setTooltip\" and \"resetTooltip\" functions that should be called\n * upon chart's \"onHover\" and \"onUnhover\" events. \"setTooltip\" function consumes\n * the runUuid that was hovered on.\n */\nexport const useRunsChartsTooltip = <\n  // Type for local hover data passed to the tooltip, e.g. configuration of particular chart\n  TChart = any,\n  TAxisData = any,\n>(\n  chartData?: TChart,\n  mode = RunsChartsTooltipMode.Simple,\n) => {\n  const contextValue = useContext(RunsChartsTooltipContext);\n\n  if (!contextValue) {\n    throw new Error(\n      'You must invoke useRunsChartsTooltip() in a component being ancestor of <RunsChartsTooltipWrapper />!',\n    );\n  }\n\n  const { updateTooltip, resetTooltip, selectedRunUuid, closeContextMenu, destroyTooltip } = contextValue;\n\n  const setTooltip = useCallback(\n    (runUuid = '', event?: RunsChartsChartMouseEvent, additionalAxisData?: TAxisData) => {\n      updateTooltip(runUuid, mode, chartData, event, additionalAxisData);\n    },\n    [updateTooltip, chartData, mode],\n  );\n\n  return { setTooltip, resetTooltip, selectedRunUuid, closeContextMenu, destroyTooltip };\n};\n\nconst styles = {\n  contextMenuContainer: {\n    overflow: 'hidden',\n    top: 0,\n    left: 0,\n    width: '100%',\n    height: '100%',\n    position: 'fixed',\n    pointerEvents: 'none',\n  } as Interpolation<Theme>,\n  contextMenuWrapper: (theme: Theme) => ({\n    zIndex: 1,\n    position: 'absolute' as const,\n    padding: theme.spacing.sm,\n    backgroundColor: theme.colors.backgroundPrimary,\n    border: `1px solid ${theme.colors.border}`,\n    left: -999,\n    top: -999,\n    borderRadius: theme.general.borderRadiusBase,\n    boxShadow: theme.general.shadowLow,\n  }),\n  overlayElement: (): Interpolation<Theme> => ({\n    '&::after': {\n      content: '\"\"',\n      position: 'absolute',\n      left: 0,\n      top: 0,\n      right: 0,\n      bottom: 0,\n      backgroundColor: 'transparent',\n    },\n  }),\n};\n","import React from 'react';\nimport { ExperimentRunsChartsUIConfiguration } from '../../experiment-page/models/ExperimentPageUIState';\nimport { RunsChartsCardConfig } from '../runs-charts.types';\nimport { getUUID } from '../../../../common/utils/ActionUtils';\n\nexport type RunsChartsUIConfigurationSetter = (\n  state: ExperimentRunsChartsUIConfiguration,\n) => ExperimentRunsChartsUIConfiguration;\n\nconst RunsChartsUIConfigurationContext = React.createContext<(stateSetter: RunsChartsUIConfigurationSetter) => void>(\n  () => {},\n);\n\n/**\n * Creates a localized context to manage the UI state of the runs charts.\n * Accepts a function to update the state object, coming from simple state setter or a reducer.\n */\nexport const RunsChartsUIConfigurationContextProvider = ({\n  children,\n  updateChartsUIState,\n}: {\n  children: React.ReactNode;\n  updateChartsUIState: (stateSetter: RunsChartsUIConfigurationSetter) => void;\n}) => (\n  <RunsChartsUIConfigurationContext.Provider value={updateChartsUIState}>\n    {children}\n  </RunsChartsUIConfigurationContext.Provider>\n);\n\n/**\n * Returns a function to update the current overarching UI state of the runs charts.\n */\nexport const useUpdateRunsChartsUIConfiguration = () => React.useContext(RunsChartsUIConfigurationContext);\n\nexport const useReorderRunsChartsFn = () => {\n  const updateChartsUIState = useUpdateRunsChartsUIConfiguration();\n\n  return (sourceChartUuid: string, targetChartUuid: string) => {\n    updateChartsUIState((current) => {\n      const newChartsOrder = current.compareRunCharts?.slice();\n      const newSectionsState = current.compareRunSections?.slice();\n      if (!newChartsOrder || !newSectionsState) {\n        return current;\n      }\n\n      const indexSource = newChartsOrder.findIndex((c) => c.uuid === sourceChartUuid);\n      const indexTarget = newChartsOrder.findIndex((c) => c.uuid === targetChartUuid);\n\n      // If one of the charts is not found, do nothing\n      if (indexSource < 0 || indexTarget < 0) {\n        return current;\n      }\n\n      const sourceChart = newChartsOrder[indexSource];\n      const targetChart = newChartsOrder[indexTarget];\n\n      const isSameMetricSection = targetChart.metricSectionId === sourceChart.metricSectionId;\n\n      // Update the sections to indicate that the charts have been reordered\n      const sourceSectionIdx = newSectionsState.findIndex((c) => c.uuid === sourceChart.metricSectionId);\n      const targetSectionIdx = newSectionsState.findIndex((c) => c.uuid === targetChart.metricSectionId);\n      newSectionsState.splice(sourceSectionIdx, 1, { ...newSectionsState[sourceSectionIdx], isReordered: true });\n      newSectionsState.splice(targetSectionIdx, 1, { ...newSectionsState[targetSectionIdx], isReordered: true });\n\n      // Set new chart metric group\n      const newSourceChart = { ...sourceChart };\n      newSourceChart.metricSectionId = targetChart.metricSectionId;\n\n      // Remove the source graph from array\n      newChartsOrder.splice(indexSource, 1);\n      if (!isSameMetricSection) {\n        // Insert the source graph into target\n        newChartsOrder.splice(\n          newChartsOrder.findIndex((c) => c.uuid === targetChartUuid),\n          0,\n          newSourceChart,\n        );\n      } else {\n        // The indexTarget is not neccessarily the target now, but it will work as the insert index\n        newChartsOrder.splice(indexTarget, 0, newSourceChart);\n      }\n\n      return {\n        ...current,\n        compareRunCharts: newChartsOrder,\n        compareRunSections: newSectionsState,\n      };\n    });\n  };\n};\n\nexport const useConfirmChartCardConfigurationFn = () => {\n  const updateChartsUIState = useUpdateRunsChartsUIConfiguration();\n  return (configuredCard: Partial<RunsChartsCardConfig>) => {\n    const serializedCard = RunsChartsCardConfig.serialize({\n      ...configuredCard,\n      uuid: getUUID(),\n    });\n\n    // Creating new chart\n    if (!configuredCard.uuid) {\n      updateChartsUIState((current) => ({\n        ...current,\n        // This condition ensures that chart collection will remain undefined if not set previously\n        compareRunCharts: current.compareRunCharts && [...current.compareRunCharts, serializedCard],\n      }));\n    } /* Editing existing chart */ else {\n      updateChartsUIState((current) => ({\n        ...current,\n        compareRunCharts: current.compareRunCharts?.map((existingChartCard) => {\n          if (existingChartCard.uuid === configuredCard.uuid) {\n            return serializedCard;\n          }\n          return existingChartCard;\n        }),\n      }));\n    }\n  };\n};\n\nexport const useInsertRunsChartsFn = () => {\n  const updateChartsUIState = useUpdateRunsChartsUIConfiguration();\n  return (sourceChartUuid: string, targetSectionId: string) => {\n    updateChartsUIState((current) => {\n      const newChartsOrder = current.compareRunCharts?.slice();\n      const newSectionsState = current.compareRunSections?.slice();\n      if (!newChartsOrder || !newSectionsState) {\n        return current;\n      }\n\n      const indexSource = newChartsOrder.findIndex((c) => c.uuid === sourceChartUuid);\n      if (indexSource < 0) {\n        return current;\n      }\n      const sourceChart = newChartsOrder[indexSource];\n      // Set new chart metric group\n      const newSourceChart = { ...sourceChart };\n      newSourceChart.metricSectionId = targetSectionId;\n\n      // Update the sections to indicate that the charts have been reordered\n      const sourceSectionIdx = newSectionsState.findIndex((c) => c.uuid === sourceChart.metricSectionId);\n      const targetSectionIdx = newSectionsState.findIndex((c) => c.uuid === targetSectionId);\n      newSectionsState.splice(sourceSectionIdx, 1, { ...newSectionsState[sourceSectionIdx], isReordered: true });\n      newSectionsState.splice(targetSectionIdx, 1, { ...newSectionsState[targetSectionIdx], isReordered: true });\n\n      // Remove the source graph from array and append\n      newChartsOrder.splice(indexSource, 1);\n      newChartsOrder.push(newSourceChart);\n\n      return {\n        ...current,\n        compareRunCharts: newChartsOrder,\n        compareRunSections: newSectionsState,\n      };\n    });\n  };\n};\n\nexport const useRemoveRunsChartFn = () => {\n  const updateChartsUIState = useUpdateRunsChartsUIConfiguration();\n\n  return (configToDelete: RunsChartsCardConfig) => {\n    updateChartsUIState((current) => ({\n      ...current,\n      compareRunCharts: configToDelete.isGenerated\n        ? current.compareRunCharts?.map((setup) =>\n            setup.uuid === configToDelete.uuid ? { ...setup, deleted: true } : setup,\n          )\n        : current.compareRunCharts?.filter((setup) => setup.uuid !== configToDelete.uuid),\n    }));\n  };\n};\n","import { chunk, keyBy } from 'lodash';\nimport { useCallback, useEffect, useMemo, useRef } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { ReduxState, ThunkDispatch } from '../../../../redux-types';\nimport { createChartAxisRangeKey } from '../components/RunsCharts.common';\nimport { getSampledMetricHistoryBulkAction } from '../../../sdk/SampledMetricHistoryService';\nimport { SampledMetricsByRunUuidState } from 'experiment-tracking/types';\nimport { EXPERIMENT_RUNS_METRIC_AUTO_REFRESH_INTERVAL } from '../../../utils/MetricsUtils';\nimport Utils from '../../../../common/utils/Utils';\n\ntype SampledMetricData = SampledMetricsByRunUuidState[string][string][string];\n\nexport type SampledMetricsByRun = {\n  runUuid: string;\n} & {\n  [metricKey: string]: SampledMetricData;\n};\n\nconst SAMPLED_METRIC_HISTORY_API_RUN_LIMIT = 100;\n/**\n *\n * Automatically fetches sampled metric history for runs, used in run runs charts.\n * After updating list of metrics or runs, optimizes the request and fetches\n * only the missing entries.\n */\nexport const useSampledMetricHistory = (params: {\n  runUuids: string[];\n  metricKeys: string[];\n  maxResults?: number;\n  range?: [number, number];\n  enabled?: boolean;\n  autoRefreshEnabled?: boolean;\n}) => {\n  const { metricKeys, runUuids, enabled, maxResults, range, autoRefreshEnabled } = params;\n  const dispatch = useDispatch<ThunkDispatch>();\n\n  const { resultsByRunUuid, isLoading, isRefreshing } = useSelector((store: ReduxState) => {\n    const rangeKey = createChartAxisRangeKey(range);\n\n    let anyRunRefreshing = false;\n    let anyRunLoading = false;\n\n    const returnValues: SampledMetricsByRun[] = runUuids.map((runUuid) => {\n      const metricsByMetricKey = metricKeys.reduce(\n        (dataByMetricKey: { [key: string]: SampledMetricData }, metricKey: string) => {\n          const runMetricData = store.entities.sampledMetricsByRunUuid[runUuid]?.[metricKey]?.[rangeKey];\n\n          if (!runMetricData) {\n            return dataByMetricKey;\n          }\n\n          anyRunLoading = anyRunLoading || Boolean(runMetricData.loading);\n          anyRunRefreshing = anyRunRefreshing || Boolean(runMetricData.refreshing);\n\n          dataByMetricKey[metricKey] = runMetricData;\n          return dataByMetricKey;\n        },\n        {},\n      );\n\n      return {\n        runUuid,\n        ...metricsByMetricKey,\n      };\n    });\n\n    return {\n      isLoading: anyRunLoading,\n      isRefreshing: anyRunRefreshing,\n      resultsByRunUuid: keyBy(returnValues, 'runUuid'),\n    };\n  });\n\n  const refreshFn = useCallback(() => {\n    metricKeys.forEach((metricKey) => {\n      chunk(runUuids, SAMPLED_METRIC_HISTORY_API_RUN_LIMIT).forEach((runUuidsChunk) => {\n        const action = getSampledMetricHistoryBulkAction(runUuidsChunk, metricKey, maxResults, range, 'all');\n        dispatch(action);\n      });\n    });\n  }, [dispatch, maxResults, runUuids, metricKeys, range]);\n\n  const refreshTimeoutRef = useRef<number | undefined>(undefined);\n  const autoRefreshEnabledRef = useRef(autoRefreshEnabled && params.enabled);\n  autoRefreshEnabledRef.current = autoRefreshEnabled && params.enabled;\n\n  // Serialize runUuids to a string to use as a dependency in the effect,\n  // directly used runUuids can cause unnecessary re-fetches\n  const runUuidsSerialized = useMemo(() => runUuids.join(','), [runUuids]);\n\n  // Regular single fetch effect with no auto-refresh capabilities. Used if auto-refresh is disabled.\n  useEffect(() => {\n    if (!enabled || autoRefreshEnabled) {\n      return;\n    }\n    metricKeys.forEach((metricKey) => {\n      chunk(runUuids, SAMPLED_METRIC_HISTORY_API_RUN_LIMIT).forEach((runUuidsChunk) => {\n        const action = getSampledMetricHistoryBulkAction(runUuidsChunk, metricKey, maxResults, range);\n        dispatch(action);\n      });\n    });\n  }, [dispatch, maxResults, runUuids, metricKeys, range, enabled, autoRefreshEnabled]);\n\n  // A fetch effect with auto-refresh capabilities. Used only if auto-refresh is enabled.\n  useEffect(() => {\n    let hookUnmounted = false;\n    if (!enabled || !autoRefreshEnabled) {\n      return;\n    }\n\n    // Base fetching function, used for both initial call and subsequent auto-refresh calls\n    const fetchMetricsFn = async (isAutoRefreshing = false) => {\n      const runUuids = runUuidsSerialized.split(',').filter((runUuid: string) => runUuid !== '');\n      await Promise.all(\n        metricKeys.map(async (metricKey) =>\n          Promise.all(\n            chunk(runUuids, SAMPLED_METRIC_HISTORY_API_RUN_LIMIT).map(async (runUuidsChunk) =>\n              dispatch(\n                getSampledMetricHistoryBulkAction(\n                  runUuidsChunk,\n                  metricKey,\n                  maxResults,\n                  range,\n                  isAutoRefreshing ? 'auto' : undefined,\n                ),\n              ),\n            ),\n          ),\n        ),\n      );\n    };\n\n    const scheduleRefresh = async () => {\n      // Initial check to confirm that auto-refresh is still enabled and the hook is still mounted\n      if (!autoRefreshEnabledRef.current || hookUnmounted) {\n        return;\n      }\n      try {\n        await fetchMetricsFn(true);\n      } catch (e) {\n        // In case of error during auto-refresh, log the error but do break the auto-refresh loop\n        Utils.logErrorAndNotifyUser(e);\n      }\n      clearTimeout(refreshTimeoutRef.current);\n\n      // After loading the data, schedule the next refresh if the hook is still enabled and mounted\n      if (!autoRefreshEnabledRef.current || hookUnmounted) {\n        return;\n      }\n\n      refreshTimeoutRef.current = window.setTimeout(scheduleRefresh, EXPERIMENT_RUNS_METRIC_AUTO_REFRESH_INTERVAL);\n    };\n\n    fetchMetricsFn().then(scheduleRefresh);\n\n    return () => {\n      // Mark the hook as unmounted to prevent scheduling new auto-refreshes with current data\n      hookUnmounted = true;\n\n      // Clear the timeout\n      clearTimeout(refreshTimeoutRef.current);\n    };\n  }, [dispatch, maxResults, runUuidsSerialized, metricKeys, range, enabled, autoRefreshEnabled]);\n\n  return { isLoading, isRefreshing, resultsByRunUuid, refresh: refreshFn };\n};\n","import type { RunsChartAxisDef, RunsChartsRunData } from './components/RunsCharts.common';\nimport { RunsChartsLineChartXAxisType } from './components/RunsCharts.common';\nimport { getUUID } from '../../../common/utils/ActionUtils';\nimport { MetricEntitiesByName, ChartSectionConfig } from '../../types';\nimport {\n  MLFLOW_MODEL_METRIC_PREFIX,\n  MLFLOW_SYSTEM_METRIC_PREFIX,\n  MLFLOW_MODEL_METRIC_NAME,\n  MLFLOW_SYSTEM_METRIC_NAME,\n  DEFAULT_IMAGE_GRID_CHART_NAME,\n} from '../../constants';\nimport { isNil, uniq } from 'lodash';\n\n/**\n * Enum for all recognized chart types used in runs charts\n */\nexport enum RunsChartType {\n  BAR = 'BAR',\n  LINE = 'LINE',\n  SCATTER = 'SCATTER',\n  CONTOUR = 'CONTOUR',\n  PARALLEL = 'PARALLEL',\n  DIFFERENCE = 'DIFFERENCE',\n  IMAGE = 'IMAGE',\n}\n\nconst MIN_NUMBER_OF_STEP_FOR_LINE_COMPARISON = 1;\n\n/**\n * Simple interface corresponding to `RunsChartsCardConfig`.\n * Its role is to distinguish between stateful class instance and a simple POJO,\n * it is meant to be contained in a serializable, persisted state.\n */\nexport type SerializedRunsChartsCardConfigCard = RunsChartsCardConfig;\n\n// A function to iterate across run/group data traces and determine if any metric has multiple epochs.\n// This helps to decide if we should seed the line chart or a bar chart.\nconst dataTraceMetricsContainMultipleEpochs = (dataTrace: RunsChartsRunData, metricKey: string): boolean =>\n  Boolean(dataTrace.metrics?.[metricKey]?.step >= MIN_NUMBER_OF_STEP_FOR_LINE_COMPARISON);\n\n/**\n * Main class used for represent a single configured chart card with its type, configuration options etc.\n * Meant to be extended by various chart type classes with `type` field being frozen to a single value.\n */\nexport abstract class RunsChartsCardConfig {\n  uuid?: string;\n  type: RunsChartType = RunsChartType.BAR;\n  runsCountToCompare?: number = 10;\n  metricSectionId?: string = '';\n  deleted = false;\n  isGenerated = false;\n\n  constructor(isGenerated: boolean, uuid?: string, metricSectionId?: string) {\n    this.isGenerated = isGenerated;\n    this.uuid = uuid;\n    this.metricSectionId = metricSectionId;\n  }\n\n  /**\n   * Serializes chart entry, i.e. strips all unnecessary fields (and/or methods) so\n   * it can be saved in persistable memory.\n   */\n  static serialize(entity: Partial<RunsChartsCardConfig>): SerializedRunsChartsCardConfigCard {\n    // TODO: strip unnecessary fields if any\n    return (Object.keys(entity) as (keyof SerializedRunsChartsCardConfigCard)[]).reduce(\n      (result, key) => ({ ...result, [key]: entity[key] }),\n      {} as SerializedRunsChartsCardConfigCard,\n    );\n  }\n\n  /**\n   * Creates empty chart (card) config basing on a type.\n   * TODO: consume visible run set and determine best configuration of metrics, params etc.\n   */\n  static getEmptyChartCardByType(type: RunsChartType, isGenerated: boolean, uuid?: string, metricSectionId?: string) {\n    if (type === RunsChartType.BAR) {\n      return new RunsChartsBarCardConfig(isGenerated, uuid, metricSectionId);\n    } else if (type === RunsChartType.SCATTER) {\n      return new RunsChartsScatterCardConfig(isGenerated, uuid, metricSectionId);\n    } else if (type === RunsChartType.PARALLEL) {\n      return new RunsChartsParallelCardConfig(isGenerated, uuid, metricSectionId);\n    } else if (type === RunsChartType.LINE) {\n      return new RunsChartsLineCardConfig(isGenerated, uuid, metricSectionId);\n    } else if (type === RunsChartType.DIFFERENCE) {\n      return new RunsChartsDifferenceCardConfig(isGenerated, uuid, metricSectionId);\n    } else if (type === RunsChartType.IMAGE) {\n      return new RunsChartsImageCardConfig(isGenerated, uuid, metricSectionId);\n    } else {\n      // Must be contour\n      return new RunsChartsContourCardConfig(isGenerated, uuid, metricSectionId);\n    }\n  }\n\n  static getBaseChartConfigs(primaryMetricKey: string, runsData: RunsChartsRunData[]) {\n    const resultChartSet: RunsChartsCardConfig[] = [];\n    const MAX_NUMBER_OF_METRICS_TO_RENDER = 30;\n\n    const allMetricKeys = uniq(runsData.flatMap((run) => Object.keys(run.metrics)));\n\n    const metricsToRender: Set<string> = new Set();\n    // Add primary_metric to render first\n    if (primaryMetricKey) {\n      metricsToRender.add(primaryMetricKey);\n    }\n\n    // Adding other metrics to render\n    for (const metricsKey of allMetricKeys) {\n      metricsToRender.add(metricsKey);\n    }\n\n    // Render only first N metrics\n    const renderFirstNMetrics: string[] = [...metricsToRender].slice(0, MAX_NUMBER_OF_METRICS_TO_RENDER);\n\n    renderFirstNMetrics.forEach((metricsKey) => {\n      // If the metric has multiple epochs, add a line chart. Otherwise, add a bar chart\n      const anyRunHasMultipleEpochs = runsData.some((dataTrace) =>\n        dataTraceMetricsContainMultipleEpochs(dataTrace, metricsKey),\n      );\n      const chartType = anyRunHasMultipleEpochs ? RunsChartType.LINE : RunsChartType.BAR;\n\n      // Add a bar metric chart only if at least one metric key is detected\n      resultChartSet.push({\n        ...RunsChartsCardConfig.getEmptyChartCardByType(chartType, true, getUUID()),\n        metricKey: metricsKey,\n      } as RunsChartsBarCardConfig);\n    });\n\n    // If no other charts exist, show empty parallel coordinates plot\n    if (resultChartSet.length === 0) {\n      resultChartSet.push(RunsChartsCardConfig.getEmptyChartCardByType(RunsChartType.PARALLEL, false, getUUID()));\n    }\n\n    return resultChartSet;\n  }\n\n  // Extract chart section from metric key\n  static extractChartSectionName = (metricKey: string, delimiter = '/') => {\n    const parts = metricKey.split(delimiter);\n    const section = parts.slice(0, -1).join(delimiter);\n    if (section === MLFLOW_MODEL_METRIC_PREFIX) {\n      return MLFLOW_MODEL_METRIC_NAME;\n    } else if (section + delimiter === MLFLOW_SYSTEM_METRIC_PREFIX) {\n      return MLFLOW_SYSTEM_METRIC_NAME;\n    }\n    return section;\n  };\n\n  static getBaseChartAndSectionConfigs({\n    primaryMetricKey,\n    runsData,\n    useParallelCoordinatesChart = false,\n    enabledSectionNames = [MLFLOW_MODEL_METRIC_NAME, MLFLOW_SYSTEM_METRIC_NAME],\n    filterMetricNames,\n  }: {\n    primaryMetricKey?: string;\n    useParallelCoordinatesChart?: boolean;\n    runsData: RunsChartsRunData[];\n    enabledSectionNames?: string[];\n    filterMetricNames?: (metricName: string) => boolean;\n  }) {\n    const resultChartSet: RunsChartsCardConfig[] = [];\n\n    const allMetricKeys = uniq(runsData.flatMap((run) => Object.keys(run.metrics))).filter((name) => {\n      if (!filterMetricNames) {\n        return true;\n      }\n      return filterMetricNames(name);\n    });\n\n    const metricsToRender: Set<string> = new Set();\n    // Add primary_metric to render first\n    if (primaryMetricKey) {\n      metricsToRender.add(primaryMetricKey);\n    }\n\n    const imagesToRender = uniq(runsData.flatMap((run) => Object.keys(run.images)));\n\n    // Adding other metrics to render\n    for (const metricsKey of allMetricKeys) {\n      metricsToRender.add(metricsKey);\n    }\n\n    const sectionName2Uuid: Record<string, string> = {};\n    enabledSectionNames.forEach((sectionName) => {\n      sectionName2Uuid[sectionName] = getUUID();\n    });\n\n    [...metricsToRender, ...imagesToRender].forEach((key) => {\n      if (!sectionName2Uuid[RunsChartsCardConfig.extractChartSectionName(key)]) {\n        sectionName2Uuid[RunsChartsCardConfig.extractChartSectionName(key)] = getUUID();\n      }\n    });\n\n    Array.from(metricsToRender)\n      .sort()\n      .forEach((metricsKey) => {\n        // If the metric has multiple epochs, add a line chart. Otherwise, add a bar chart\n        const anyRunHasMultipleEpochs = runsData.some((dataTrace) =>\n          dataTraceMetricsContainMultipleEpochs(dataTrace, metricsKey),\n        );\n        const chartType = anyRunHasMultipleEpochs ? RunsChartType.LINE : RunsChartType.BAR;\n\n        const sectionId = sectionName2Uuid[RunsChartsCardConfig.extractChartSectionName(metricsKey)];\n\n        // Add a bar metric chart only if at least one metric key is detected\n        resultChartSet.push({\n          ...RunsChartsCardConfig.getEmptyChartCardByType(chartType, true, getUUID(), sectionId),\n          metricKey: metricsKey,\n        } as RunsChartsBarCardConfig);\n      });\n\n    Array.from(imagesToRender)\n      .sort()\n      .forEach((imageKey) => {\n        const chartType = RunsChartType.IMAGE;\n        const sectionId = sectionName2Uuid[RunsChartsCardConfig.extractChartSectionName(imageKey)];\n\n        // Add an image chart\n        resultChartSet.push({\n          ...RunsChartsCardConfig.getEmptyChartCardByType(chartType, true, getUUID(), sectionId),\n          imageKeys: [imageKey],\n        } as RunsChartsImageCardConfig);\n      });\n\n    // If no other charts exist, show empty parallel coordinates plot\n    if (resultChartSet.length === 0 && useParallelCoordinatesChart) {\n      const sectionId = sectionName2Uuid[MLFLOW_MODEL_METRIC_NAME];\n      resultChartSet.push(\n        RunsChartsCardConfig.getEmptyChartCardByType(RunsChartType.PARALLEL, false, getUUID(), sectionId),\n      );\n    }\n    const rest = Object.keys(sectionName2Uuid)\n      .filter((sectionName) => sectionName !== MLFLOW_MODEL_METRIC_NAME && sectionName !== MLFLOW_SYSTEM_METRIC_NAME)\n      .sort();\n\n    const sortedSectionNames = [\n      ...rest,\n      ...[MLFLOW_MODEL_METRIC_NAME, MLFLOW_SYSTEM_METRIC_NAME].filter((name) => enabledSectionNames.includes(name)),\n    ];\n\n    // Create section configs\n    const resultSectionSet: ChartSectionConfig[] = sortedSectionNames.map((sectionName) => ({\n      uuid: sectionName2Uuid[sectionName],\n      name: sectionName,\n      display: true,\n      isReordered: false,\n      deleted: false,\n      isGenerated: true,\n    }));\n\n    return { resultChartSet, resultSectionSet };\n  }\n\n  static updateChartAndSectionConfigs({\n    compareRunCharts,\n    compareRunSections,\n    isAccordionReordered,\n    runsData,\n    filterMetricNames,\n  }: {\n    compareRunCharts: RunsChartsCardConfig[];\n    compareRunSections: ChartSectionConfig[];\n    runsData: RunsChartsRunData[];\n    isAccordionReordered: boolean;\n    filterMetricNames?: (metricName: string) => boolean;\n  }) {\n    // Make copies of the current charts and sections\n    const resultChartSet: RunsChartsCardConfig[] = compareRunCharts.slice();\n    let resultSectionSet: ChartSectionConfig[] = compareRunSections.slice();\n    // Flag for whether the section or chart set have been updated\n    let isResultUpdated = false;\n\n    const allMetricKeys = uniq(runsData.flatMap((run) => Object.keys(run.metrics))).filter((name) => {\n      if (!filterMetricNames) {\n        return true;\n      }\n      return filterMetricNames(name);\n    });\n\n    const imagesToRender = uniq(runsData.flatMap((run) => Object.keys(run.images)));\n\n    // Create set of metrics to render based on runsData\n    const metricsToRender: Set<string> = new Set();\n    // Adding other metrics to render\n    for (const metricsKey of allMetricKeys) {\n      metricsToRender.add(metricsKey);\n    }\n\n    // Create sectionName2Uuid mappings from existing sections\n    const sectionName2Uuid: Record<string, string> = {};\n    compareRunSections.forEach((section) => (sectionName2Uuid[section.name] = section.uuid));\n\n    imagesToRender.forEach((imageKey) => {\n      const doesImageKeyExist =\n        resultChartSet.findIndex((chart) => {\n          const chartImageKeys = (chart as RunsChartsImageCardConfig).imageKeys;\n          return chartImageKeys ? chartImageKeys.length === 1 && chartImageKeys.includes(imageKey) : false;\n        }) >= 0;\n\n      const chartType = RunsChartType.IMAGE;\n      if (!doesImageKeyExist) {\n        // result is updated when there is a new image key\n        isResultUpdated = true;\n\n        // Insert a new UUID if section doesn't exist\n        const sectionName = RunsChartsCardConfig.extractChartSectionName(imageKey);\n        if (!sectionName2Uuid[sectionName]) {\n          sectionName2Uuid[sectionName] = getUUID();\n        }\n\n        // Get section for imageKey and check if it has been reordered\n        const sectionId = sectionName2Uuid[sectionName];\n        // If section is undefined, it may be a new section, so its not reordered\n        const section = resultSectionSet.find((section) => section.uuid === sectionId);\n        const isSectionReordered = section ? section.isReordered : false;\n\n        const newChartConfig = {\n          ...RunsChartsCardConfig.getEmptyChartCardByType(chartType, true, getUUID(), sectionId),\n          imageKeys: [imageKey],\n        } as RunsChartsImageCardConfig;\n\n        if (isSectionReordered) {\n          // If the section has been reordered, then append to the end of the section\n          resultChartSet.push(newChartConfig);\n        } else {\n          // If section has not been reordered, then insert alphabetically\n          const insertIndex = resultChartSet.findIndex((chart) => {\n            const chartImageKeys = (chart as RunsChartsImageCardConfig).imageKeys;\n            return chartImageKeys ? chartImageKeys[0].localeCompare(imageKey) >= 0 : false;\n          });\n          resultChartSet.splice(insertIndex, 0, newChartConfig);\n        }\n      }\n    });\n\n    // Append new charts at the end instead of alphabetically\n    metricsToRender.forEach((metricKey) => {\n      // Check if metricKey exists in the current chart set\n      const doesMetricKeyExist =\n        resultChartSet.findIndex((chart) => {\n          const chartMetricKey = (chart as RunsChartsBarCardConfig).metricKey;\n          return chartMetricKey ? chartMetricKey === metricKey : false;\n        }) >= 0;\n\n      // Check if there is a generated chart with metricKey\n      const generatedChartIndex = resultChartSet.findIndex((chart) => {\n        const chartMetricKey = (chart as RunsChartsBarCardConfig).metricKey;\n        return chartMetricKey && chartMetricKey === metricKey && chart.isGenerated;\n      });\n\n      // If the metric has multiple epochs, add a line chart. Otherwise, add a bar chart\n      const anyRunHasMultipleEpochs = runsData.some((dataTrace) =>\n        dataTraceMetricsContainMultipleEpochs(dataTrace, metricKey),\n      );\n      const chartType = anyRunHasMultipleEpochs ? RunsChartType.LINE : RunsChartType.BAR;\n\n      // This is a new metric key, so add it to the chart set\n      if (!doesMetricKeyExist) {\n        // result is updated when there is a new metric key\n        isResultUpdated = true;\n\n        // Insert a new UUID if section doesn't exist\n        const sectionName = RunsChartsCardConfig.extractChartSectionName(metricKey);\n        if (!sectionName2Uuid[sectionName]) {\n          sectionName2Uuid[sectionName] = getUUID();\n        }\n\n        // Get section for metricKey and check if it has been reordered\n        const sectionId = sectionName2Uuid[sectionName];\n        // If section is undefined, it may be a new section, so its not reordered\n        const section = resultSectionSet.find((section) => section.uuid === sectionId);\n        const isSectionReordered = section ? section.isReordered : false;\n\n        const newChartConfig = {\n          ...RunsChartsCardConfig.getEmptyChartCardByType(chartType, true, getUUID(), sectionId),\n          metricKey: metricKey,\n        } as RunsChartsBarCardConfig;\n\n        if (isSectionReordered) {\n          // If the section has been reordered, then append to the end of the section\n          resultChartSet.push(newChartConfig);\n        } else {\n          // If section has not been reordered, then insert alphabetically\n          const insertIndex = resultChartSet.findIndex((chart) => {\n            const chartMetricKey = (chart as RunsChartsBarCardConfig).metricKey;\n            return chartMetricKey ? chartMetricKey.localeCompare(metricKey) >= 0 : false;\n          });\n          resultChartSet.splice(insertIndex, 0, newChartConfig);\n        }\n      } else if (\n        generatedChartIndex >= 0 &&\n        resultChartSet[generatedChartIndex].type === RunsChartType.BAR &&\n        chartType === RunsChartType.LINE\n      ) {\n        isResultUpdated = true;\n        // If the chart type has been updated to a line chart from a bar chart, then update the chart type\n        const prevChart = resultChartSet[generatedChartIndex];\n        resultChartSet[generatedChartIndex] = {\n          ...RunsChartsCardConfig.getEmptyChartCardByType(\n            chartType,\n            prevChart.isGenerated,\n            prevChart.uuid,\n            prevChart.metricSectionId,\n          ),\n          metricKey: metricKey,\n          deleted: prevChart.deleted,\n        } as RunsChartsLineCardConfig;\n      }\n    });\n\n    Object.keys(sectionName2Uuid).forEach((sectionName) => {\n      // Check if it is a new section\n      const doesSectionNameExist = resultSectionSet.findIndex((section) => section.name === sectionName) >= 0;\n      if (!doesSectionNameExist) {\n        resultSectionSet.push({\n          uuid: sectionName2Uuid[sectionName],\n          name: sectionName,\n          display: true,\n          isReordered: false,\n        });\n      }\n    });\n\n    if (!isAccordionReordered) {\n      // If sections are in order (not been reordered), then sort alphabetically\n      const rest = resultSectionSet.filter(\n        (section) => section.name !== MLFLOW_MODEL_METRIC_NAME && section.name !== MLFLOW_SYSTEM_METRIC_NAME,\n      );\n      rest.sort((a, b) => a.name.localeCompare(b.name));\n      resultSectionSet = [\n        ...rest,\n        compareRunSections[compareRunSections.length - 2],\n        compareRunSections[compareRunSections.length - 1],\n      ].filter((section) => !isNil(section));\n    }\n\n    return { resultChartSet, resultSectionSet, isResultUpdated };\n  }\n}\n\n// TODO: add configuration fields relevant to scatter chart\nexport class RunsChartsScatterCardConfig extends RunsChartsCardConfig {\n  type: RunsChartType.SCATTER = RunsChartType.SCATTER;\n  xaxis: RunsChartAxisDef = { key: '', type: 'METRIC' };\n  yaxis: RunsChartAxisDef = { key: '', type: 'METRIC' };\n  runsCountToCompare = 100;\n}\n\n// TODO: add configuration fields relevant to line chart\nexport class RunsChartsLineCardConfig extends RunsChartsCardConfig {\n  type: RunsChartType.LINE = RunsChartType.LINE;\n\n  /**\n   * A metric key used for chart's X axis\n   */\n  metricKey = '';\n\n  /**\n   * New key to support multiple metrics\n   * NOTE: This key will not be present in older charts\n   */\n  selectedMetricKeys?: string[];\n\n  /**\n   * Smoothness\n   */\n  lineSmoothness = 0;\n\n  /**\n   * Scale type for X axis\n   */\n  xAxisScaleType: 'linear' | 'log' = 'linear';\n\n  /**\n   * Y axis mode\n   */\n  scaleType: 'linear' | 'log' = 'linear';\n\n  /**\n   * Choose X axis mode - numeric step, relative time in seconds or absolute time value\n   */\n  xAxisKey: RunsChartsLineChartXAxisType = RunsChartsLineChartXAxisType.STEP;\n\n  /**\n   * Name of the metric to use for the X axis. Used when xAxisKey is set to 'metric'\n   */\n  selectedXAxisMetricKey = '';\n\n  /**\n   * Display points on the line chart. Undefined means \"auto\" mode, i.e. display points only when\n   * there are fewer than 60 datapoints on the chart.\n   */\n  displayPoints?: boolean = undefined;\n}\n\n// TODO: add configuration fields relevant to bar chart\nexport class RunsChartsBarCardConfig extends RunsChartsCardConfig {\n  type: RunsChartType.BAR = RunsChartType.BAR;\n\n  /**\n   * A metric key used for chart's X axis\n   */\n  metricKey = '';\n}\n\n// TODO: add configuration fields relevant to contour chart\nexport class RunsChartsContourCardConfig extends RunsChartsCardConfig {\n  type: RunsChartType.CONTOUR = RunsChartType.CONTOUR;\n  xaxis: RunsChartAxisDef = { key: '', type: 'METRIC' };\n  yaxis: RunsChartAxisDef = { key: '', type: 'METRIC' };\n  zaxis: RunsChartAxisDef = { key: '', type: 'METRIC' };\n}\n\n// TODO: add configuration fields relevant to parallel coords chart\nexport class RunsChartsParallelCardConfig extends RunsChartsCardConfig {\n  type: RunsChartType.PARALLEL = RunsChartType.PARALLEL;\n  selectedParams: string[] = [];\n  selectedMetrics: string[] = [];\n  showAllRuns?: boolean = false;\n}\n\nexport enum DifferenceCardConfigCompareGroup {\n  MODEL_METRICS = 'Model metrics',\n  SYSTEM_METRICS = 'System metrics',\n  PARAMETERS = 'Parameters',\n  ATTRIBUTES = 'Attributes',\n  TAGS = 'Tags',\n}\n\nexport const DISABLED_GROUP_WHEN_GROUPBY = [\n  DifferenceCardConfigCompareGroup.PARAMETERS,\n  DifferenceCardConfigCompareGroup.TAGS,\n  DifferenceCardConfigCompareGroup.ATTRIBUTES,\n];\n\nexport enum DifferenceCardAttributes {\n  USER = 'User',\n  SOURCE = 'Source',\n  VERSION = 'Version',\n  MODELS = 'Models',\n}\n\n// TODO: add configuration fields relevant to difference view chart\nexport class RunsChartsDifferenceCardConfig extends RunsChartsCardConfig {\n  type: RunsChartType = RunsChartType.DIFFERENCE;\n  compareGroups: DifferenceCardConfigCompareGroup[] = [];\n  chartName = 'Runs difference view';\n  showChangeFromBaseline = true;\n  showDifferencesOnly = true;\n  baselineColumnUuid = '';\n}\n\nexport class RunsChartsImageCardConfig extends RunsChartsCardConfig {\n  type: RunsChartType = RunsChartType.IMAGE;\n  // image keys to show\n  imageKeys: string[] = [];\n  step = 0;\n}\n","import { type Dictionary, compact, first, isUndefined, last, max, min, minBy, orderBy, values } from 'lodash';\nimport { MetricEntity, SampledMetricsByRunUuidState } from '../../../types';\nimport { SampledMetricsByRun } from '../hooks/useSampledMetricHistory';\n\n/**\n * This function consumes chart timestamp range and returns\n * corresponding step range for a given metric basing on a history.\n */\nexport const findChartStepsByTimestamp = (\n  // Currently fetched metric history\n  currentMetricHistory: {\n    [rangeKey: string]: {\n      loading?: boolean | undefined;\n      metricsHistory?: MetricEntity[] | undefined;\n    };\n  },\n  // Timestamp range - either textual (\"2022-10-23 10:00:00\") or numeric (milliseconds)\n  range: [string | number, string | number],\n  // If set to true, will return entire boundaries from history if timestamps are not found.\n  // Otherwise, will return undefined.\n  useDefaultIfNotFound = true,\n): [number, number] | undefined => {\n  // First, let's compile a history of all metric values from all ranges,\n  // then sort it by timestamp\n  const flatHistory = orderBy(\n    compact(\n      values(currentMetricHistory)\n        .map(({ metricsHistory }) => metricsHistory)\n        .flat(),\n    ),\n    'timestamp',\n  );\n\n  // If there's no sufficient entries, return nothing\n  if (flatHistory.length < 2) {\n    return undefined;\n  }\n\n  // We consume textual ranges produced by charts so we have\n  // to convert them to timestamps\n  const lowerBound = new Date(range[0]).valueOf();\n  const upperBound = new Date(range[1]).valueOf();\n\n  // First, try to find the lower entry using loop\n  let lowerEntry = useDefaultIfNotFound ? first(flatHistory) : undefined;\n\n  for (let index = 0; index < flatHistory.length; index++) {\n    const entry = flatHistory[index];\n    if (entry.timestamp > lowerBound) {\n      lowerEntry = flatHistory[index - 1] || entry;\n      break;\n    }\n  }\n\n  // Repeat for the upper entry\n  let upperEntry = useDefaultIfNotFound ? last(flatHistory) : undefined;\n\n  for (let index = flatHistory.length - 1; index >= 0; index--) {\n    const entry = flatHistory[index];\n    if (entry.timestamp < upperBound) {\n      upperEntry = flatHistory[index + 1] || entry;\n      break;\n    }\n  }\n\n  // If boundaries are not found, return nothing\n  if (isUndefined(lowerEntry) || isUndefined(upperEntry)) {\n    return undefined;\n  }\n\n  // Return found boundary entries\n  return [lowerEntry.step, upperEntry.step];\n};\n\n/**\n * Finds the chart steps by absolute timestamp for multiple runs.\n *\n * @param sampledMetrics - The sampled metrics by run UUID state.\n * @param runUuids - The array of run UUIDs.\n * @param metricKey - The metric key.\n * @param range - The range of timestamps.\n * @returns The lower and upper bounds of the chart steps, or undefined if not found.\n */\nexport const findChartStepsByTimestampForRuns = (\n  sampledMetrics: SampledMetricsByRunUuidState,\n  runUuids: string[],\n  metricKey: string,\n  range: [string | number, string | number],\n): [number, number] | undefined => {\n  const stepRangesPerRun = compact(\n    runUuids.map((runUuid) => {\n      const metricHistoryForRun = sampledMetrics[runUuid]?.[metricKey];\n      return metricHistoryForRun ? findChartStepsByTimestamp(metricHistoryForRun, range, false) : undefined;\n    }),\n  );\n  const lowerBound = min(stepRangesPerRun.map(([bound]) => bound));\n  const upperBound = max(stepRangesPerRun.map(([, bound]) => bound));\n\n  if (!isUndefined(lowerBound) && !isUndefined(upperBound)) {\n    return [lowerBound, upperBound];\n  }\n\n  return undefined;\n};\n\n/**\n * This function consumes chart relative time range and returns\n * corresponding step range for a given metric basing on a history.\n *\n * @param currentlyVisibleMetrics currentlyVisibleMetrics is a dictionary of currently rendered metric traces for run\n * @param runUuids a list of run UUIDs to process\n * @param relativeRange a relative time range in seconds\n * @returns a range of steps or undefined if no relevant are found\n */\nexport const findAbsoluteTimestampRangeForRelativeRange = (\n  currentlyVisibleMetrics: Dictionary<SampledMetricsByRun>,\n  runUuids: string[],\n  relativeRange: [number, number],\n  multiplier = 1000,\n): [number, number] | undefined => {\n  const stepRangesPerRun = compact(\n    runUuids.map((runUuid) => {\n      const runData = currentlyVisibleMetrics[runUuid];\n\n      if (!runData) {\n        return null;\n      }\n\n      // omit the \"runUuid\" key so we can conveniently access the metrics data\n      const { runUuid: _, ...runMetrics } = runData;\n\n      // concat all the metrics history for the run\n      const visibleMetricHistoryForRun = values(runMetrics).flatMap((metric) => metric.metricsHistory ?? []);\n\n      // Find the timestamp offset for the run. Should be equal to lowest timestamp value for each run.\n      const timestampOffset = minBy(visibleMetricHistoryForRun, 'timestamp')?.timestamp || 0;\n\n      // Convert relative time range to timestamp range. Relative range comes\n      // in seconds so we have to multiply it by 1000 to get milliseconds.\n      return [relativeRange[0] * multiplier + timestampOffset, relativeRange[1] * multiplier + timestampOffset] as [\n        number,\n        number,\n      ];\n    }),\n  );\n  const lowerBound = min(stepRangesPerRun.map(([bound]) => bound));\n  const upperBound = max(stepRangesPerRun.map(([, bound]) => bound));\n  if (!isUndefined(lowerBound) && !isUndefined(upperBound)) {\n    return [lowerBound, upperBound];\n  }\n\n  return undefined;\n};\n","import { useMemo } from 'react';\nimport type { RunGroupingAggregateFunction } from '../../experiment-page/utils/experimentPage.row-types';\nimport invariant from 'invariant';\nimport type { RunsChartsRunData } from '../../runs-charts/components/RunsCharts.common';\nimport {\n  createAggregatedMetricHistory,\n  createValueAggregatedMetricHistory,\n  type SyntheticMetricHistory,\n} from '../../experiment-page/utils/experimentPage.group-row-utils';\nimport { uniq, type Dictionary, compact, pick, isNil } from 'lodash';\nimport type { SampledMetricsByRun } from '../../runs-charts/hooks/useSampledMetricHistory';\nimport type { MetricHistoryByName } from '../../../types';\n\nexport interface UseGroupedChartRunDataParams {\n  ungroupedRunsData: RunsChartsRunData[];\n  enabled: boolean;\n  aggregateFunction?: RunGroupingAggregateFunction;\n  metricKeys: string[];\n  sampledDataResultsByRunUuid: Dictionary<SampledMetricsByRun>;\n  selectedXAxisMetricKey?: string;\n}\n\n/**\n * Returns a new array of RunsChartsRunData with aggregated metrics for grouped runs.\n * In order to make rendering of the confidence interval possible, the returned dataset contains\n * min, max and average values for each metric while respecting the metric history.\n */\nexport const useGroupedChartRunData = ({\n  ungroupedRunsData,\n  enabled,\n  aggregateFunction,\n  metricKeys,\n  sampledDataResultsByRunUuid,\n  selectedXAxisMetricKey,\n}: UseGroupedChartRunDataParams) => {\n  return useMemo(() => {\n    if (!enabled || !aggregateFunction) {\n      return ungroupedRunsData;\n    }\n\n    // Extract groups from the result set and calculate aggregated metrics\n    const perGroupData: RunsChartsRunData[] = ungroupedRunsData\n      .filter(({ groupParentInfo }) => groupParentInfo)\n      .map((group) => {\n        const aggregatedMetricsHistory: Record<string, SyntheticMetricHistory> = {};\n        metricKeys.forEach((metricKey) => {\n          invariant(group.groupParentInfo, 'groupParentInfo should be defined');\n\n          const aggregatedRunUuidsInGroup =\n            group.groupParentInfo.runUuidsForAggregation ?? group.groupParentInfo.runUuids;\n\n          let aggregatedMetricsHistoryForMetric;\n          if (!isNil(selectedXAxisMetricKey)) {\n            aggregatedMetricsHistoryForMetric = createValueAggregatedMetricHistory(\n              pick(sampledDataResultsByRunUuid, aggregatedRunUuidsInGroup),\n              metricKey,\n              selectedXAxisMetricKey,\n            );\n          } else {\n            const metricsHistoryInGroup = compact(\n              aggregatedRunUuidsInGroup.flatMap((runUuid) => {\n                const metricsHistory = sampledDataResultsByRunUuid[runUuid]?.[metricKey]?.metricsHistory;\n                return metricsHistory;\n              }),\n            );\n\n            // Get all step numbers from all runs in the group\n            const steps = uniq(metricsHistoryInGroup.map((h) => h.step));\n\n            aggregatedMetricsHistoryForMetric = createAggregatedMetricHistory(steps, metricKey, metricsHistoryInGroup);\n          }\n\n          aggregatedMetricsHistory[metricKey] = aggregatedMetricsHistoryForMetric;\n        });\n        const metricsHistory = metricKeys.reduce<MetricHistoryByName>((acc, key) => {\n          const history = aggregatedMetricsHistory[key][aggregateFunction];\n          if (history && history.length > 0) {\n            acc[key] = history;\n          }\n          return acc;\n        }, {});\n\n        return {\n          ...group,\n          metricsHistory,\n          aggregatedMetricsHistory,\n        };\n      });\n\n    const ungroupedRuns = ungroupedRunsData.filter(({ belongsToGroup }) => belongsToGroup === false);\n\n    return [...perGroupData, ...ungroupedRuns];\n  }, [metricKeys, sampledDataResultsByRunUuid, ungroupedRunsData, enabled, aggregateFunction, selectedXAxisMetricKey]);\n};\n","import { DatasetSourceTypes, type DatasetSummary, type RunDatasetWithTags } from '../types';\n\nexport const datasetSummariesEqual = (summary1: DatasetSummary, summary2: DatasetSummary) =>\n  summary1.digest === summary2.digest && summary1.name === summary2.name && summary1.context === summary2.context;\n\nexport const getDatasetSourceUrl = (datasetWithTags: RunDatasetWithTags) => {\n  const { dataset } = datasetWithTags;\n  const sourceType = dataset.sourceType;\n  try {\n    if (sourceType === DatasetSourceTypes.HTTP) {\n      const { url } = JSON.parse(dataset.source);\n      return url;\n    }\n    if (sourceType === DatasetSourceTypes.S3) {\n      const { uri } = JSON.parse(dataset.source);\n      return uri;\n    }\n    if (sourceType === DatasetSourceTypes.HUGGING_FACE) {\n      const { path } = JSON.parse(dataset.source);\n      return `https://huggingface.co/datasets/${path}`;\n    }\n  } catch {\n    return null;\n  }\n  return null;\n};\n","import React, { useState } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { Button, type ButtonProps, Tooltip } from '@databricks/design-system';\n\ninterface CopyButtonProps extends Partial<ButtonProps> {\n  copyText: string;\n  showLabel?: React.ReactNode;\n}\n\nexport const CopyButton = ({ copyText, showLabel = true, ...buttonProps }: CopyButtonProps) => {\n  const [showTooltip, setShowTooltip] = useState(false);\n\n  const handleClick = () => {\n    navigator.clipboard.writeText(copyText);\n    setShowTooltip(true);\n    setTimeout(() => {\n      setShowTooltip(false);\n    }, 3000);\n  };\n\n  const handleMouseLeave = () => {\n    setShowTooltip(false);\n  };\n\n  return (\n    <Tooltip\n      title={\n        <FormattedMessage defaultMessage=\"Copied\" description=\"Tooltip text shown when copy operation completes\" />\n      }\n      dangerouslySetAntdProps={{\n        visible: showTooltip,\n      }}\n    >\n      <Button\n        componentId=\"codegen_mlflow_app_src_shared_building_blocks_copybutton.tsx_35\"\n        type=\"primary\"\n        onClick={handleClick}\n        onMouseLeave={handleMouseLeave}\n        css={{ 'z-index': 1 }}\n        // Define children as a explicit prop so it can be easily overrideable\n        children={\n          showLabel ? <FormattedMessage defaultMessage=\"Copy\" description=\"Button text for copy button\" /> : undefined\n        }\n        {...buttonProps}\n      />\n    </Tooltip>\n  );\n};\n","import {\n  ArrowLeftIcon,\n  ArrowRightIcon,\n  CloseIcon,\n  DesignSystemContext,\n  RedoIcon,\n  UndoIcon,\n  ZoomInIcon,\n  ZoomOutIcon,\n} from '@databricks/design-system';\nimport { useContext } from 'react';\nimport RcImage from 'rc-image';\nimport './Image.css';\n\nconst icons = {\n  rotateLeft: <UndoIcon />,\n  rotateRight: <RedoIcon />,\n  zoomIn: <ZoomInIcon />,\n  zoomOut: <ZoomOutIcon />,\n  close: <CloseIcon />,\n  left: <ArrowLeftIcon />,\n  right: <ArrowRightIcon />,\n};\n\nexport const ImagePreviewGroup = ({\n  children,\n  visible,\n  onVisibleChange,\n}: {\n  children: React.ReactNode;\n  visible: boolean;\n  onVisibleChange: (v: boolean) => void;\n}) => {\n  const { getPopupContainer } = useContext(DesignSystemContext);\n\n  return (\n    <RcImage.PreviewGroup\n      icons={icons}\n      preview={{\n        visible: visible,\n        getContainer: getPopupContainer,\n        onVisibleChange: (v) => onVisibleChange(v),\n      }}\n    >\n      {children}\n    </RcImage.PreviewGroup>\n  );\n};\n\nexport { RcImage as Image };\n","import React from 'react';\nimport { useSyncExternalStore } from 'use-sync-external-store/shim';\n\nfunction useMatchesMediaQuery(queryList: MediaQueryList) {\n  return useSyncExternalStore(\n    React.useCallback(\n      (callback) => {\n        queryList.addEventListener('change', callback);\n        return () => {\n          queryList.removeEventListener('change', callback);\n        };\n      },\n      [queryList],\n    ),\n    () => queryList.matches,\n  );\n}\n\n/**\n * React hook that listens for changes to a [media query][media-query]. Uses\n * [`window.matchMedia()`][match-media] under-the-hood.\n *\n * [media-query]: https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_media_queries/Using_media_queries\n * [match-media]: https://developer.mozilla.org/en-US/docs/Web/API/Window/matchMedia\n *\n * @usage\n *\n * ```tsx\n * function FancyButton() {\n *   const prefersReducedMotion = useMediaQuery('(prefers-reduced-motion)');\n *   return prefersReducedMotion ? <Button /> : <DancingButton />;\n * }\n * ```\n *\n * > **Note**\n * > The vast majority of use-cases can (and should) use vanilla CSS media\n * > queries instead of this hook — which will cause a re-render when the match\n * > state changes. Usage of this hook should be reserved for use-cases where\n * > CSS cannot be used instead.\n * >\n * > ```tsx\n * > <Button css={{ 'not (prefers-reduced-motion)': { animation: … } }} />\n * > ```\n */\nexport function useMediaQuery(query: string) {\n  // Note: a new MediaQueryList is created with every _usage_ of this hook.\n  // It's probably cheap to create many instances of MediaQueryList, and\n  // garbage collection will still clean up as expected, but consider using a\n  // [weak cache](https://github.com/tc39/proposal-weakrefs#weak-caches) to\n  // reuse MediaQueryLists where possible if performance is impacted.\n  const queryList = React.useMemo(() => window.matchMedia(query), [query]);\n  return useMatchesMediaQuery(queryList);\n}\n","/**\n * Adapted from `duotone-dark`\n * Ref: https://github.com/react-syntax-highlighter/react-syntax-highlighter/blob/b2457268891948f7005ccf539a70c000f0695bde/src/styles/prism/duotone-dark.js\n */\n\nconst databricksDuotoneDarkTheme = {\n  'code[class*=\"language-\"]': {\n    fontFamily:\n      'Consolas, Menlo, Monaco, \"Andale Mono WT\", \"Andale Mono\", \"Lucida Console\", \"Lucida Sans Typewriter\", \"DejaVu Sans Mono\", \"Bitstream Vera Sans Mono\", \"Liberation Mono\", \"Nimbus Mono L\", \"Courier New\", Courier, monospace',\n    fontSize: '14px',\n    lineHeight: '1.375',\n    direction: 'ltr',\n    textAlign: 'left',\n    whiteSpace: 'pre',\n    wordSpacing: 'normal',\n    wordBreak: 'normal',\n    MozTabSize: '4',\n    OTabSize: '4',\n    tabSize: '4',\n    WebkitHyphens: 'none',\n    MozHyphens: 'none',\n    msHyphens: 'none',\n    hyphens: 'none',\n    background: '#2a2734',\n    color: '#5DFAFC', // D\n  },\n  'pre[class*=\"language-\"]': {\n    fontFamily:\n      'Consolas, Menlo, Monaco, \"Andale Mono WT\", \"Andale Mono\", \"Lucida Console\", \"Lucida Sans Typewriter\", \"DejaVu Sans Mono\", \"Bitstream Vera Sans Mono\", \"Liberation Mono\", \"Nimbus Mono L\", \"Courier New\", Courier, monospace',\n    fontSize: '14px',\n    lineHeight: '1.375',\n    direction: 'ltr',\n    textAlign: 'left',\n    whiteSpace: 'pre',\n    wordSpacing: 'normal',\n    wordBreak: 'normal',\n    MozTabSize: '4',\n    OTabSize: '4',\n    tabSize: '4',\n    WebkitHyphens: 'none',\n    MozHyphens: 'none',\n    msHyphens: 'none',\n    hyphens: 'none',\n    background: '#2a2734',\n    color: '#5DFAFC', // D\n    padding: '1em',\n    margin: '.5em 0',\n    overflow: 'auto',\n  },\n  'pre > code[class*=\"language-\"]': {\n    fontSize: '1em',\n  },\n  'pre[class*=\"language-\"]::-moz-selection': {\n    textShadow: 'none',\n    background: '#6a51e6',\n  },\n  'pre[class*=\"language-\"] ::-moz-selection': {\n    textShadow: 'none',\n    background: '#6a51e6',\n  },\n  'code[class*=\"language-\"]::-moz-selection': {\n    textShadow: 'none',\n    background: '#6a51e6',\n  },\n  'code[class*=\"language-\"] ::-moz-selection': {\n    textShadow: 'none',\n    background: '#6a51e6',\n  },\n  'pre[class*=\"language-\"]::selection': {\n    textShadow: 'none',\n    background: '#6a51e6',\n  },\n  'pre[class*=\"language-\"] ::selection': {\n    textShadow: 'none',\n    background: '#6a51e6',\n  },\n  'code[class*=\"language-\"]::selection': {\n    textShadow: 'none',\n    background: '#6a51e6',\n  },\n  'code[class*=\"language-\"] ::selection': {\n    textShadow: 'none',\n    background: '#6a51e6',\n  },\n  ':not(pre) > code[class*=\"language-\"]': {\n    padding: '.1em',\n    borderRadius: '.3em',\n  },\n  comment: {\n    color: '#6c6783',\n  },\n  prolog: {\n    color: '#6c6783',\n  },\n  doctype: {\n    color: '#6c6783',\n  },\n  cdata: {\n    color: '#6c6783',\n  },\n  punctuation: {\n    color: '#6c6783',\n  },\n  namespace: {\n    Opacity: '.7',\n  },\n  tag: {\n    color: '#3AACE2', // D\n  },\n  operator: {\n    color: '#3AACE2', // D\n  },\n  number: {\n    color: '#3AACE2', // D\n  },\n  property: {\n    color: '#5DFAFC', // D\n  },\n  function: {\n    color: '#5DFAFC', // D\n  },\n  'tag-id': {\n    color: '#eeebff',\n  },\n  selector: {\n    color: '#eeebff',\n  },\n  'atrule-id': {\n    color: '#eeebff',\n  },\n  'code.language-javascript': {\n    color: '#c4b9fe',\n  },\n  'attr-name': {\n    color: '#c4b9fe',\n  },\n  'code.language-css': {\n    color: '#ffffff', // D\n  },\n  'code.language-scss': {\n    color: '#ffffff', // D\n  },\n  boolean: {\n    color: '#ffffff', // D\n  },\n  string: {\n    color: '#ffffff', // D\n  },\n  entity: {\n    color: '#ffffff', // D\n    cursor: 'help',\n  },\n  url: {\n    color: '#ffffff', // D\n  },\n  '.language-css .token.string': {\n    color: '#ffffff', // D\n  },\n  '.language-scss .token.string': {\n    color: '#ffffff', // D\n  },\n  '.style .token.string': {\n    color: '#ffffff', // D\n  },\n  'attr-value': {\n    color: '#ffffff', // D\n  },\n  keyword: {\n    color: '#ffffff', // D\n  },\n  control: {\n    color: '#ffffff', // D\n  },\n  directive: {\n    color: '#ffffff', // D\n  },\n  unit: {\n    color: '#ffffff', // D\n  },\n  statement: {\n    color: '#ffffff', // D\n  },\n  regex: {\n    color: '#ffffff', // D\n  },\n  atrule: {\n    color: '#ffffff', // D\n  },\n  placeholder: {\n    color: '#ffffff', // D\n  },\n  variable: {\n    color: '#ffffff', // D\n  },\n  deleted: {\n    textDecoration: 'line-through',\n  },\n  inserted: {\n    borderBottom: '1px dotted #eeebff',\n    textDecoration: 'none',\n  },\n  italic: {\n    fontStyle: 'italic',\n  },\n  important: {\n    fontWeight: 'bold',\n    color: '#c4b9fe',\n  },\n  bold: {\n    fontWeight: 'bold',\n  },\n  'pre > code.highlight': {\n    Outline: '.4em solid #8a75f5',\n    OutlineOffset: '.4em',\n  },\n  '.line-numbers.line-numbers .line-numbers-rows': {\n    borderRightColor: '#2c2937',\n  },\n  '.line-numbers .line-numbers-rows > span:before': {\n    color: '#3c3949',\n  },\n  '.line-highlight.line-highlight': {\n    background: 'linear-gradient(to right, rgba(224, 145, 66, 0.2) 70%, rgba(224, 145, 66, 0))',\n  },\n};\n\nexport default databricksDuotoneDarkTheme;\n","/**\n * Adapted from `material-light`\n * Ref: https://github.com/react-syntax-highlighter/react-syntax-highlighter/blob/b2457268891948f7005ccf539a70c000f0695bde/src/styles/prism/material-light.js#L1\n *\n * This theme overwrites colors to be similiar to the `@databricks/editor` theme.\n */\n\nconst databricksLightTheme = {\n  'code[class*=\"language-\"]': {\n    textAlign: 'left',\n    whiteSpace: 'pre',\n    wordSpacing: 'normal',\n    wordBreak: 'normal',\n    wordWrap: 'normal',\n    color: 'rgb(77, 77, 76)', // D\n    background: '#fafafa',\n    fontFamily: 'Monaco, Menlo, Ubuntu Mono, Consolas, source-code-pro, monospace',\n    fontSize: '12px', // D\n    lineHeight: '1.5em',\n    MozTabSize: '4',\n    OTabSize: '4',\n    tabSize: '4',\n    WebkitHyphens: 'none',\n    MozHyphens: 'none',\n    msHyphens: 'none',\n    hyphens: 'none',\n  },\n  'pre[class*=\"language-\"]': {\n    textAlign: 'left',\n    whiteSpace: 'pre',\n    wordSpacing: 'normal',\n    wordBreak: 'normal',\n    wordWrap: 'normal',\n    color: 'rgb(77, 77, 76)', // D\n    background: '#fafafa',\n    fontFamily: 'Monaco, Menlo, Ubuntu Mono, Consolas, source-code-pro, monospace',\n    fontSize: '12px', // D\n    lineHeight: '1.5em',\n    MozTabSize: '4',\n    OTabSize: '4',\n    tabSize: '4',\n    WebkitHyphens: 'none',\n    MozHyphens: 'none',\n    msHyphens: 'none',\n    hyphens: 'none',\n    overflow: 'auto',\n    position: 'relative',\n    margin: '0.5em 0',\n    padding: '1.25em 1em',\n  },\n  'code[class*=\"language-\"]::-moz-selection': {\n    background: '#cceae7',\n    color: '#263238',\n  },\n  'pre[class*=\"language-\"]::-moz-selection': {\n    background: '#cceae7',\n    color: '#263238',\n  },\n  'code[class*=\"language-\"] ::-moz-selection': {\n    background: '#cceae7',\n    color: '#263238',\n  },\n  'pre[class*=\"language-\"] ::-moz-selection': {\n    background: '#cceae7',\n    color: '#263238',\n  },\n  'code[class*=\"language-\"]::selection': {\n    background: '#cceae7',\n    color: '#263238',\n  },\n  'pre[class*=\"language-\"]::selection': {\n    background: '#cceae7',\n    color: '#263238',\n  },\n  'code[class*=\"language-\"] ::selection': {\n    background: '#cceae7',\n    color: '#263238',\n  },\n  'pre[class*=\"language-\"] ::selection': {\n    background: '#cceae7',\n    color: '#263238',\n  },\n  ':not(pre) > code[class*=\"language-\"]': {\n    whiteSpace: 'normal',\n    borderRadius: '0.2em',\n    padding: '0.1em',\n  },\n  '.language-css > code': {\n    color: '#f5871f', // D\n  },\n  '.language-sass > code': {\n    color: '#f5871f', // D\n  },\n  '.language-scss > code': {\n    color: '#f5871f', // D\n  },\n  '[class*=\"language-\"] .namespace': {\n    Opacity: '0.7',\n  },\n  atrule: {\n    color: '#7c4dff',\n  },\n  'attr-name': {\n    color: '#39adb5',\n  },\n  'attr-value': {\n    color: '#f6a434',\n  },\n  attribute: {\n    color: '#f6a434',\n  },\n  boolean: {\n    color: '#7c4dff', // D\n  },\n  builtin: {\n    color: '#39adb5',\n  },\n  cdata: {\n    color: '#39adb5',\n  },\n  char: {\n    color: '#39adb5',\n  },\n  class: {\n    color: '#39adb5',\n  },\n  'class-name': {\n    color: '#6182b8',\n  },\n  comment: {\n    color: '#8e908c', // D\n  },\n  constant: {\n    color: '#7c4dff', // D\n  },\n  deleted: {\n    color: '#e53935',\n  },\n  doctype: {\n    color: '#aabfc9',\n  },\n  entity: {\n    color: '#e53935',\n  },\n  function: {\n    color: '#4271ae', // D\n  },\n  hexcode: {\n    color: '#f5871f', // D\n  },\n  id: {\n    color: '#7c4dff',\n    fontWeight: 'bold',\n  },\n  important: {\n    color: '#7c4dff',\n    fontWeight: 'bold',\n  },\n  inserted: {\n    color: '#39adb5',\n  },\n  keyword: {\n    color: '#8959a8', // D\n  },\n  number: {\n    color: '#f5871f', // D\n  },\n  operator: {\n    color: '#3e999f', // D\n  },\n  prolog: {\n    color: '#aabfc9',\n  },\n  property: {\n    color: '#39adb5',\n  },\n  'pseudo-class': {\n    color: '#f6a434',\n  },\n  'pseudo-element': {\n    color: '#f6a434',\n  },\n  punctuation: {\n    color: 'rgb(77, 77, 76)', // D\n  },\n  regex: {\n    color: '#6182b8',\n  },\n  selector: {\n    color: '#e53935',\n  },\n  string: {\n    color: '#3ba85f', // D\n  },\n  symbol: {\n    color: '#7c4dff',\n  },\n  tag: {\n    color: '#e53935',\n  },\n  unit: {\n    color: '#f5871f', // D\n  },\n  url: {\n    color: '#e53935',\n  },\n  variable: {\n    color: '#c72d4c', // D\n  },\n};\n\nexport default databricksLightTheme;\n","import { PrismLight as SyntaxHighlighter } from 'react-syntax-highlighter';\nimport python from 'react-syntax-highlighter/dist/cjs/languages/prism/python';\nimport json from 'react-syntax-highlighter/dist/cjs/languages/prism/json';\n\nSyntaxHighlighter.registerLanguage('python', python);\nSyntaxHighlighter.registerLanguage('json', json);\n\nimport duotoneDarkStyle from './theme/databricks-duotone-dark';\nimport lightStyle from './theme/databricks-light';\nimport { CSSProperties, ReactNode } from 'react';\nimport { pick } from 'lodash';\n\nexport type CodeSnippetTheme = 'duotoneDark' | 'light';\n\nexport const buttonBackgroundColorDark = 'rgba(140, 203, 255, 0)';\nexport const buttonColorDark = 'rgba(255, 255, 255, 0.84)';\nexport const buttonHoverColorDark = '#8ccbffcc';\nexport const buttonHoverBackgroundColorDark = 'rgba(140, 203, 255, 0.08)';\nexport const duboisAlertBackgroundColor = '#fff0f0';\nexport const snippetPadding = '24px';\n\nconst themesStyles: Record<CodeSnippetTheme, any> = {\n  light: lightStyle,\n  duotoneDark: duotoneDarkStyle,\n};\n\nexport type CodeSnippetLanguage = 'python' | 'json';\n\nexport interface CodeSnippetProps {\n  /**\n   * The code string\n   */\n  children: string;\n  /**\n   * The actions that are displayed on the right top corner of the component\n   *  see `./actions` for built-in actions\n   */\n  actions?: NonNullable<ReactNode> | NonNullable<ReactNode>[];\n  /**\n   * The theme, default theme is `light`\n   */\n  theme?: CodeSnippetTheme;\n  /**\n   * Language of the code (`children`)\n   */\n  language: CodeSnippetLanguage;\n  /**\n   * Custom styles (passed to the internal `<pre>`)\n   */\n  style?: CSSProperties;\n  /**\n   * Whether to show line numbers on the left or not\n   */\n  showLineNumbers?: boolean;\n  /**\n   * Custom styles for line numbers\n   */\n  lineNumberStyle?: CSSProperties;\n  /**\n   * Whether or not to wrap long lines\n   */\n  wrapLongLines?: boolean;\n}\n\n/**\n * `CodeSnippet` is used for highlighting code, use this instead of\n */\nexport function CodeSnippet({\n  theme = 'light',\n  language,\n  actions,\n  style,\n  children,\n  showLineNumbers,\n  lineNumberStyle,\n  wrapLongLines,\n}: CodeSnippetProps) {\n  const customStyle = {\n    border: 'none',\n    borderRadius: 0,\n    margin: 0,\n    padding: snippetPadding,\n    ...style,\n  };\n\n  return (\n    <>\n      <SyntaxHighlighter\n        showLineNumbers={showLineNumbers}\n        lineNumberStyle={lineNumberStyle}\n        language={language}\n        style={themesStyles[theme]}\n        customStyle={customStyle}\n        codeTagProps={{\n          style: pick(style, 'backgroundColor'),\n        }}\n        wrapLongLines={wrapLongLines}\n      >\n        {children}\n      </SyntaxHighlighter>\n    </>\n  );\n}\n"],"names":["_path","_rect","_rect2","_rect3","_rect4","_extends","Object","assign","bind","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","this","SvgChartBar","_ref","svgRef","title","titleId","props","width","height","viewBox","fill","xmlns","ref","id","d","stroke","strokeLinecap","x","y","ForwardRef","_path2","_path3","SvgChartContour","_rect5","_rect6","_rect7","_rect8","_rect9","_rect10","_rect11","_rect12","_rect13","_rect14","_rect15","_rect16","_rect17","_rect18","SvgChartDifference","_line","_line2","_line3","SvgChartImage","x1","y1","x2","y2","SvgChartLine","strokeWidth","strokeLinejoin","_path4","_path5","SvgChartParallel","_circle","_ellipse","_circle2","_circle3","_ellipse2","_ellipse3","SvgChartScatter","cx","cy","r","rx","ry","fillOpacity","_g","_defs","SvgRegisteredModelGreyOk","clipPath","style","maskType","maskUnits","mask","fillRule","clipRule","JsonPreview","json","wrapperStyle","overlayStyle","codeSnippetStyle","formattedJson","isJsonContent","useFormattedJson","_jsx","position","maxHeight","overflow","children","_jsxs","_Fragment","CodeSnippet","language","padding","overflowX","css","_css","bottom","right","left","background","React","parsed","JSON","parse","isJson","isObject","Date","stringify","e","_ref3","name","styles","FormattedJsonDisplay","_ref2","wrapLongLines","Paragraph","Typography","KeyValueTagFullViewModal","theme","useDesignSystemTheme","Modal","tagKey","visible","isKeyValueTagFullViewModalVisible","onCancel","setIsKeyValueTagFullViewModalVisible","backgroundColor","colors","backgroundPrimary","marginTop","spacing","sm","whiteSpace","wordBreak","tagValue","CopyButton","copyText","showLabel","icon","CopyIcon","TRUNCATE_ON_CHARS_LENGTH","getTruncatedStyles","undefined","textOverflow","textWrap","KeyValueTag","isClosable","onClose","tag","enableFullViewModal","charLimit","maxWidth","className","intl","useIntl","useState","shouldTruncateKey","shouldTruncateValue","value","fullLength","isKeyLonger","shorterLength","getKeyAndValueComplexTruncation","allowFullViewModal","fullViewModalLabel","formatMessage","defaultMessage","Tag","closable","Tooltip","display","onClick","Text","bold","ToggleIconButton","pressed","onBlur","onFocus","onMouseEnter","onMouseLeave","componentId","analyticsEvents","type","remainingProps","eventContext","useDesignSystemEventComponentCallbacks","componentType","DesignSystemEventProviderComponentTypes","Button","DesignSystemEventProviderAnalyticsEventTypes","OnClick","event","cursor","general","heightSm","borderRadius","borders","borderRadiusMd","lineHeight","typography","lineHeightBase","border","alignItems","justifyContent","actionDefaultBackgroundPress","color","actionDefaultTextPress","textSecondary","actionDefaultBackgroundHover","actionDefaultTextHover","useDragAndDropElement","dragGroupKey","dragKey","onDrop","disabled","dropListener","useRef","useEffect","current","isOver","draggedItem","dropTargetRef","useDrop","canDrop","accept","drop","monitor","sourceKey","didDrop","collect","shallow","getItem","isDragging","dragHandleRef","dragPreviewRef","useDrag","canDrag","item","groupKey","isDraggingOtherGroup","Boolean","_ref4","DragAndDropProvider","rootElementRef","manager","setManager","useLayoutEffect","rootElement","dragDropManager","createDragDropManager","HTML5Backend","getBackend","teardown","DndProvider","getDropdownMenu","allAvailableTags","menu","searchValue","toLowerCase","useMemo","sortedIndexOf","isValidTagKey","test","flattenOptions","data","actionTertiaryTextDefault","actionDisabledText","placement","PlusIcon","marginRight","groupOption","DropdownMenu","TagKeySelectDropdown","control","onKeyChangeCallback","isOpen","setIsOpen","selectRef","field","fieldState","useController","rules","required","message","LegacySelect","allowClear","dangerouslySetAntdProps","showSearch","dropdownRender","placeholder","defaultValue","open","onDropdownVisibleChange","filterOption","input","option","includes","onSelect","onChange","onClear","handleClear","validationState","error","map","Option","getTagsMap","tags","Map","useEditKeyValueTagsModal","onSuccess","saveTagsHandler","valueRequired","editedEntityRef","errorMessage","setErrorMessage","initialTags","setInitialTags","finalTags","setFinalTags","showModal","setShowModal","form","useForm","defaultValues","hideModal","showEditTagsModal","useCallback","editedEntity","reset","saveTags","async","setIsLoading","Array","from","values","then","catch","_e$getUserVisibleErro","ErrorWrapper","getUserVisibleError","formValues","watch","isLoading","hasNewValues","isEqual","sortBy","isDirty","showPopoverMessage","EditTagsModal","destroyOnClose","FormattedMessage","footer","RestoreAntDDefaultClsPrefix","dangerouslyUseFocusPseudoClass","UnsavedTagPopoverTrigger","onSaveTask","loading","onSubmit","handleSubmit","trim","newEntries","set","gap","md","minWidth","flex","FormUI","Label","htmlFor","_tag$value","get","setValue","RHFControlledComponents","Input","htmlType","Message","rowGap","xs","flexWrap","currentFinalTags","delete","handleTagDelete","_ref6","_ref5","fullTagDisplay","truncate","shownText","Popover","Root","Trigger","asChild","Content","align","Close","marginLeft","Arrow","useIsTabActive","isTabActive","setIsTabActive","document","visibilityState","addEventListener","DEFAULT_MIN_COLUMNS","DEFAULT_MAX_COLUMNS","DEFAULT_MIN_COLUMN_WIDTH","DEFAULT_GAP","getGridColumnSetup","minColumns","maxColumns","minColumnWidth","additionalBreakpoints","gridTemplateColumns","reduce","acc","breakpointWidth","minColumnWidthForBreakpoint","LocalStorageUtils","getStoreForComponent","componentName","LocalStorageStore","join","getSessionScopedStoreForComponent","version","constructor","scope","storageObj","window","localStorage","sessionStorage","loadComponentState","storedVal","reactComponentStateKey","saveComponentState","stateRecord","targetValue","toJSON","setItem","withScopePrefix","ExperimentSourceTypeIcon","sourceType","SourceType","NOTEBOOK","NotebookIcon","LOCAL","HomeIcon","PROJECT","FolderBranchIcon","JOB","WorkflowsIcon","ErrorIcon","XCircleIcon","textValidationDanger","FinishedIcon","CheckCircleIcon","textValidationSuccess","RunStatusIcon","status","ClockIcon","HIGH_RESOLUTION_MEDIA_QUERY","RunColorPill","hidden","onChangeColor","colorValue","setColorValue","onChangeColorDebounced","debounce","flexShrink","marginBottom","opacity","visuallyHidden","list","COLORS_PALETTE_DATALIST_ID","ExperimentViewDatasetSchemaTable","schema","filter","filteredSchema","row","_","hasFilter","Table","scrollable","TableRow","isHeader","TableHeader","onWheel","stopPropagation","TableCell","idx","_ref7","_ref8","_ref9","_ref10","ExperimentViewDatasetSchema","datasetWithTags","dataset","setFilter","Header","grey600","TableFilterInput","containerProps","mlflow_colspec","TableIcon","fontSize","lg","ExperimentViewDatasetLink","runTags","DatasetSourceTypes","HTTP","HUGGING_FACE","url","getDatasetSourceUrl","NewWindowIcon","href","S3","EXTERNAL","ExperimentViewDatasetSourceType","typeLabel","Hint","ExperimentViewDatasetSourceURL","fontSizeSm","columnGap","Link","openInNewTab","uri","ExperimentViewDatasetDigest","digest","ExperimentViewDatasetDrawerImpl","_datasetWithTags$tags","selectedDatasetWithRun","setSelectedDatasetWithRun","runData","contextTag","find","MLFLOW_RUN_DATASET_CONTEXT_TAG","fullProfile","profile","getRunColor","useGetExperimentRunColor","experimentId","Drawer","onOpenChange","Title","level","to","Routes","getRunPageRoute","runUuid","runLink","runName","Spacer","size","borderTop","flexDirection","borderRight","paddingLeft","datasets","backgroundSecondary","paddingBottom","paddingTop","ExperimentViewDatasetWithContext","displayTextAsLink","ellipsis","textTransform","substring","Divider","ExperimentViewDatasetDrawer","_tags$find","ExperimentPageUISetStateContext","state","ExperimentPageUIStateContextProvider","setUIState","Provider","useUpdateExperimentViewUIState","useExperimentIds","params","useParams","location","useLocation","normalizedLocationSearch","decodeURIComponent","search","compareExperimentIdsQueryParam","queryParams","qs","experimentIdsRaw","toString","Utils","logErrorAndNotifyUser","usePopulateImagesByRunUuid","runUuids","runUuidsIsActive","autoRefreshEnabled","enabled","dispatch","useDispatch","runUuidsSerialized","slice","NUM_RUNS_TO_SUPPORT_FOR_LOG_IMAGE","split","forEach","listImagesApi","refreshTimeoutRef","autoRefreshEnabledRef","runUuidsIsActiveSerialized","hookUnmounted","fetchImagesFn","activeRunUuids","autoRefresh","index","scheduleRefresh","clearTimeout","setTimeout","EXPERIMENT_RUNS_IMAGE_AUTO_REFRESH_INTERVAL","ConfirmModal","Component","super","isSubmitting","onRequestCloseHandler","handleSubmitWrapper","setState","finally","render","onOk","okText","confirmButtonText","confirmLoading","centered","helpText","DeleteRunModalImpl","deletePromises","selectedRunIds","runId","push","deleteRunApi","Promise","all","errorModalContent","openErrorModal","_this$props$onSuccess","_this$props","number","pluralize","mapDispatchToProps","connect","injectIntl","GenericInputModal","formRef","validateFields","resetAndClearModalForm","handleSubmitFailure","reject","resetFields","handleCancel","cancelText","displayForm","child","innerRef","NEW_NAME_FIELD","RenameFormComponent","inputToAutoFocus","autoFocusInputRef","focus","select","autoFocus","prevProps","componentDidUpdate","Form","layout","Item","initialValue","validator","label","RenameForm","RenameRunModalImpl","handleRenameRun","newRunName","updateRunRequestId","getUUID","updateRunApi","Error","RenameRunModalWithIntl","RenameRunModal","RunsChartsConfigureField","RunsChartsMetricParamSelect","metricKeyList","paramKeyList","isEmpty","selectFull","OptGroup","metric","makeCanonicalSortKey","param","RunsChartsRunNumberSelect","options","shouldUseNewRunRowsVisibilityModel","countOption","optionValue","runsChartsRunCountDefaultOptions","RunsChartsConfigureBarChart","onStateChange","updateMetric","metricKey","updateVisibleRunCount","runsCountToCompare","emptyMetricsList","RunsChartsConfigureParallelChart","updateSelectedParams","selectedParams","updateSelectedMetrics","selectedMetrics","emptyParamsList","mode","renderMetricSelectorV2","selectedMetricKeys","renderXAxisMetricSelector","selectedXAxisMetricKey","updateSelectedXAxisMetricKey","Radio","RunsChartsLineChartXAxisType","METRIC","preventDefault","RunsChartsConfigureLineChart","shouldEnableMetricsOnXAxis","shouldEnableDeepLearningUIPhase3","metricKeys","updateXAxisKey","xAxisKey","updateXAxisScaleType","isLogType","xAxisScaleType","updateYAxisType","scaleType","updateSmoothing","lineSmoothness","Group","STEP","TIME","QuestionMarkIcon","timeStepQuestionMarkIcon","TIME_RELATIVE","Switch","checked","SegmentedControlGroup","displayPoints","SegmentedControlButton","InfoIcon","LineSmoothSlider","min","max","svg","RunsChartsConfigureLineChartPreview","entities","metricsByRunUuid","areStatesEqual","nextState","prevState","previewData","cardConfig","groupBy","usingMultipleRunsHoverTooltip","isGrouped","some","groupParentInfo","aggregateFunction","runUuidsToFetch","compact","flatMap","g","belongsToGroup","_r$runInfo","runInfo","metricKeysToFetch","_cardConfig$selectedM","fallback","yAxisKeys","xAxisKeys","concat","resultsByRunUuid","useSampledMetricHistory","maxResults","sampledData","run","metricsHistory","_resultsByRunUuid$run","_resultsByRunUuid$run2","history","uuid","sampledGroupData","useGroupedChartRunData","ungroupedRunsData","sampledDataResultsByRunUuid","chartData","setTooltip","resetTooltip","useRunsChartsTooltip","RunsChartsTooltipMode","MultipleTracesWithScanline","Simple","LegacySkeleton","RunsMetricsLinePlot","runsData","useDefaultHoverBox","onHover","onUnhover","RunsChartsConfigureContourChart","updateAxis","canonicalKey","axis","isCanonicalSortKeyOfType","extractCanonicalSortKey","_state$xaxis","_state$yaxis","_state$zaxis","firstMetric","firstParam","xaxis","yaxis","zaxis","scatterPlotDefaultOptions","RunsChartsConfigureScatterChart","RunsChartsConfigureDifferenceChart","updateCompareGroups","compareGroup","compareGroups","group","updateChartName","chartName","updateShowChangeFromBaseline","showChangeFromBaseline","updateShowDifferencesOnly","showDifferencesOnly","Checkbox","DifferenceCardConfigCompareGroup","_state$compareGroups","groupedCondition","DISABLED_GROUP_WHEN_GROUPBY","isChecked","InfoTooltip","RunsChartsConfigureImageChart","imageKeyList","stepMarks","maxMark","minMark","useImageSliderStepMarks","selectedImageKeys","imageKeys","updateStep","step","handleUpdate","imageKey","_currentConfig$imageK","currentConfig","_currentConfig$imageK2","DialogCombobox","multiSelect","DialogComboboxTrigger","DialogComboboxContent","matchTriggerWidth","DialogComboboxOptionList","_state$imageKeys","DialogComboboxOptionListCheckboxItem","marks","keys","previewComponentsMap","RunsChartType","BAR","RunsMetricsBarPlot","displayRunNames","displayMetricKey","margin","barChartCardDefaultMargin","CONTOUR","RunsContourPlot","xAxis","yAxis","zAxis","LINE","PARALLEL","_cardConfig$selectedP","isConfigured","_cardConfig$selectedP2","paramKey","dataTrace","_dataTrace$params$par","isNaN","Number","filteredData","processParallelCoordinateData","LazyParallelCoordinatesPlot","axesRotateThreshold","SCATTER","RunsScatterPlot","DIFFERENCE","setCardConfig","DifferenceViewPlot","IMAGE","ImageGridPlot","containerWidth","RunsChartsConfigureModal","config","chartRunData","supportedChartTypes","isChartTypeSupported","currentFormState","setCurrentFormState","isEditing","updateChartType","emptyChartCard","RunsChartsCardConfig","getEmptyChartCardByType","reverse","Set","images","add","sort","disableSaveButton","_lineCardConfig$selec","okButtonProps","wrapper","chartTypeOption","ChartBarIcon","ChartScatterIcon","ChartLineIcon","ChartParallelIcon","ChartContourIcon","shouldEnableDifferenceViewCharts","ChartDifferenceIcon","shouldEnableImageGridCharts","ChartImageIcon","RunsChartsTooltipWrapper","contextData","runs","component","RunsChartsTooltipBody","hoverOnly","chartWrapper","PreviewComponent","renderPreviewChartType","iconSize","RunsChartsFullScreenModal","isMetricHistoryLoading","fullScreenChart","tooltipContextValue","tooltipComponent","getPrefixedClassName","subtitle","verticalSizing","RunsChartsCard","sectionIndex","fullScreen","onRemoveChart","onReorderCharts","onStartEditChart","setFullScreenChart","canMoveDown","canMoveUp","onMoveDown","onMoveUp","onReorderWith","createLineChartValuesBox","activeRun","hoverData","_hoverData$metricEnti","_hoverData$yValue","metricKeyFromConfig","metricEntity","metricValue","yValue","metrics","isNil","xValue","getTooltipXValue","_hoverData$xValue","_hoverData$xValue2","shouldEnableRelativeTimeDateAxis","ValuesBox","isHovering","createBarChartValuesBox","createScatterChartValuesBox","_activeRun$metrics$xK","_activeRun$params$xKe","_activeRun$metrics$yK","_activeRun$params$yKe","xKey","yKey","createContourChartValuesBox","_activeRun$metrics$xK2","_activeRun$params$xKe2","_activeRun$metrics$yK2","_activeRun$params$yKe2","_activeRun$metrics$zK","_activeRun$params$zKe","zKey","zValue","createParallelChartValuesBox","paramsList","metricsList","closeContextMenu","onTogglePin","onHideRun","containsMultipleRunsTooltipData","RunsMultipleTracesTooltipBody","singleTraceHoverData","hoveredDataPoint","displayName","metricSuffix","contentWrapper","header","colorPill","CloseIcon","actionsWrapper","pinnable","pinned","PinFillIcon","PinIcon","VisibleIcon","primary","PLOT_CONFIG","displaylogo","scrollZoom","modeBarButtonsToRemove","DEFAULT_COLOR_SCALE","markerSize","reverseScale","runsChartDefaultContourMargin","colorScale","onUpdate","selectedRunUuid","onSetDownloadHandler","layoutHeight","layoutWidth","setContainerDiv","containerDiv","isDynamicSizeSupported","useDynamicPlotSize","plotData","xValues","yValues","zValues","tooltipData","_xAxisData$xAxis$key","_yAxisData$yAxis$key","_zAxisData$zAxis$key","xAxisData","yAxisData","zAxisData","z","layers","customdata","text","hovertemplate","zAxisTitle","hoverinfo","hoverlabel","runsChartHoverlabel","textposition","marker","line","unshift","connectgaps","contours","coloring","colorscale","reversescale","colorbar","tickfont","family","plotlyThemedLayout","createThemedPlotlyLayout","setLayout","ticks","standoff","template","newLayout","setHoveredPointIndex","useRunsChartTraceHighlight","highlightScatterTraces","hoverCallback","_scatterPoints$pointI","_customdata","points","scatterPoints","curveNumber","pointIndex","pointCustomDataRunUuid","unhoverCallback","mutableHoverCallback","useMutableChartHoverCallback","legendLabelData","getLegendDataFromRuns","dataToExport","trace","createChartImageDownloadHandler","chart","commonRunsChartStyles","scatterChartHighlightStyles","LazyPlot","useResizeHandler","RunsMetricsLegendWrapper","labelData","doubleClick","showTips","runsChartDefaultMargin","barWidth","ids","names","_d$metrics$metricKey","normalizeChartValue","textValues","_d$metrics$metricKey2","val","places","toFixed","getFixedPointValue","textfont","orientation","showticklabels","fixedrange","highlightBarTraces","_points$0$data","_points$0$pointIndex","_points$","_points$2","layoutToExport","automargin","highlightStyles","transition","TraceLabel","dashStyle","TraceLabelColorIndicator","strokeDasharray","dashType","getDashArray","pathYOffset","STROKE_WIDTH","alignContent","overflowY","labelDatum","heightBuffer","RunsMetricsLegend","PLOTLY_DRAGLAYER_SELECTOR","parseMicroseconds","plotlyAxisBoundary","_plotlyAxisBoundary$m","microsecondsString","isString","match","orderBySteps","dataPoints","stepOrder","stepIndexes","a","b","createTooltipTemplate","prepareMetricHistoryByAxisType","metricHistory","axisType","timestamp","minTimestamp","minBy","_ref11","EPOCH_RELATIVE_TIME","_ref12","_ref13","TIME_RELATIVE_HOURS","_ref14","HOUR_IN_MILLISECONDS","_ref15","_ref16","prepareXAxisDataForMetricType","datapoint","_ref17","lineShape","xRange","yRange","lockXAxisZoom","dynamicXAxisKey","maxDiff","maxTimestamp","maxBy","diff","Math","LINE_CHART_RELATIVE_TIME_THRESHOLD","runEntry","_runEntry$metricsHist2","_runEntry$metricsHist","_yValues","_runEntry$runInfo","_yValues2","_runEntry$runInfo2","_runEntry$runInfo3","lineDash","sortedMetricsHistory","xValuesWithSteps","yValueHistory","optimizedLineShape","containsDuplicateXValues","shouldDisplayMarkers","containsSingleValue","EMA","hovertext","dash","shape","getDataTraceForRun","lineDashStyles","flat","bandsData","_ref18","_runEntry$runInfo4","aggregatedMetricsHistory","xMins","xMaxes","yMins","yMaxes","minReversed","bandValues","fillcolor","createFadedTraceColor","getBandTraceForRun","plotDataWithBands","highlightLineTraces","xAxisKeyLabel","getChartAxisLabelDescriptor","yAxisParams","showlegend","updatedLayout","containsMultipleMetricKeys","_ref19","_hoveredPoint$curveNu","_hoveredPointData$met","hoveredPoint","hoveredPointData","themedPlotlyLayout","immediateLayout","getXAxisType","range","getXAxisRange","tickformat","getLineChartLegendData","scanlineElement","initHandler","updateHandler","updateHandlerMultipleRuns","onPointHover","hoverCallbackMultipleRuns","onPointUnhover","unhoverCallbackMultipleRuns","chartBoundaries","containerLeftPixels","plotWidthPixels","plotOffsetPixels","lowerBoundValue","valueRange","mainContainer","dragLayer","initialized","scanlineElementRef","currentHoveredDataPoint","visibleXValues","uniq","initializedFigure","setInitializedFigure","immediateHoverData","immediateLegendLabelData","immediateRunsData","immediatePlotData","immediateXValuesData","setupBoundaries","figure","_figure$layout$xaxis","_figure$layout$xaxis$","_figure$layout$xaxis2","_figure$layout$xaxis3","_lowerBoundary","_upperBoundary","lowerAxisValue","upperAxisValue","lowerBoundary","isNumber","getTime","upperBoundary","updateContainerPosition","containerRect","getBoundingClientRect","dragLayerRect","onUpdatePlotHandler","graphDiv","querySelector","onInitPlotHandler","pointerLeavePlotCallback","relatedTarget","Element","classList","contains","onPointHoverCallback","singleTraceData","traceUuid","onPointUnhoverCallback","getClosestXValue","pointerClientX","boundaries","resultX","currentStep","abs","tooltipDataUpdateHandler","throttle","closestXValue","clientX","legendEntry","_correspondingDataTra","_correspondingDataTra2","correspondingDataEntry","correspondingDataTrace","xIndex","indexOf","isUndefined","tooltipLegendItems","orderBy","leading","windowResizeHandler","hoverHandler","_immediateHoverData$c","_immediateHoverData$c2","closestXValueLeftInPixels","log10","clientY","originalEvent","removeEventListener","top","borderLeft","pointerEvents","useRunsMultipleTracesTooltipData","legend","onInitialized","PlotlyLikeFormattedTime","FormattedDate","year","month","day","FormattedTime","hour","hourCycle","minute","second","fractionalSecondDigits","PlotlyLikeFormattedTimestamp","hoveredTraceUuid","displayedXValueLabel","textPlaceholder","fontWeight","_points$$customdata","RunsChartsChartsDragGroup","ChartRunsCountIndicator","runsOrGroups","containsGroups","containsRuns","count","RunsChartCardWrapper","onDelete","onEdit","tooltip","additionalMenuContent","toggleFullScreenChart","toggles","supportedDownloadFormats","onClickDownload","isRefreshing","gridTemplateRows","borderRadiusBase","element","DragIcon","String","Spinner","toggle","currentToggle","setToggle","toggleLabel","FullscreenIcon","modal","OverflowIcon","Separator","chartEntry","chartComponentWrapper","verticalAlign","t","l","pad","RunsChartsBarChartCard","slicedRuns","elementRef","isInViewport","useIsInViewport","imageDownloadHandler","setImageDownloadHandler","useChartImageDownloadHandler","chartBody","barChartCardWrapper","GENERAL_AREA","format","runsToExport","downloadChartDataCsv","getV2ChartTitle","RunsChartsLineChartCard","onDownloadFullMetricHistoryCsv","_r$runInfo2","_config$selectedMetri","destroyTooltip","sampledMetricsByRunUuid","useSelector","pick","shallowEqual","setRange","setOffsetTimestamp","stepRange","offsetTimestamp","findChartStepsByTimestampForRuns","lowerBound","floor","upperBound","ceil","useCompareRunChartSelectedRange","lineChartCardWrapper","newYRange","autorange","newXRange","ungroupedRunUuids","groupedRunUuids","_groupParentInfo$runU","timestampRange","findAbsoluteTimestampRangeForRelativeRange","_config$selectedMetri2","_config$selectedMetri3","savedChartTitle","downloadChartMetricHistoryCsv","singleRunUuids","_d$runInfo","runUuidsFromGroups","_group$groupParentInf","RunsChartsScatterChartCard","scatterChartCardWrapper","paramsToExport","metricsToExport","RunsChartsContourChartCard","contourChartCardWrapper","SvgParallelChartPlaceholder","gradientUnits","stopColor","offset","EmptyParallelCoordsPlaceholder","ParallelChartSvg","UnsupportedDataPlaceholder","RunsChartsParallelChartCard","updateUIState","configuredChartRunData","showAllRuns","containsStringValues","_config$selectedParam","updateVisibleOnlySetting","_state$compareRunChar","newCompareRunCharts","compareRunCharts","existingChartConfig","parallelCoordsData","_config$selectedParam2","configured","containsUnsupportedValues","displaySubtitle","parallelChartCardWrapper","PARALLEL_CHARTS_AREA","CheckboxItem","ItemIndicator","RunsChartsDifferenceChartCard","confirmChartCardConfiguration","useConfirmChartCardConfigurationFn","showChangeFromBaselineToggle","showDifferencesOnlyToggle","setter","showTooltip","RunsChartsImageChartCard","containerRef","setContainerWidth","resizeObserver","ResizeObserver","entries","contentRect","observe","disconnect","tmpConfig","setTmpConfig","DEFAULT_IMAGE_GRID_CHART_NAME","stepMarkLength","shouldDisplayImageLimitIndicator","LOG_IMAGE_TAG_INDICATOR","conf","onAfterChange","commonChartProps","differenceView","isDifferent","HEADING_COLUMN_ID","modelMetrics","systemMetrics","parameters","attributes","getDifferenceViewDataGroups","headingColumnId","getMetrics","filterCondition","runDataKeys","runDataAttribute","hasDifference","prev","startsWith","MLFLOW_SYSTEM_METRIC_PREFIX","getVisibleTagValues","DifferenceCardAttributes","USER","SOURCE","VERSION","MODELS","attribute","attributeData","user","getUser","getSourceName","getSourceVersion","models","getLoggedModelsFromTags","getData","MODEL_METRICS","SYSTEM_METRICS","PARAMETERS","ATTRIBUTES","TAGS","baselineColumn","nonBaselineColumns","baselineColumnUuid","getColumns","convertRunToColumnInfo","isBaseline","baselineAccessorFn","accessorFn","cell","getValue","difference","ArrowDownIcon","ArrowUpIcon","accessorKey","table","useReactTable","columns","enableColumnResizing","columnResizeMode","getCoreRowModel","updateBaselineColumnUuid","getTotalSize","getHeaderGroups","headerGroup","headers","column","getSize","resizable","getCanResize","resizeHandler","getResizeHandler","flexRender","columnDef","getContext","getRowModel","rows","getAllCells","multiline","IMAGE_GAP_SIZE","getImageSize","numImages","maxImagesPerRow","ImagePlot","imageUrl","compressedImageUrl","imageSize","maxImageSize","previewVisible","setPreviewVisible","GenericSkeleton","ImagePreviewGroup","onVisibleChange","Image","src","preview","ImagePlotWithHistory","metadataByStep","textAlign","ImageIcon","getArtifactLocationUrl","filepath","compressed_filepath","EmptyImageGridPlot","ImageGridSingleKeyPlot","displayRuns","imageMetadata","imageMetadataByStep","metadata","lineHeightMd","ImageGridMultipleKeyPlot","grid","filteredPreviewData","ParallelCoordinatesPlot","MAX_NUMBER_STRINGS","allRuns","shift","stringRuns","numberRuns","seenVals","tempRuns","has","filterParallelCoordinateData","result","computeSelectedAttrs","attrs","runvalue","isArray","attr","Suspense","activeKey","onActiveKeyChange","disableCollapse","clsPrefix","classItem","classItemActive","classHeader","classContent","classContentBox","classArrow","transform","textPrimary","outlineColor","outlineStyle","borderBottom","Accordion","dangerouslyAppendEmotionCSS","expandIconPosition","RunsChartsAddChartMenu","onAddChart","addChartButton","IconWrapper","iconWrapper","RunsChartsSectionHeader","section","sectionChartsLength","addNewChartCard","onDeleteSection","onAddSection","editSection","onSetEditSection","onSetSectionName","onSectionReorder","isExpanded","tmpSectionName","setTmpSectionName","isDraggingHandle","setIsDraggingHandle","sectionNameRef","confirmButtonRef","sectionNameWidth","setSectionNameWidth","isDeleteSectionModalOpen","setIsDeleteSectionModalOpen","entry","isCurrentlyEdited","isCurrentlyHovered","setIsCurrentlyHovered","role","visibility","onMouseMove","inset","isDarkMode","blue800","blue100","blue400","EDITABLE_LABEL_PADDING_WIDTH","onMouseDown","onMouseUp","onDoubleClick","onKeyDown","onPressEnter","minHeight","PencilIcon","CheckIcon","rotate","addSectionAbove","addSectionBelow","deleteSection","DangerModal","deleteModalConfirm","deleteModalCancel","alignSelf","RunsCharts","sectionId","cardsConfig","onInsertCharts","parallelChartCards","differenceChartCards","imageChartCards","remainingChartCards","c","gridSetup","dropTargetGeneralRef","isOverGeneral","dropTargetParallelRef","isOverParallel","isChartsEmpty","Empty","description","chartCards","reorderProps","_chartCards","_chartCards2","_remainingChartCards","_remainingChartCards2","RunsChartsSection","sectionCharts","reorderCharts","insertCharts","startEditChart","removeChart","RunsChartsSectionAccordion","compareRunSections","useUpdateRunsChartsUIConfiguration","setEditSection","sectionConfig","chartConfig","isGenerated","metricSectionId","deleted","newCompareRunSections","isAccordionReordered","addSection","above","findIndex","newSection","isReordered","splice","setSectionName","sectionReorder","sourceSectionId","targetSectionId","sourceSectionIdx","targetSectionIdx","sourceSection","compareRunChartsFiltered","chartMatchesFilter","filterLowerCase","lineConfig","scatterConfig","contourConfig","sectionsWithCharts","compareRunSectionsFiltered","MetricChartsAccordion","filteredSectionCharts","runsCompareSearchHeader","Panel","collapsible","newCompareRunPanels","shouldDisplaySection","block","appendSection","experimentChartImageDefaultDownloadLayout","paper_bgcolor","plot_bgcolor","experimentChartImageDefaultDownloadSettings","experimentChartImageDefaultDownloadPlotConfig","downloadImage","filename","downloadHandlerRef","downloadHandler","setDownloadHandler","setDownloadHandlerCached","existingHandler","chartTitle","_downloadHandlerRef$c","meta","internalElementRef","setIsInViewport","IntersectionObserver","intersectionObserver","isIntersecting","callback","mutableRef","highlightChartTracesFn","traceSelector","parentSelector","parent","hoverIndex","selectIndex","_parent$querySelector","_parent$querySelector3","numberOfBands","deselected","_parent$querySelector2","_parent$querySelector4","_parent$querySelector5","_parent$querySelector6","remove","querySelectorAll","bandTraceIndex","highlightFn","selectedTraceIndex","hoveredPointIndex","RunsChartsTooltipContext","ContextMenuVisibility","extractHTMLAncestorElement","HTMLElement","currentElement","parentElement","ctxMenuRef","currentPos","usingImprovedClickMechanism","currentSnappedCoordinates","setMode","contextMenuShown","setContextMenuShown","HIDDEN","tooltipDisplayParams","setTooltipDisplayParams","hoveredRunUuid","setHoveredRunUuid","additionalAxisData","setAdditionalAxisData","focusedRunData","mutableContextMenuShownRef","mutableHoveredRunUuid","mutableTooltipDisplayParams","mutableAdditionalAxisData","applyPositioning","isChangingVisibilityMode","targetX","targetY","currentCtxMenu","reposition","menuRect","requestAnimationFrame","getCoordinatesForTargetElement","targetElement","_containerRef$current","targetRect","offsetX","offsetY","mouseMove","HOVER","nativeEvent","updateTooltip","additionalRunData","_focusedRunData$curre","VISIBLE","currentRunUuid","mouseDownCapture","button","pageX","pageY","tooltipAreaClicked","clickedInTheSamePlace","_focusedRunData$curre3","_focusedRunData$curre2","domRoot","getRootNode","rootClickListener","_focusedRunData$curre4","capture","_focusedRunData$curre5","contextValue","displayTooltip","onMouseDownCapture","onClickCapture","contextMenuContainer","contextMenuWrapper","userSelect","useContext","zIndex","boxShadow","shadowLow","overlayElement","content","RunsChartsUIConfigurationContext","RunsChartsUIConfigurationContextProvider","updateChartsUIState","useReorderRunsChartsFn","sourceChartUuid","targetChartUuid","_current$compareRunCh","_current$compareRunSe","newChartsOrder","newSectionsState","indexSource","indexTarget","sourceChart","targetChart","isSameMetricSection","newSourceChart","configuredCard","serializedCard","serialize","_current$compareRunCh2","existingChartCard","useInsertRunsChartsFn","_current$compareRunCh3","_current$compareRunSe2","useRemoveRunsChartFn","configToDelete","_current$compareRunCh4","_current$compareRunCh5","setup","store","rangeKey","createChartAxisRangeKey","anyRunRefreshing","anyRunLoading","returnValues","metricsByMetricKey","dataByMetricKey","_store$entities$sampl","_store$entities$sampl2","runMetricData","refreshing","keyBy","refreshFn","chunk","runUuidsChunk","action","getSampledMetricHistoryBulkAction","fetchMetricsFn","isAutoRefreshing","EXPERIMENT_RUNS_METRIC_AUTO_REFRESH_INTERVAL","refresh","dataTraceMetricsContainMultipleEpochs","_dataTrace$metrics","_dataTrace$metrics$me","entity","RunsChartsBarCardConfig","RunsChartsScatterCardConfig","RunsChartsParallelCardConfig","RunsChartsLineCardConfig","RunsChartsDifferenceCardConfig","RunsChartsImageCardConfig","RunsChartsContourCardConfig","getBaseChartConfigs","primaryMetricKey","resultChartSet","allMetricKeys","metricsToRender","metricsKey","chartType","getBaseChartAndSectionConfigs","useParallelCoordinatesChart","enabledSectionNames","MLFLOW_MODEL_METRIC_NAME","MLFLOW_SYSTEM_METRIC_NAME","filterMetricNames","imagesToRender","sectionName2Uuid","sectionName","extractChartSectionName","resultSectionSet","updateChartAndSectionConfigs","isResultUpdated","doesImageKeyExist","chartImageKeys","isSectionReordered","newChartConfig","insertIndex","localeCompare","doesMetricKeyExist","chartMetricKey","generatedChartIndex","prevChart","rest","delimiter","MLFLOW_MODEL_METRIC_PREFIX","findChartStepsByTimestamp","currentMetricHistory","useDefaultIfNotFound","flatHistory","valueOf","lowerEntry","first","upperEntry","last","sampledMetrics","stepRangesPerRun","_sampledMetrics$runUu","metricHistoryForRun","bound","currentlyVisibleMetrics","relativeRange","multiplier","_minBy","runMetrics","visibleMetricHistoryForRun","_metric$metricsHistor","timestampOffset","invariant","aggregatedRunUuidsInGroup","runUuidsForAggregation","aggregatedMetricsHistoryForMetric","metricsHistoryInGroup","_sampledDataResultsBy","_sampledDataResultsBy2","steps","h","createAggregatedMetricHistory","createValueAggregatedMetricHistory","datasetSummariesEqual","summary1","summary2","context","path","buttonProps","setShowTooltip","handleClick","navigator","clipboard","writeText","handleMouseLeave","icons","rotateLeft","UndoIcon","rotateRight","RedoIcon","zoomIn","ZoomInIcon","zoomOut","ZoomOutIcon","close","ArrowLeftIcon","ArrowRightIcon","getPopupContainer","DesignSystemContext","RcImage","PreviewGroup","getContainer","v","useMediaQuery","query","queryList","useSyncExternalStore","matches","useMatchesMediaQuery","matchMedia","fontFamily","direction","wordSpacing","MozTabSize","OTabSize","tabSize","WebkitHyphens","MozHyphens","msHyphens","hyphens","textShadow","comment","prolog","doctype","cdata","punctuation","namespace","Opacity","operator","property","function","selector","boolean","string","keyword","directive","unit","statement","regex","atrule","variable","textDecoration","inserted","italic","fontStyle","important","Outline","OutlineOffset","borderRightColor","wordWrap","builtin","char","class","constant","hexcode","symbol","SyntaxHighlighter","registerLanguage","python","snippetPadding","themesStyles","light","lightStyle","duotoneDark","duotoneDarkStyle","actions","showLineNumbers","lineNumberStyle","customStyle","codeTagProps"],"sourceRoot":""}